/*
 Navicat Premium Data Transfer

 Source Server         : my
 Source Server Type    : MySQL
 Source Server Version : 50724
 Source Host           : 47.99.82.22:3306
 Source Schema         : lclblog

 Target Server Type    : MySQL
 Target Server Version : 50724
 File Encoding         : 65001

 Date: 21/05/2019 10:11:22
*/

SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for admin_user
-- ----------------------------
DROP TABLE IF EXISTS `admin_user`;
CREATE TABLE `admin_user`  (
  `id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,
  `username` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
  `password` char(32) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
  `pwd` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL,
  `is_use` tinyint(1) NOT NULL DEFAULT 0,
  `add_time` datetime(0) DEFAULT NULL,
  `edit_time` datetime(0) DEFAULT NULL,
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 2 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;

-- ----------------------------
-- Records of admin_user
-- ----------------------------
INSERT INTO `admin_user` VALUES (1, 'admin', '96e79218965eb72c92a549dd5a330112', '111111', 0, NULL, NULL);

-- ----------------------------
-- Table structure for article
-- ----------------------------
DROP TABLE IF EXISTS `article`;
CREATE TABLE `article`  (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `art_title` varchar(60) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',
  `art_desc` varchar(60) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',
  `art_content` text CHARACTER SET utf8 COLLATE utf8_general_ci,
  `type_id` int(11) NOT NULL,
  `order_id` int(11) NOT NULL DEFAULT 0,
  `add_time` int(11) DEFAULT NULL,
  `edit_time` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 54 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;

-- ----------------------------
-- Records of article
-- ----------------------------
INSERT INTO `article` VALUES (1, 'laravel 访问器和修饰器', 'laravel 访问器和修饰器', '<p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">在 ORM 模型中，如果是多选下拉框，如存多个用户，则需在model加入修饰器，将用户id数组转化成自字符串。</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">在访问列表的时候，又要定义访问器，将字符串转化成数组</p><pre class=\"brush:php;toolbar:false;\" style=\"margin: 0.5em 0px; padding: 0.4em 0.6em; border-radius: 8px; background: rgb(248, 248, 248); color: rgb(0, 0, 0); font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">class&nbsp;AuditConfig&nbsp;extends&nbsp;Model&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;$table&nbsp;=&nbsp;&#39;audit_config&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;设置修改器\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$value\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;setAdminUsersIdAttribute($value)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;attributes[&#39;admin_users_id&#39;]&nbsp;=&nbsp;implode(&#39;,&#39;,$value);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;定义访问器\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;string&nbsp;&nbsp;$value\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;string\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;getFirstNameAttribute($value)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;explode(&#39;&#39;,$value);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}</pre><p><br class=\"Apple-interchange-newline\"/></p><p><br/></p>', 1, 0, 1540541798, 1540543785);
INSERT INTO `article` VALUES (2, 'php 语法1', 'php 语法1', '<p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">1.&nbsp;</span><span style=\"font-family: 宋体; font-size: 14px;\"><span style=\"font-family: 宋体;\">单引号和双引号对变量的友好区别？</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">$name = &quot;sunny&quot;;</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\"><span style=\"font-family: 宋体; font-size: 16px;\"></span>echo &quot;name: {$name}&quot;;//<span style=\"font-family: 宋体;\">结果：</span><span style=\"font-family: Calibri;\">name: sunny</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">echo &quot;name: $name&quot;;//<span style=\"font-family: 宋体;\">结果：</span><span style=\"font-family: Calibri;\">name: sunny</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">echo &#39;name: {$name}&#39;;//<span style=\"font-family: 宋体;\">结果：</span><span style=\"font-family: Calibri;\">name: {$name}</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">echo &#39;name: $name&#39;;//<span style=\"font-family: 宋体;\">结果：</span><span style=\"font-family: Calibri;\">name: {$name}</span></span><span style=\"font-family: 宋体; font-size: 14px;\">&nbsp;</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\"><span style=\"font-family: 宋体;\">有没有花括号</span><span class=\"Apple-converted-space\">&nbsp;</span><span style=\"font-family: 宋体;\">对解析变量没有影响</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\"><span style=\"font-family: 宋体;\"><br/></span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">2.&nbsp;</span><span style=\"font-family: 宋体; font-size: 14px;\"><span style=\"font-family: 宋体;\">纯</span>php code &nbsp;&lt;?php<span class=\"Apple-converted-space\">&nbsp;</span><span style=\"font-family: 宋体;\">即可 ，省略结束标签，防止结束标签后有换行或空格，对</span><span style=\"font-family: Calibri;\">include<span class=\"Apple-converted-space\">&nbsp;</span></span><span style=\"font-family: 宋体;\">中有文件需要缓冲，或者</span><span style=\"font-family: Calibri;\">header()</span><span style=\"font-family: 宋体;\">处理 造成影响。</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\"><span style=\"font-family: 宋体;\"><br/></span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">3.&nbsp;</span><span style=\"font-family: 宋体; font-size: 14px;\"><span style=\"font-family: 宋体;\">结束标签后可以输入任何字段，</span>php<span style=\"font-family: 宋体;\">不会进行解析，也不报错</span><span style=\"font-family: Calibri;\">&lt;?php &nbsp;echo 3;?&gt;dslhkaf</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\"><span style=\"font-family: Calibri;\"><br/></span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">4.&nbsp;</span><span style=\"font-family: 宋体; font-size: 14px;\"><span style=\"font-family: 宋体;\">类型转换</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">var_dump( (bool)(false)); //bool(false)</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">var_dump( (bool)(&#39;false&#39;));//bool(true)</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\"><br/></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">5.&nbsp;</span><span style=\"font-family: 宋体; font-size: 14px;\"><span style=\"font-family: 宋体;\">值传递和引用传递</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\"></span></p><pre class=\"brush:php;toolbar:false;\" style=\"margin: 0.5em 0px; padding: 0.4em 0.6em; border-radius: 8px; background: rgb(248, 248, 248); color: rgb(0, 0, 0); font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">&lt;?php&nbsp;&nbsp;&nbsp;&nbsp;\r\n$data&nbsp;=&nbsp;[\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;name&#39;=&gt;&#39;sunny&#39;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;age&#39;=&gt;18\r\n&nbsp;&nbsp;&nbsp;&nbsp;];\r\n&nbsp;&nbsp;&nbsp;&nbsp;unset_test($data);\r\n&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;unset_test($data){\r\n&nbsp;&nbsp;&nbsp;&nbsp;unset($data[&#39;name&#39;]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;var_dump($data);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;var_dump(&nbsp;$data);\r\n&nbsp;&nbsp;//array(1)&nbsp;{&nbsp;[&quot;age&quot;]=&gt;&nbsp;int(18)&nbsp;}&nbsp;array(2)&nbsp;{&nbsp;[&quot;name&quot;]=&gt;&nbsp;string(5)&nbsp;&quot;sunny&quot;&nbsp;[&quot;age&quot;]=&gt;&nbsp;int(18)&nbsp;}\r\n&nbsp;&nbsp;&nbsp;//如过是引用传递\r\n&nbsp;function&nbsp;unset_test(&amp;$data){\r\n&nbsp;&nbsp;&nbsp;&nbsp;unset($data[&#39;name&#39;]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;var_dump($data);\r\n&nbsp;}\r\n//array(1)&nbsp;{&nbsp;[&quot;age&quot;]=&gt;&nbsp;int(18)&nbsp;}&nbsp;array(1)&nbsp;{&nbsp;[&quot;age&quot;]=&gt;&nbsp;int(18)&nbsp;}\r\n?&gt;</pre><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><br/></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">6.&nbsp;</span><span style=\"font-family: 宋体; font-size: 14px;\"><span style=\"font-family: 宋体;\">类型转行，高精度向低精度转换，</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">$num = (0.1+0.7) * 10 ;</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">var_dump($num); //float(8)</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">var_dump((int)$num); //int(7)</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">$num = 8.0;</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">var_dump((int)$num);//int(8)</span></p><p><br class=\"Apple-interchange-newline\"/></p><p><br/></p>', 1, 0, 1540543293, 1540543878);
INSERT INTO `article` VALUES (3, '商品的拓展分类设计', '商品的拓展分类设计', '<p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">一 商品的拓展分类</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">比如手机，属于电子科技类，但是也可以属于生活用品，此时生活用品则是拓展属性</p><pre class=\"brush:php;toolbar:false\">create&nbsp;if&nbsp;not&nbsp;exists&nbsp;goods(\r\n&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;int&nbsp;not&nbsp;null&nbsp;auto_increment,\r\n&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;varchar(60),\r\n&nbsp;&nbsp;&nbsp;&nbsp;cat_id&nbsp;&nbsp;int&nbsp;not&nbsp;null&nbsp;default&nbsp;&#39;0&#39;&nbsp;comment&nbsp;&#39;商品属性&#39;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;primary&nbsp;key(id)\r\n)engine=mysiam&nbsp;default&nbsp;charset=utf-8&nbsp;comment&nbsp;&#39;商品表&#39;\r\n\r\ncreate&nbsp;if&nbsp;not&nbsp;exists&nbsp;good_cat(\r\n&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;int&nbsp;not&nbsp;null&nbsp;auto_increment,\r\n&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;varchar(60),\r\n&nbsp;&nbsp;&nbsp;&nbsp;parent_id&nbsp;&nbsp;int&nbsp;not&nbsp;null&nbsp;default&nbsp;&#39;0&#39;&nbsp;comment&nbsp;&#39;父级属性&#39;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;primary&nbsp;key(id)\r\n)engine=mysiam&nbsp;default&nbsp;charset=utf-8&nbsp;comment&nbsp;&#39;商品分类表&#39;\r\n\r\ncreate&nbsp;if&nbsp;not&nbsp;exists&nbsp;good_cat_ext(\r\n&nbsp;&nbsp;&nbsp;&nbsp;good_id&nbsp;int&nbsp;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;cat_id&nbsp;&nbsp;int\r\n)engine=mysiam&nbsp;default&nbsp;charset=utf-8&nbsp;comment&nbsp;&#39;属性拓展表&#39;</pre><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><br/></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">添加时，拓展属性可以是多个，则该字段用数组接收，克隆得到对应的属性个数<br/></p><pre class=\"brush:php;toolbar:false\">&lt;tr&gt;\r\n&nbsp;&nbsp;&lt;td&nbsp;class=&quot;label&quot;&gt;扩展分类：&lt;/td&gt;\r\n&nbsp;&nbsp;&lt;td&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;onclick=&quot;$(this).parent().append($(this).next(&#39;select&#39;).clone());&quot;&nbsp;type=&quot;button&quot;&nbsp;value=&quot;添加&quot;&nbsp;/&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;select&nbsp;name=&quot;ext_cat_id[]&quot;&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;value=&quot;&quot;&gt;选择分类&lt;/option&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;foreach&nbsp;($catData&nbsp;as&nbsp;$k&nbsp;=&gt;&nbsp;$v):&nbsp;?&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;value=&quot;{$v.id}&quot;&gt;&lt;?php&nbsp;echo&nbsp;str_repeat(&#39;-&#39;,$v[&#39;level&#39;]&nbsp;*&nbsp;8);&nbsp;?&gt;{$v.cat_name}&lt;/option&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;endforeach;&nbsp;?&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/select&gt;\r\n&nbsp;&nbsp;&lt;/td&gt;\r\n&lt;/tr&gt;</pre><p>//添加商品后,遍历添加商品拓展分类</p><pre class=\"brush:php;toolbar:false\">$good_new_id&nbsp;=&nbsp;DB::query(&#39;insert&nbsp;into&nbsp;goods&nbsp;values()&#39;);\r\nforeach($ext_cat_id&nbsp;as&nbsp;$v){\r\n&nbsp;&nbsp;&nbsp;&nbsp;if(empty($v)){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}else{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;&quot;insert&nbsp;into&nbsp;good_cat_ext(&#39;goods_id&#39;,cat_id)&nbsp;values&nbsp;($good_new_id,$v)&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB::query($sql);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}</pre><p><br/></p><p>查询时，点击某个分类($cat_id)，显示该分类下的所有产品</p><pre class=\"brush:php;toolbar:false\">1.查询该分类下所有的子级分类id(递归方式)&nbsp;$childenCatIdArr，\r\n2.将子类和本商品分类合并&nbsp;$childenCatIdArr[]&nbsp;=&nbsp;$cat_id;\r\n3.获取商品分类下所有的&nbsp;商品id数组&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;$cur_cat_good_ids&nbsp;=&nbsp;&quot;&nbsp;select&nbsp;id&nbsp;from&nbsp;goods&nbsp;where&nbsp;cat_id&nbsp;in&nbsp;$childenCatIdArr&nbsp;&quot;;\r\n4.获取拓展分类的商品ID\r\n&nbsp;&nbsp;&nbsp;&nbsp;$good_ext_ids&nbsp;=&nbsp;&#39;select&nbsp;distinct&nbsp;good_id&nbsp;from&nbsp;good_cat_ext&nbsp;where&nbsp;cat_id&nbsp;in&nbsp;$childenCatIdArr&#39;;\r\n5.合并商品分类&nbsp;以及&nbsp;拓展分类&nbsp;，即可得到\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($cur_cat_good_ids&nbsp;&amp;&amp;&nbsp;$good_ext_ids)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$goods_id_sum&nbsp;=&nbsp;array_merge($cur_cat_good_ids,$good_ext_ids);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if($cur_cat_good_ids){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$goods_id_sum&nbsp;=&nbsp;$cur_cat_good_ids;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$goods_id_sum&nbsp;=&nbsp;$good_ext_ids;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;array_unique($goods_id_sum);</pre><p><br/></p><p><br class=\"Apple-interchange-newline\"/></p><p><br/></p>', 1, 0, 1540543343, 1548733407);
INSERT INTO `article` VALUES (4, 'mysql 慢查询', 'mysql 慢查询', '<p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\"><span style=\"font-family: 宋体;\">查看慢查询设置时间：</span>show variables like<span class=\"Apple-converted-space\">&nbsp;</span></span><span style=\"font-family: Calibri; font-size: 14px;\">‘</span><span style=\"font-family: 宋体; font-size: 14px;\">long_query_time</span><span style=\"font-family: Calibri; font-size: 14px;\">’</span><span style=\"font-family: 宋体; font-size: 14px;\">,</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\"><span style=\"font-family: 宋体;\">默认是</span>10s<span class=\"Apple-converted-space\">&nbsp;</span><span style=\"font-family: 宋体;\">在</span><span style=\"font-family: Calibri;\">MySQL5.1</span><span style=\"font-family: 宋体;\">以上版本可设置微秒级别</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">1.<span style=\"font-family: 宋体;\">查看</span><span style=\"font-family: Calibri;\">mysql</span><span style=\"font-family: 宋体;\">配置文件位置：</span><span style=\"font-family: Calibri;\">find -name my.cnf</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">2.<span style=\"font-family: 宋体;\">设置慢查询时间<span class=\"Apple-converted-space\">&nbsp;</span></span><span style=\"font-family: Calibri;\">long_query_time = 0.2</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">3.<span style=\"font-family: 宋体;\">慢查询存储位置 &nbsp;&nbsp;</span><span style=\"font-family: Calibri;\">slow_query_log_file = /data/mysql/mysql-slow.log</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">4.<span style=\"font-family: 宋体;\">重启</span><span style=\"font-family: Calibri;\">mysql &nbsp;&nbsp;service mysql restart</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\"><span style=\"font-family: 宋体;\">查询超出时间记录信息</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\"># Time: 2018-09-20T02:22:34.775809Z</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\"># User@Host: dazui[dazui] @ &nbsp;[58.34.144.167] &nbsp;Id: &nbsp;&nbsp;&nbsp;&nbsp;4</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\"># Query_time: 0.303169 &nbsp;Lock_time: 0.000736 Rows_sent: 28160 &nbsp;Rows_examined: 84480</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">use dazui;</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">SET timestamp=1537410154;</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">select a.* from (ｓｅｌｅｃｔ * from admin_operation_log) as a ^M</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">where user_id in (ｓｅｌｅｃｔ user_id from admin_operation_log group by user_id );</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">5.<span style=\"font-family: 宋体;\">慢查询默认是记录到文件中，查看记录方式</span><span style=\"font-family: Calibri;\">show varriables like<span class=\"Apple-converted-space\">&nbsp;</span></span></span><span style=\"font-family: Calibri; font-size: 14px;\">‘</span><span style=\"font-family: 宋体; font-size: 14px;\">log_output</span><span style=\"font-family: Calibri; font-size: 14px;\">’</span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">6.<span style=\"font-family: 宋体;\">也可以将记录存放到表中</span><span style=\"font-family: Calibri;\">set GLOBAL log_output =<span class=\"Apple-converted-space\">&nbsp;</span></span></span><span style=\"font-family: Calibri; font-size: 14px;\">‘</span><span style=\"font-family: 宋体; font-size: 14px;\">TABLE</span><span style=\"font-family: Calibri; font-size: 14px;\">’</span><span style=\"font-family: 宋体; font-size: 14px;\"><span style=\"font-family: 宋体;\">，此表是在</span>mysql<span style=\"font-family: 宋体;\">数据库下</span><span style=\"font-family: Calibri;\">,slow_log</span><span style=\"font-family: 宋体;\">表</span></span></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\">&nbsp;</span></p><p><br class=\"Apple-interchange-newline\"/></p><p><br/></p>', 5, 0, 1540543992, 1540544002);
INSERT INTO `article` VALUES (5, 'innodb 存储引擎的结构', 'innodb 存储引擎的结构', '<p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">表</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">1.索引&nbsp;</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">innodb存储引擎，每个表都有所有主键，如果没有显示的定义，主键生成方式</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">01.unique not null 作为主键，如果有多个非空唯一索引，以第一个定义非空唯一索引作为主键</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">02. 没有非空唯一索引，引擎自动创建一个6字节大小的指针。</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">查看主键 select _rowid from tabel_name</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">_rowid 只能查看单个列为主键，联合主键不可</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><br/></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">2.innodb 逻辑存储结构</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">从逻辑存储结构看，所有数据存储到表空间。</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">表空间-&gt;段(segment)-&gt;区(extend)-&gt;页(page)-&gt;(row)</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">如果开启列innodb_file_per_table,每张表段数据放到单独段一个表空间里，</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">但是存放段只是数据，索引，以及插入缓冲Bitmap页，像其他回滚信息，事务信息等还是在共享表空间里。</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">for example:</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">设置 innodb_file_per_table=on</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">system ls -lh /usr/local/mysql/data/ibdata*</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">查看共享表的占用大小，如30M，接着模拟undo操作</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">set autocommit=0;</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">ｕｐｄａｔｅ user set age=18 //修改另一个表的数据，因为事务未提交或回滚，执行会产生大量的ｕｐｄａｔｅ 语句，</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">此时再次查询共享表，文件大小会提高，如到40M,如果此时执行rollback ,大小不会释放到30M，</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">虽然不会释放，但是这多出的10M空间会被自动判断，标记为可用空间，供下次undo操作。</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><br/></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">段</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">表空间由多个段组成，段有数据段，索引段，回滚段等，</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">innodb 存储索引表由索引组织（index organized）的,因此数据即使索引。</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">数据段即使 B+树的叶子节点（Left node segment），索引段即使 B+树的非索引节点(Non-left not segment)</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><br/></p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">区&nbsp;</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">由连续页组成的空间，任何情况下，每个区的大小是 1MB</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">为保证区中页的完整性，存储引擎一次从磁盘中申请 4-5 个区。</p><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">默认情况下，存储引擎页的大小是 16KB, 即一个区有 64个连续的页。</p><p><br class=\"Apple-interchange-newline\"/></p><p><br/></p>', 5, 0, 1540544040, NULL);
INSERT INTO `article` VALUES (6, 'php 多维数组排序', 'php 多维数组排序', '<pre class=\"brush:php;toolbar:false;\" style=\"margin: 0.5em 0px; padding: 0.4em 0.6em; border-radius: 8px; background: rgb(248, 248, 248); color: rgb(0, 0, 0); font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\">&lt;?php\r\n&nbsp;&nbsp;&nbsp;&nbsp;$arr_a&nbsp;=&nbsp;[\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&#39;name&#39;=&gt;&#39;lcl&#39;,&#39;age&#39;=&gt;18],\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&#39;name&#39;=&gt;&#39;lucy&#39;,&#39;age&#39;=&gt;43],\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&#39;name&#39;=&gt;&#39;sunny&#39;,&#39;age&#39;=&gt;24],\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&#39;name&#39;=&gt;&#39;guci&#39;,&#39;age&#39;=&gt;26]\r\n&nbsp;&nbsp;&nbsp;&nbsp;];\r\n&nbsp;&nbsp;&nbsp;&nbsp;usort($arr_a,&quot;cmp&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;cmp($a,$b){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($a[&#39;age&#39;]==$b[&#39;age&#39;]){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$a[&#39;age&#39;]&nbsp;&gt;&nbsp;$b[&#39;age&#39;]&nbsp;?&nbsp;1&nbsp;:&nbsp;-1;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;var_dump($arr_a);\r\n?&gt;</pre><p style=\"margin: 5px 0px; color: rgb(0, 0, 0); font-family: sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;\"><span style=\"font-family: 宋体; font-size: 14px;\"></span><br/></p><p><br class=\"Apple-interchange-newline\"/></p><p><br/></p>', 1, 0, 1540544093, NULL);
INSERT INTO `article` VALUES (7, '数组排序几种方式', '数组排序几种方式', '<pre class=\"brush:php;toolbar:false\">&lt;?php\r\n&nbsp;&nbsp;&nbsp;&nbsp;$arr&nbsp;=&nbsp;array(4,6,1,77,43,55,22,66,73,54);\r\n&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;bubbleSort($array){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$len&nbsp;=&nbsp;count($array);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;($i=1;&nbsp;$i&nbsp;&lt;&nbsp;$len;&nbsp;$i++)&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;($j=0;&nbsp;$j&nbsp;&lt;&nbsp;$len-$i;&nbsp;$j++)&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($array[$j]&nbsp;&gt;&nbsp;$array[$j+1])&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$temp&nbsp;=&nbsp;$array[$j+1];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$array[$j+1]&nbsp;=&nbsp;$array[$j];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$array[$j]&nbsp;=&nbsp;$temp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_dump($array);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&nbsp;$array;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;selectSort($array){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$len&nbsp;=&nbsp;count($array);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;($i=0;&nbsp;$i&nbsp;&lt;&nbsp;$len-1;&nbsp;$i++)&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$min&nbsp;=&nbsp;$i;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;($j=$i+1;&nbsp;$j&nbsp;&lt;&nbsp;$len;&nbsp;$j++)&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($array[$min]&nbsp;&gt;&nbsp;$array[$j])&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$min&nbsp;=&nbsp;$j;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($min&nbsp;!=&nbsp;$i){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$temp&nbsp;=&nbsp;$array[$min];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$array[$min]&nbsp;=&nbsp;$array[$i];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$array[$i]&nbsp;=&nbsp;$temp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&nbsp;$array;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;quickSort($arr)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!is_array($arr))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$len&nbsp;=&nbsp;count($arr);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($len&nbsp;&lt;=&nbsp;1){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$arr;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$left&nbsp;=&nbsp;array();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$right&nbsp;=&nbsp;array();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;($i=1;&nbsp;$i&nbsp;&lt;&nbsp;$len;&nbsp;$i++)&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($arr[$i]&nbsp;&lt;&nbsp;$arr[0])&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$left[]&nbsp;=&nbsp;$arr[$i];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$right[]&nbsp;=&nbsp;$arr[$i];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$left&nbsp;=quickSort($left);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$right&nbsp;=quickSort($right);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;array_merge($left,array($arr[0]),$right);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}</pre><p><br/></p>', 1, 0, 1540778605, NULL);
INSERT INTO `article` VALUES (8, '设计开源产品步骤', '设计开源产品步骤', '<p>&lt;?php</p><p>/*</p><p>在ThinkPHP基础上设计开源产品步骤</p><p>入口文件index.php</p><p>1.检测php 版本</p><p>header(&#39;Content-type: text/html;charset=utf-8&#39;);</p><p>if(version_compare(PHP_VERSION,&#39;5.6.0&#39;,&#39;&lt;&#39;)) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>die(&#39;version must to more than 5.6&#39;);</p><p>}</p><p>2.设置错误级别</p><p>error_reporting(E_ERROR | E_WARNING | E_PARSE);//error_reporting(E_AL ^ E_NOTICE);</p><p>3.检验是否已安装产品(安装后新建文件 has_install.lock)</p><p>if(file_exists(&quot;./install/index.php&quot;) &amp;&amp; !file_exists(&quot;./install/has_install.lock&quot;)) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>//在域名根目录下安装</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>if ($_SERVER[&#39;PHP_SELF&#39;] != &#39;/index.php&#39;) {</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">		</span>header(&#39;Content-type: text/html;charset=utf-8&#39;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">		</span>exit(&quot;请在根目录下安装，如www.xxx.com/index.php ,错误 www.xxx.com/xxx/indx,php,去配置apache 或nginx&quot;);</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>}<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>//跳转到安装文件</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>header(&quot;Location: /install/index.php&quot;);</p><p>}</p><p><br/></p><p>4.加载ThinkPHP核心库</p><p>require __DIR__ . &#39;/core/start.php&#39;;</p><p>*/</p><p>/*</p><p>安装入口文件</p><p>/install/index.php</p><p><br/></p><p>*/</p><pre class=\"brush:php;toolbar:false\"><br/></pre><p><br/></p>', 1, 0, 1540781628, NULL);
INSERT INTO `article` VALUES (9, '电脑和手机首页自动切换', '电脑和手机首页自动切换', '<pre style=\"background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;; font-size: 12pt;\" class=\"brush:php;toolbar:false;\"><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">&lt;?php<br/>namespace \\app\\Pc\\controller;<br/>class IndexConterler{<br/> &nbsp; &nbsp;public function index(){<br/> &nbsp; &nbsp; &nbsp; &nbsp;// 如果是手机跳转到 手机模块<br/> &nbsp; &nbsp; &nbsp; &nbsp;if(isMobile()){<br/> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;redirect(U(&#39;Mobile/Index/index&#39;));<br/> &nbsp; &nbsp; &nbsp; &nbsp;}<br/> &nbsp; &nbsp; &nbsp; $this-&gt;display();<br/> &nbsp; &nbsp;}<br/>}<br/>namespace \\app\\Mobile\\controller;<br/>class IndexConterler{<br/> &nbsp; &nbsp;public function index(){<br/> &nbsp; &nbsp; &nbsp; &nbsp;// 如果是手机跳转到 手机模块<br/> &nbsp; &nbsp; &nbsp; &nbsp;if(!isMobile()){<br/> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;redirect(U(&#39;Pc/Index/index&#39;));<br/> &nbsp; &nbsp; &nbsp; &nbsp;}<br/> &nbsp; &nbsp; &nbsp; $this-&gt;display();<br/> &nbsp; &nbsp;}<br/>}<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">/**<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">　　* &nbsp;判断当前访问的用户是 &nbsp;PC端 &nbsp;还是 手机端 &nbsp;返回true 为手机端 &nbsp;false ,公共函数库</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"><br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">　　* @return bool<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">　　*/<br/></span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">function </span><span style=\"background-color:#f7faff;\">isMobile() </span><span style=\"background-color:#f7faff;\">{<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">// 如果有HTTP_X_WAP_PROFILE则一定是移动设备<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">if </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">isset </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$_SERVER</span><span style=\"background-color:#f7faff;\">[</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;HTTP_X_WAP_PROFILE&#39;</span><span style=\"background-color:#f7faff;\">]))<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">return true</span><span style=\"background-color:#f7faff;\">;</span><span style=\"background-color:#f7faff;\"><br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">// 如果via信息含有wap则一定是移动设备,部分服务商会屏蔽该信息<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">if </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">isset </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$_SERVER</span><span style=\"background-color:#f7faff;\">[</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;HTTP_VIA&#39;</span><span style=\"background-color:#f7faff;\">]))</span><span style=\"background-color:#f7faff;\">{ // 找不到为flase,否则为true</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"><br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">return </span><span style=\"background-color:#f7faff;font-style:italic;\">stristr</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$_SERVER</span><span style=\"background-color:#f7faff;\">[</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;HTTP_VIA&#39;</span><span style=\"background-color:#f7faff;\">], </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&quot;wap&quot;</span><span style=\"background-color:#f7faff;\">) ? </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">true </span><span style=\"background-color:#f7faff;\">: </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">false</span><span style=\"background-color:#f7faff;\">;<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;}<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">// 脑残法，判断手机发送的客户端标志,兼容性有待提高<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">if </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">isset </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$_SERVER</span><span style=\"background-color:#f7faff;\">[</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;HTTP_USER_AGENT&#39;</span><span style=\"background-color:#f7faff;\">])) </span><span style=\"background-color:#f7faff;\">{<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#660000;background-color:#f7faff;\">$clientkeywords </span><span style=\"background-color:#f7faff;\">= </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">array </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;nokia&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;sony&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;ericsson&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;mot&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;samsung&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;htc&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;sgh&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;lg&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;sharp&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;sie-&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;philips&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;panasonic&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;alcatel&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;lenovo&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;iphone&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;ipod&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;blackberry&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;meizu&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;android&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;netfront&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;symbian&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;ucweb&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;windowsce&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;palm&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;operamini&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;operamobi&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;openwave&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;nexusone&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;cldc&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;midp&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;wap&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;mobile&#39;</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">// 从HTTP_USER_AGENT中查找手机浏览器的关键字<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">if </span><span style=\"background-color:#f7faff;\">(</span><span style=\"background-color:#f7faff;font-style:italic;\">preg_match</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&quot;/(&quot; </span><span style=\"background-color:#f7faff;\">. </span><span style=\"background-color:#f7faff;font-style:italic;\">implode</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;|&#39;</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660000;background-color:#f7faff;\">$clientkeywords</span><span style=\"background-color:#f7faff;\">) . </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&quot;)/i&quot;</span><span style=\"background-color:#f7faff;\">, </span><span style=\"background-color:#f7faff;font-style:italic;\">strtolower</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$_SERVER</span><span style=\"background-color:#f7faff;\">[</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;HTTP_USER_AGENT&#39;</span><span style=\"background-color:#f7faff;\">])))<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">return true</span><span style=\"background-color:#f7faff;\">;<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;}<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">// 协议法，因为有可能不准确，放到最后判断<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">if </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">isset </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$_SERVER</span><span style=\"background-color:#f7faff;\">[</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;HTTP_ACCEPT&#39;</span><span style=\"background-color:#f7faff;\">])) </span><span style=\"background-color:#f7faff;\">{<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">// 如果只支持wml并且不支持html那一定是移动设备<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp; &nbsp; &nbsp;// 如果支持wml和html但是wml在html之前则是移动设备<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">if </span><span style=\"background-color:#f7faff;\">((</span><span style=\"background-color:#f7faff;font-style:italic;\">strpos</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$_SERVER</span><span style=\"background-color:#f7faff;\">[</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;HTTP_ACCEPT&#39;</span><span style=\"background-color:#f7faff;\">], </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;vnd.wap.wml&#39;</span><span style=\"background-color:#f7faff;\">) !== </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">false</span><span style=\"background-color:#f7faff;\">) &amp;&amp; (</span><span style=\"background-color:#f7faff;font-style:italic;\">strpos</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$_SERVER</span><span style=\"background-color:#f7faff;\">[</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;HTTP_ACCEPT&#39;</span><span style=\"background-color:#f7faff;\">], </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;text/html&#39;</span><span style=\"background-color:#f7faff;\">) === </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">false </span><span style=\"background-color:#f7faff;\">|| (</span><span style=\"background-color:#f7faff;font-style:italic;\">strpos</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$_SERVER</span><span style=\"background-color:#f7faff;\">[</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;HTTP_ACCEPT&#39;</span><span style=\"background-color:#f7faff;\">], </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;vnd.wap.wml&#39;</span><span style=\"background-color:#f7faff;\">) &lt; </span><span style=\"background-color:#f7faff;font-style:italic;\">strpos</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$_SERVER</span><span style=\"background-color:#f7faff;\">[</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;HTTP_ACCEPT&#39;</span><span style=\"background-color:#f7faff;\">], </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;text/html&#39;</span><span style=\"background-color:#f7faff;\">))))</span><span style=\"background-color:#f7faff;\">{<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">return true</span><span style=\"background-color:#f7faff;\">;<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;}<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;}<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">return false</span><span style=\"background-color:#f7faff;\">;<br/></span><span style=\"background-color:#f7faff;\">}</span></pre><p><br/></p>', 1, 0, 1540856242, 1540856391);
INSERT INTO `article` VALUES (10, '锁机制', '锁机制', '<p><span style=\";font-family:宋体;font-size:14px\"><span style=\"font-family:宋体\">当一个脚本被一个客户端访问都正常，但当多个客户端同时并发访问时，这个脚本的结果会出现不正确，这个问题需要使用锁机制来解决。在电商网站中需要用到锁的地方就是高并发下定单时减少商品库存量时。</span></span></p><p>mysql :<br/></p><p>create table test_lock(</p><p>&nbsp;&nbsp;&nbsp;&nbsp;id int ,</p><p>&nbsp;&nbsp;&nbsp;&nbsp;t_num int <br/></p><p>)engine=innodb</p><pre class=\"brush:php;toolbar:false\">&lt;?php\r\n&nbsp;&nbsp;&nbsp;&nbsp;DB::table(&#39;test_lock&#39;)-&gt;insert(1,100);\r\n&nbsp;&nbsp;&nbsp;&nbsp;//每次访问把ID减少\r\n&nbsp;&nbsp;&nbsp;&nbsp;$t_num&nbsp;=&nbsp;DB::table(&#39;test_lock&#39;)-&gt;find(1);\r\n&nbsp;&nbsp;&nbsp;&nbsp;$t_num--;\r\n&nbsp;&nbsp;&nbsp;&nbsp;DB::table(&#39;test_lock&#39;)-&gt;where(&#39;id&#39;,1)-&gt;update(array(&#39;t_num&#39;=&gt;$t_num));\r\n?&gt;</pre><p><span style=\";font-family:宋体;font-size:14px\"><span style=\"font-family:宋体\">使用</span>apaceh自带的ab.exe <span style=\"font-family:宋体\">模拟</span><span style=\"font-family:Times New Roman\">10</span><span style=\"font-family:宋体\">个用户并发访问，</span><span style=\"font-family:宋体\"></span></span></p><p>D:\\xampp\\apache\\bin\\ap.exe -c 10 -n 10 <a href=\"http://localhost/TestLock.php\" _src=\"http://localhost/TestLock.php\">http://localhost/TestLock.php</a></p><p>-c 并发量 表示有10个人用户请求，</p><p>-n 总请求次数，每个用户请求一次。</p><pre class=\"brush:php;toolbar:false;\">$t_num&nbsp;=&nbsp;DB::table(&#39;test_lock&#39;)-&gt;where(&#39;id&#39;,1)-&gt;value(&#39;t_num&#39;);\r\n此时&nbsp;$t_num&nbsp;的值&nbsp;不是90&nbsp;。\r\n\r\n锁机制\r\nMySQL&nbsp;表锁\r\nmysql&nbsp;锁&nbsp;有共享锁&nbsp;和排他锁\r\n语法：LOCK&nbsp;TABLE&nbsp;表名1&nbsp;&nbsp;&nbsp;READ|WRITE,&nbsp;表名2&nbsp;READ|WRTIE.....\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNLOCK&nbsp;TABLES;\r\n共享锁（read）:以此方式锁定表，在锁定过程中，所有客户端只有读这个表的权限。\r\n排他锁（write）:&nbsp;以此方式锁定表，在锁定过程中，只有锁定表的客户端可以进行操作，\r\n其他客户端只能等待，直到该锁释放。\r\n&lt;?php\r\n&nbsp;&nbsp;&nbsp;&nbsp;mysql_connect(&#39;127.0.0.1&#39;,&#39;root&#39;,&#39;root&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;mysql_select_db(&#39;lock_db&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;mysql_query(&#39;LOCK&nbsp;TABLE&nbsp;test_lock&nbsp;WRITE&#39;);//排他锁，锁表\r\n&nbsp;&nbsp;&nbsp;&nbsp;$rs&nbsp;=&nbsp;mysql_query(&quot;select&nbsp;t_num&nbsp;from&nbsp;test_lock&nbsp;where&nbsp;id&nbsp;=&nbsp;1&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;$t_num&nbsp;=&nbsp;mysql_fetch_row($rs)[0];\r\n&nbsp;&nbsp;&nbsp;&nbsp;$t_num--;\r\n&nbsp;&nbsp;&nbsp;&nbsp;mysql_query(&quot;update&nbsp;test_lock&nbsp;set&nbsp;t_num&nbsp;=&nbsp;{$t_num}&nbsp;where&nbsp;id&nbsp;=&nbsp;1&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;mysq_query(&quot;UNLOCK&nbsp;TABLES&quot;);//释放锁\r\n&nbsp;?&gt;</pre><p>文件锁：</p><p>已任一文件当作锁，分为共享锁（LOCK_SH）,排他锁（LOCK_EX），类似表锁</p><p>先建一个文件 t_lock.lock</p><pre class=\"brush:php;toolbar:false\">&lt;?php\r\n&nbsp;&nbsp;&nbsp;&nbsp;mysql_connect(&#39;127.0.0.1&#39;,&#39;root&#39;,&#39;root&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;mysql_select_db(&#39;lock_db&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;$fp&nbsp;=&nbsp;fopen(&#39;./t_lock.lock&#39;,&#39;r&#39;);//可以&nbsp;以读或写的方式打开文件。\r\n&nbsp;&nbsp;&nbsp;&nbsp;flock($fp,LOCK_EX);//开启锁，排他锁\r\n&nbsp;&nbsp;&nbsp;&nbsp;$rs&nbsp;=&nbsp;mysql_query(&quot;select&nbsp;t_num&nbsp;from&nbsp;test_lock&nbsp;where&nbsp;id&nbsp;=&nbsp;1&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;$t_num&nbsp;=&nbsp;mysql_fetch_row($rs)[0];\r\n&nbsp;&nbsp;&nbsp;&nbsp;$t_num--;\r\n&nbsp;&nbsp;&nbsp;&nbsp;mysql_query(&quot;update&nbsp;test_lock&nbsp;set&nbsp;t_num&nbsp;=&nbsp;{$t_num}&nbsp;where&nbsp;id&nbsp;=&nbsp;1&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;flock($fp,LOCK_UN);//释放锁\r\n&nbsp;&nbsp;&nbsp;&nbsp;fclose($fp);//开闭文件\r\n?&gt;</pre><p>两者比较</p><p><span style=\";font-family:宋体;font-size:14px\"><span style=\"font-family:宋体\">比如在电商下定单时我们要锁定商品表，如果下单的人非常多，就会导致商品表一直是锁定的状态，那么整个网站所有的要读商品表的功能都会阻塞无法读出商品，知道该表释放，因此把整个网站拖慢了。</span></span></p><p><span style=\";font-family:宋体;font-size:14px\"><span style=\"font-family:宋体\">而文件锁只是锁定了一个跟网站没有关系的文件，对网站其他功能没影响。因此除非 项目中一个表只用在一个功能，否则建议用 文件锁。</span></span></p><p><span style=\";font-family:宋体;font-size:14px\"><span style=\"font-family:宋体\"><br/></span></span></p><p><span style=\";font-family:宋体;font-size:14px\"><span style=\"font-family:宋体\">类似语言 Java</span></span></p><p><span style=\";font-family:宋体;font-size:14px\"><span style=\"font-family:宋体\">锁机制是 synchronized <br/></span></span></p><p><br/></p>', 1, 0, 1540976572, 1540978430);
INSERT INTO `article` VALUES (11, 'checked 选中事件', 'checked 选中事件', '<p>jquery判断checked方法:<br/>.attr(&#39;checked&#39;); &nbsp; // 1.6+返回:checked或undefined”1.5-返回:true或false<br/>.prop(&#39;checked&#39;); &nbsp;//16+:true/false<br/>.is(&#39;:checked&#39;); &nbsp; //所有版本:true/false</p><pre class=\"brush:js;toolbar:false\">&lt;form&gt;\r\n&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&#39;checked&#39;&nbsp;name=&#39;hobby&#39;&nbsp;class=&quot;hobby&quot;&nbsp;value=&#39;1&#39;/&gt;&nbsp;car&nbsp;&lt;br/&gt;\r\n&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&#39;checked&#39;&nbsp;name=&#39;hobby&#39;&nbsp;class=&quot;hobby&quot;&nbsp;value=&#39;2&#39;/&gt;&nbsp;dog&nbsp;&lt;br/&gt;\r\n&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&#39;checked&#39;&nbsp;name=&#39;hobby&#39;&nbsp;class=&quot;hobby&quot;&nbsp;value=&#39;3&#39;/&gt;&nbsp;&nbsp;cat&nbsp;&lt;br/&gt;&nbsp;\r\n&lt;/form&gt;\r\n$(function(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;hobby_arr&nbsp;=&nbsp;[];\r\n&nbsp;&nbsp;&nbsp;&nbsp;$(&quot;input[name=&#39;hobby&#39;]&quot;).each(function(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($(this).is(&#39;:checked&#39;))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hobby.push($(this).val());\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;});\r\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;hobby_str&nbsp;=&nbsp;hobby_arr.join(&#39;,&#39;);&nbsp;//将数组转化为字符串，并用逗号隔开。\r\n});</pre><p>jquery 赋值checked<br/></p><pre class=\"brush:js;toolbar:false\">//所有的jquery版本都可以这样赋值:\r\n$(&quot;.hobby&quot;).attr(&quot;checked&quot;,&quot;checked&quot;);\r\n$(&quot;.hobby&quot;).attr(&quot;checked&quot;,true);\r\n//jquery1.6+:prop的4种赋值:\r\n$(&quot;.hobby″).prop(&quot;checked&quot;,&quot;checked&quot;);\r\n$(&quot;.hobby″).prop(&quot;checked&quot;,true);&nbsp;\r\n$(&quot;.hobby″).prop({checked:true});&nbsp;\r\n$(&quot;.hobby″).prop(&quot;checked&quot;,function(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;//函数返回true或false&nbsp;\r\n&nbsp;});\r\n&nbsp;//for&nbsp;example\r\n$(function(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;$(&quot;input[name=&#39;hobby&#39;]&quot;).each(function(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($(this).val()&nbsp;==&nbsp;2&nbsp;)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(this).attr(&#39;checked&#39;,true);//将值是2的checkbox&nbsp;选中。\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;});\r\n&nbsp;&nbsp;&nbsp;&nbsp;适用ajax&nbsp;回调\r\n&nbsp;&nbsp;&nbsp;&nbsp;$.ajax({\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method:&nbsp;&#39;get&#39;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;:&nbsp;&#39;./getUserInfo.php&#39;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;date:&nbsp;{user_id:1},\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataType:&nbsp;&#39;json&#39;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;success:&nbsp;function(ret){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(ret.status&nbsp;=&nbsp;0)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;user&nbsp;=&nbsp;ret.data;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;hobby_all&nbsp;=&nbsp;[1,2,3];&nbsp;//所有的值\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;hobby_str&nbsp;=&nbsp;user.hobby;&nbsp;//1,3&nbsp;从数据库获取的值\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;hobby_arr&nbsp;=&nbsp;hobby_str.split(&#39;,&#39;);//[1,3]\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;len&nbsp;=&nbsp;hobby_arr.length;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var&nbsp;i=0&nbsp;;&nbsp;i&lt;len&nbsp;;i++)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($.inArray($hobby_arr[i],hobby_all))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(this).attr(&#39;checked&#39;,true);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;});\r\n});</pre><pre class=\"brush:xml;toolbar:false;\">getUserInfo.php&nbsp;文件</pre><pre class=\"brush:php;toolbar:false\">&lt;?php\r\n&nbsp;&nbsp;&nbsp;&nbsp;$user_id&nbsp;=&nbsp;isset($_GET[&#39;user_id&#39;])&nbsp;?&nbsp;$_GET[&#39;user_id&#39;]&nbsp;:&nbsp;&#39;&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;if($user_id)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$user&nbsp;=&nbsp;DB::table(&#39;User&#39;)-&gt;where(&#39;id&#39;,$user_id)-&gt;first();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ret&nbsp;=&nbsp;array(\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;status&#39;=&gt;0,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;data&#39;=&gt;$user\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;json_encode($ret);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n?&gt;</pre><p><strong>checkbox click和change事件</strong></p><pre class=\"brush:js;toolbar:false\">$(&quot;#ischange&quot;).change(function()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;alert(&quot;checked&quot;);&nbsp;\r\n});\r\nif($.browser.msie){&nbsp;\r\n&nbsp;&nbsp;$(&#39;input:checkbox&#39;).click(function&nbsp;()&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;this.blur();&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;this.focus();&nbsp;\r\n&nbsp;&nbsp;});&nbsp;\r\n};\r\n$(&quot;#ischange&quot;).change(function()&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;alert(&quot;checked&quot;);&nbsp;\r\n});&nbsp;\r\n$(&quot;testCheckbox&quot;).change(function()&nbsp;{\r\n&nbsp;alert(&quot;Option&nbsp;changed!&quot;);&nbsp;\r\n});</pre><p><br/></p><p>出处：<a href=\"http://www.cnblogs.com/zqifa/\" target=\"_blank\">http://www.cnblogs.com/zqifa/</a></p><p><br/></p>', 2, 0, 1541060641, 1541159217);
INSERT INTO `article` VALUES (12, '字符集乱码', '字符集乱码', '<p>字符集转换</p><p>iconv(&#39;utf-8&#39;,&#39;gbk&#39;,$content);</p>', 1, 0, 1541139029, NULL);
INSERT INTO `article` VALUES (13, '防sql 注入', '防sql 注入', '<ol class=\" list-paddingleft-2\" style=\"list-style-type: decimal;\"><li><p>字符串 addslashes();</p></li><li><p>对于整数 intval() 转换成整数，或 $_GET[&#39;param&#39;] + 0 ;</p><p>xss(cross site scripting)跨栈脚本攻击.</p><p>htmlspecialchars();</p></li></ol>', 1, 0, 1541139296, NULL);
INSERT INTO `article` VALUES (14, '文件上传', '文件上传', '<p>if($_FILE[&#39;ing&#39;][&#39;error&#39;] == 0 &amp;&amp; $_FILE[&#39;ing&#39;][&#39;error&#39;] == 4) {</p><p>&nbsp; &nbsp;echo &#39;file up ok&#39;;<br/></p><p>}</p><p>error 值</p><p>0.无错误，1.文件过大，2.表单文件超出最大限制 MAX-FILE 3.上传部分文件（中断）4.未上传文件</p><p>5.上传空文件（大小未null） 6.没有找到临时上传目录（Linux 权限限制）</p><p>7.临时文件导入失败（文件满，磁盘空间没有写入权限）</p><p>多文件上传：文件域</p><p>&lt;input type=&#39;file&#39; name=img[0] /&gt;</p><p>&lt;input type=&#39;file&#39; name=img[1] /&gt;</p>', 1, 0, 1541139814, NULL);
INSERT INTO `article` VALUES (15, '重定向', '重定向', '<p>重定向跳转</p><p>window.location.href = &#39;index.php?c=3&#39;;</p><p>window是超全局变量 ，可省略。</p><p>location.href = &#39;index.php&#39;;</p><p>跳转传参：</p><p>location.assign({a:3});</p><p><br/></p>', 2, 0, 1541140097, NULL);
INSERT INTO `article` VALUES (16, '数组排序方式', '数组排序方式', '<pre class=\"brush:php;toolbar:false\">&lt;?php\r\n$arr&nbsp;=&nbsp;array(34,5,6,77,44,3);\r\n//冒泡排序：如果后面数小于前者，则替换，第一轮结束，最后一个数&nbsp;是数组中最大的数。\r\nfunction&nbsp;bubbleSort($arr){\r\n&nbsp;&nbsp;&nbsp;&nbsp;$len&nbsp;=&nbsp;count($arr);\r\n&nbsp;&nbsp;&nbsp;&nbsp;if($len&nbsp;&lt;=&nbsp;1)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$arr;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;$i&nbsp;=&nbsp;0;&nbsp;$i&nbsp;&lt;&nbsp;$len&nbsp;&nbsp;;&nbsp;$i++)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;$j&nbsp;=&nbsp;0&nbsp;;$j&nbsp;&lt;&nbsp;$len&nbsp;-&nbsp;$i&nbsp;-1;$j++)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($arr[$j]&nbsp;&gt;&nbsp;$arr[$j+1])&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$temp&nbsp;=&nbsp;$arr[$j+1];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$arr[$j+1]&nbsp;=&nbsp;$arr[$j];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$arr[$j]&nbsp;=&nbsp;$temp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;var_dump($arr);\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$arr;\r\n}\r\nbubbleSort($arr);\r\n//选择排序：假设数组中第一个数最小，后面数与最小值比较，第一轮排序后，将最小数替换到最前面\r\nfunction&nbsp;selectSort($arr)&nbsp;{\r\n	$len&nbsp;=&nbsp;count($arr);\r\n	if&nbsp;($len&nbsp;&lt;&nbsp;1)&nbsp;{\r\n		return&nbsp;$arr;\r\n	}\r\n	for&nbsp;($i=0&nbsp;;&nbsp;$i&lt;$len&nbsp;-1&nbsp;;$i++)&nbsp;{\r\n		$min&nbsp;=&nbsp;$i;\r\n		for&nbsp;($j=$i;&nbsp;$j&nbsp;&lt;&nbsp;$len&nbsp;&nbsp;;&nbsp;$j++)&nbsp;{&nbsp;\r\n			if&nbsp;(&nbsp;$arr[$min]&nbsp;&gt;&nbsp;$arr[$j]&nbsp;)&nbsp;{\r\n				$min&nbsp;=&nbsp;$j;\r\n			}\r\n		}\r\n		if($min&nbsp;!=&nbsp;$i)&nbsp;{\r\n			$temp&nbsp;=&nbsp;$arr[$i];\r\n			$arr[$i]&nbsp;=&nbsp;$arr[$min];\r\n			$arr[$min]&nbsp;=&nbsp;$temp;\r\n		}\r\n		\r\n	}\r\n	var_dump($arr);\r\n	return&nbsp;$arr;\r\n}\r\n//快速排序，将数组中的值与第一个数及比较，大于第一个值放右边数组，反之放左边数组，\r\n//然后递归&nbsp;对左右两个数组排序，三者进行合并\r\n\r\nfunction&nbsp;quickSelect($arr)&nbsp;{\r\n	if(!is_array($arr))&nbsp;{\r\n		return&nbsp;false;\r\n	}\r\n	$len&nbsp;=&nbsp;count($arr);&nbsp;\r\n	if&nbsp;($len&nbsp;&lt;=&nbsp;1)&nbsp;{\r\n		return&nbsp;$arr;\r\n	}\r\n	$quick_left&nbsp;=&nbsp;array();\r\n	$query_right&nbsp;=&nbsp;array();\r\n	for&nbsp;($i=1;&nbsp;$i&nbsp;&lt;&nbsp;$len;&nbsp;$i++)&nbsp;{&nbsp;\r\n		if&nbsp;($arr[$i]&nbsp;&lt;&nbsp;$arr[0])&nbsp;{\r\n			$quick_left[]&nbsp;=&nbsp;$arr[$i];\r\n		}&nbsp;else{\r\n			$query_right[]&nbsp;=&nbsp;$arr[$i];\r\n		}\r\n	}\r\n	$quick_left&nbsp;=&nbsp;quickSelect($quick_left);\r\n	$quick_right&nbsp;=&nbsp;quickSelect($query_right);\r\n\r\n	return&nbsp;array_merge($quick_left,array($arr[0]),$quick_right);\r\n}</pre><p>?&gt;</p>', 1, 0, 1541141586, 1541158589);
INSERT INTO `article` VALUES (17, 'linux基本指令', 'linux基本指令', '<p>&nbsp;vim 中</p><p>快速查找内容&nbsp;&nbsp; /search , n 下一个<br/></p><p>&nbsp;显示行数 :set nu<br/> </p><p><br/></p><p>根据文件名找到文件的位置</p><p>find -name php.ini</p><p>find / -name php.ini<br/></p><p>查看软件进程</p><p>ps -A | grep redis</p><p>已安装软件</p><p>rpm -qa | grep php</p><p><br/></p><p>Linux 服务器乱码<br/>&nbsp;查看语言 echo $LANG<br/>&nbsp;en_US.UTF-8 <br/>&nbsp;查看已安装的语言包 locale<br/>&nbsp;如果没有.UTF-8下载安装中文语言包yum groupinstall chinese-support<br/>临时修改 LANG=&quot;Zn_CN.UTF-8&quot; <br/></p><p><br/></p><p>apache 重启</p><p>/usr/local/apache/bin/apachectl restart</p><p>service&nbsp; httpd restart</p><p><br/></p><p><br/></p><p>nginx 平滑重启</p><p>nginx -s reload</p><p>server nginx restart<br/></p>', 4, 0, 1541166299, 1548382713);
INSERT INTO `article` VALUES (18, '支付宝支付', '支付宝支付', '<p>电脑网站支付</p><p>因支付宝排版布局经常改变，此处不加url 跳转地址</p><p>1 在支付宝支付托，和蚂蚁金服注册商家账号，上传营业执照等信息。</p><p>2 信息审核，支付要有在线的域名，且能正常访问。</p><p>3 在蚂蚁金服 开发者中心 创建应用，获取到商户的appid,并申请电脑和手机支付接口签约，下载SDK。</p><p>4 根据支付宝api 下载软件，生成商户的私钥，公钥，选2048位，用shl2加密方式。</p><p>5 在我的应用中，将商家公钥进行上传，获取支付宝公钥，同时填写notify_url,return_url ，与后面配置文件一致。</p><p>6 代码中配置参数。以ThinkPHP 为例</p><pre class=\"brush:php;toolbar:false\">&lt;?php\r\n&nbsp;&nbsp;&nbsp;&nbsp;//根据订单号生成二维码，扫码支付\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;pay_zfb(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$id&nbsp;=&nbsp;I(&#39;get.id&#39;);//&nbsp;接收定单ID\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$tp&nbsp;=&nbsp;M(&#39;Order&#39;)-&gt;find($id);&nbsp;&nbsp;//&nbsp;查询定单总价等信息&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$config&nbsp;=&nbsp;array(\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;app_id&#39;&nbsp;=&gt;&nbsp;&quot;20181017********&quot;,&nbsp;//应用ID,您的商户APPID。\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;merchant_private_key&#39;&nbsp;=&gt;&nbsp;&quot;MIIEpAIBAAKCmVoI9D2A==.........&quot;,&nbsp;//商户私钥\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//异步通知地址,根据支付后的状态，订单等业务逻辑处理。用户看不到。\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;notify_url&#39;&nbsp;=&gt;&nbsp;&quot;http://www.yourWebsite.com/index.php/Pc/Order/zfb_notify_url&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//同步跳转，支付成功后，跳转到成功页面，告知客户\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;return_url&#39;&nbsp;=&gt;&nbsp;&quot;http://www.yourWebsite.com/index.php/Pc/Order/zfb_success&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;charset&#39;&nbsp;=&gt;&nbsp;&quot;UTF-8&quot;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;sign_type&#39;=&gt;&quot;RSA2&quot;,&nbsp;//签名方式&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;gatewayUrl&#39;&nbsp;=&gt;&nbsp;&quot;https://openapi.alipay.com/gateway.do&quot;,&nbsp;//支付宝网关\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;alipay_public_key&#39;&nbsp;=&gt;&nbsp;&quot;MIIBIjANIDAQAB......&quot;,//支付宝公钥&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/************&nbsp;生成支付宝的按钮&nbsp;**************/\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;require_once(&quot;./alipayPc/AopSdk.php&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;require_once(&quot;./alipayPc/pagepay/service/AlipayTradeService.php&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;require_once(&quot;./alipayPc/pagepay/buildermodel/AlipayTradePagePayContentBuilder.php&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$payment_type&nbsp;=&nbsp;&quot;1&quot;;//支付类型&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$seller_email&nbsp;=&nbsp;&#39;15888889999@163.com&#39;;&nbsp;//必填，不能修改&nbsp;商户支付宝帐户&nbsp;-&nbsp;收钱的账号\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out_trade_no&nbsp;=&nbsp;$tp[&#39;order_number&#39;];//必填购买商品订单号\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$subject&nbsp;=&nbsp;&#39;小二郎干洗店&#39;;&nbsp;//订单名称&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$total_amount&nbsp;=&nbsp;$tp[&#39;total_price&#39;];&nbsp;&nbsp;//必填&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$body&nbsp;=&nbsp;&#39;洗洗更健康;//必填订单描述\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$payRequestBuilder&nbsp;=&nbsp;new&nbsp;\\AlipayTradePagePayContentBuilder();&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$payRequestBuilder-&gt;setBody($body);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$payRequestBuilder-&gt;setSubject($subject);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$payRequestBuilder-&gt;setTotalAmount($total_amount);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$payRequestBuilder-&gt;setOutTradeNo($out_trade_no);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$aop&nbsp;=&nbsp;new&nbsp;\\AlipayTradeService($config);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;pagePay&nbsp;电脑网站支付请求\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$builder&nbsp;业务参数，使用buildmodel中的对象生成。\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$return_url&nbsp;同步跳转地址，公网可以访问\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;$notify_url&nbsp;异步通知地址，公网可以访问\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;$response&nbsp;支付宝返回的信息\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$response&nbsp;=&nbsp;$aop-&gt;pagePay($payRequestBuilder,$config[&#39;return_url&#39;],$config[&#39;notify_url&#39;]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//输出支付二维码\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var_dump($response);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;//支付后跳转&nbsp;，支付成功页面\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;zfb_success(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isMobile())&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//电脑和手机&nbsp;跳转相应的显示页面\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redirect(U(&#39;Mobile/Order/zfb_success&#39;));\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;display();\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;接收支付宝发过来的消息\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;zfb_notify_url(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;config&nbsp;=&nbsp;array(\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;app_id&#39;&nbsp;=&gt;&nbsp;&quot;20181017********&quot;,&nbsp;//应用ID,您的商户APPID。\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;merchant_private_key&#39;&nbsp;=&gt;&nbsp;&quot;MIIEpAIBAAKCmVoI9D2A==.........&quot;,&nbsp;//商户私钥\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//异步通知地址,根据支付后的状态，订单等业务逻辑处理。用户看不到。\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;notify_url&#39;&nbsp;=&gt;&nbsp;&quot;http://www.yourWebsite.com/index.php/Pc/Order/zfb_notify_url&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//同步跳转，支付成功后，跳转到成功页面，告知客户\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;return_url&#39;&nbsp;=&gt;&nbsp;&quot;http://www.yourWebsite.com/index.php/Pc/Order/zfb_success&quot;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;charset&#39;&nbsp;=&gt;&nbsp;&quot;UTF-8&quot;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;sign_type&#39;=&gt;&quot;RSA2&quot;,&nbsp;//签名方式&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;gatewayUrl&#39;&nbsp;=&gt;&nbsp;&quot;https://openapi.alipay.com/gateway.do&quot;,&nbsp;//支付宝网关\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;alipay_public_key&#39;&nbsp;=&gt;&nbsp;&quot;MIIBIjANIDAQAB......&quot;,//支付宝公钥&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include(&#39;./alipayPc/pagepay/service/AlipayTradeService.php&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$arr&nbsp;=&nbsp;$_POST;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$alipaySevice&nbsp;=&nbsp;new&nbsp;\\AlipayTradeService($config);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$alipaySevice-&gt;writeLog(var_export($_POST,true));\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result&nbsp;=&nbsp;$alipaySevice-&gt;check($arr);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;判断检查结果数据\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($result)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$out_trade_no&nbsp;=&nbsp;$_POST[&#39;out_trade_no&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//商户订单号\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$trade_no&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;$_POST[&#39;trade_no&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//支付宝交易号\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$trade_status&nbsp;=&nbsp;$_POST[&#39;trade_status&#39;];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//交易状态\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;判断数据是否做过处理，如果做过处理，return，没有做过处理，执行支付成功代码\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_POST[&#39;trade_status&#39;]&nbsp;==&nbsp;&#39;TRADE_FINISHED&#39;&nbsp;||&nbsp;$_POST[&#39;trade_status&#39;]&nbsp;==&nbsp;&#39;TRADE_SUCCESS&#39;)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;修改订单状态等业务逻辑\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$orderModel&nbsp;=&nbsp;D(&#39;Admin/Order&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$orderModel-&gt;setOrderPay($out_trade_no,$trade_no);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;success&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;fail&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;fail&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n?&gt;</pre><p>支付可能遇到问题：</p><p>1 thinkphp3.2 公共函数 C() 方法与支付宝命名相同</p><p>&nbsp;&nbsp;&nbsp;&nbsp;解决方式，找到支付宝某类下C() 方法，改名成CC();<br/></p><p>2 openssl 未开启&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;在linux find -name php.ini 开启，找不到，添加 expensions=php_openssl<br/></p><p>3 异步代用成功，但是返回值是false 不能处理后续业务逻辑，</p><p>&nbsp;&nbsp;&nbsp;&nbsp;支付宝公钥 等配置是否正确<br/></p><p>手机浏览器支付，也可以和电脑支付 用同一个sdk ，支付宝在手机上会自动授权，</p><p>然后跳转到支付宝客户端支付</p>', 1, 0, 1541221204, 1541221394);
INSERT INTO `article` VALUES (19, '消息队列beanstalkd', '', '<p>beanstalkd 消息队列</p><p>异步，解耦，定时任务</p><p>Beanstalkd消息队列的安装与使用</p><p>一、Beanstalkd是什么？</p><p>Beanstalkd是一个高性能，轻量级的分布式内存队列</p><p>二、Beanstalkd特性</p><p>1、支持优先级(支持任务插队)</p><p>2、延迟(实现定时任务)</p><p>3、持久化(定时把内存中的数据刷到binlog日志)</p><p>4、预留(把任务设置成预留，消费者无法取出任务，等某个合适时机再拿出来处理)</p><p>5、任务超时重发</p><p>(time-to-run 消费者必须在指定时间内处理任务，如果没有则认为任务失败，重新进入队列)</p><p>三、Beanstalkd核心元素</p><p>生产者 -&gt; 管道(tube) -&gt; 任务(job) -&gt; 消费者</p><p>Beanstalkd可以创建多个管道，管道里面存了很多任务，消费者从管道中取出任务进行处理&nbsp;</p><p>如注册管道：只负责注册，队列进行邮件发送等。</p><p>订单管道：库存量问题</p><p>四、任务job状态</p><p><span style=\"white-space:pre\"></span>delayed 延迟状态</p><p><span style=\"white-space:pre\"></span>ready 准备好状态</p><p><span style=\"white-space:pre\"></span>reserved 消费者把任务读出来，处理时</p><p><span style=\"white-space:pre\"></span>buried 预留状态</p><p><span style=\"white-space:pre\"></span>delete 删除状态</p><p><br/></p><p>预留状态，如火车售票，每一个售票窗口都是一个管道，消费者购票需要支付，</p><p>当消费者未付款，此管道任务将被buried ，直到支付。</p><p>任务进入管道有两种状态，</p><p>一 ready&nbsp;</p><p>二 delayed 延迟多少毫秒执行，时间到后，会变成 ready ，</p><p>只有在ready 状态，任务才能被消费者读取。</p><p>消费者读取任务时，状态变成 reserved,进行任务处理。</p><p>处理结束 ，可以删除任务 delete 或者 某种条件下 buried,</p><p>也可以ready ,delayed</p><p>五、安装Beanstalkd</p><p>不支持windows</p><p>https://beanstalkd.github.io/download.html</p><p>下载beanstalkd-1.10.tar.gz</p><p><span style=\"white-space:pre\"></span>tar -xvzf beanstalkd-1.10.tar.gz</p><p><span style=\"white-space:pre\"></span>cd beanstalkd-1.10</p><p>//./configure // 高版本不需要执行此命令&nbsp;</p><p><span style=\"white-space:pre\"></span>make</p><p>make install</p><p><br/></p><p>查看beanstalkd参数信息</p><p>&nbsp;<span style=\"white-space:pre\"></span>&nbsp;beanstalkd -h</p><p>&nbsp;启动beanstalkd</p><p>beanstalkd -l 127.0.0.1 -p 11300 -b /data/beanstalkd/binlog &amp;</p><p>&nbsp;-b表示开启binlog，断电后重启自动恢复任务　　</p><p>添加用户组：</p><p>groupadd beanstalkd</p><p>添加用户：</p><p>adduser -M -g beanstalkd -s /sbin/nologin beanstalkd</p><p>添加启动脚本，放入 /etc/init.d/ 目录下</p><p>chmod 755 /etc/init.d/beanstalkd</p><p>//&nbsp; /etc/init.d/beanstalkd stauts</p><p>依赖php插件，必须要php7.0以上版本</p><p>加入开机启动：</p><p>chkconfig beanstalkd&nbsp; on</p><p>启动：</p><p>service beanstalkd start</p><p>六、下载Pheanstalk类</p><p>首先安装composer</p><p>&nbsp;curl -sS https://getcomposer.org/installer | php</p><p>&nbsp;mv composer.phar /usr/local/bin/composer</p><p>&nbsp;composer require pda/pheanstalk</p><p>编写一个简单脚本查看信息</p><pre class=\"brush:php;toolbar:false\">&lt;?php\r\nrequire&nbsp;&#39;./vendor/autoload.php&#39;;\r\nuse&nbsp;Pheanstalk\\Pheanstalk;&nbsp;\r\n$p&nbsp;=&nbsp;new&nbsp;Pheanstalk(&#39;127.0.0.1&#39;,&nbsp;11300);\r\n//查看beanstalkd当前的状态信息\r\nvar_dump($p-&gt;stats());</pre><p>七、Pheanstalk使用方法</p><p>stats() 查看状态方法</p><p>listTubes() 目前存在的管道</p><p>listTubesWatched() 目前监听的管道</p><p>statsTube() 管道的状态</p><p>useTube() 指定使用的管道</p><p>statsJob() 查看任务的详细信息</p><p>peek() 通过任务ID获取任务</p><p><br/></p><p>生产者方法</p><p>putInTube() 往管道中写入数据</p><p>put() 配合useTube()使用</p><p><br/></p><p>消费者方法</p><p>watch() 监听管道，可以同时监听多个管道</p><p>ignore() 不监听管道</p><p>reserve() 以阻塞方式监听管道，获取任务</p><p>reserveFromTube()</p><p>release() 把任务重新放回管道</p><p>bury() 把任务预留</p><p>peekBuried() 把预留任务读取出来</p><p>kickJob() 把buried状态的任务设置成ready</p><p>kick() 批量把buried状态的任务设置成ready</p><p>peekReady() 把准备好的任务读取出来</p><p>peekDelayed() 把延迟的任务读取出来</p><p>pauseTube() 给管道设置延迟</p><p>resumeTube() 取消管道延迟</p><p>touch() 让任务重新计算ttr时间，给任务续命</p><p><br/></p><p>生产者producer.php代码如下：</p><pre class=\"brush:php;toolbar:false\">&lt;?php\r\nrequire&nbsp;&#39;./vendor/autoload.php&#39;;\r\nuse&nbsp;Pheanstalk\\Pheanstalk;\r\n//创建一个Pheanstalk对象\r\n$p&nbsp;=&nbsp;new&nbsp;Pheanstalk(&#39;192.168.1.222&#39;,&nbsp;11300);\r\n$data&nbsp;=&nbsp;array(\r\n&nbsp;&nbsp;&nbsp;&nbsp;&#39;id&#39;&nbsp;=&gt;&nbsp;1,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&#39;name&#39;&nbsp;=&gt;&nbsp;&#39;test&#39;,\r\n);\r\n//向userReg管道中添加任务，返回任务ID\r\n//put()方法有四个参数\r\n//第一个任务的数据\r\n//第二个任务的优先级，值越小，越先处理\r\n//第三个任务的延迟\r\n//第四个任务的ttr超时时间\r\n$id&nbsp;=&nbsp;$p-&gt;useTube(&#39;userReg&#39;)-&gt;put(json_encode($data));\r\n//获取任务\r\n$job&nbsp;=&nbsp;$p-&gt;peek($id);\r\n//查看任务状态\r\nprint_r($p-&gt;statsJob($job));</pre><p>消费者consumer.php代码如下：</p><pre class=\"brush:php;toolbar:false\">&lt;?php\r\nrequire&nbsp;&#39;./vendor/autoload.php&#39;;\r\nuse&nbsp;Pheanstalk\\Pheanstalk;\r\n//创建一个Pheanstalk对象\r\n$p&nbsp;=&nbsp;new&nbsp;Pheanstalk(&#39;192.168.1.222&#39;,&nbsp;11300);&nbsp;\r\n//监听userReg管道，忽略default管道\r\n$job&nbsp;=&nbsp;$p-&gt;watch(&#39;userReg&#39;)-&gt;ignore(&#39;default&#39;)-&gt;reserve();\r\n$data&nbsp;=&nbsp;json_decode($job-&gt;getData());\r\n//打印任务中的数据\r\nprint_r($data);\r\n//最后删除任务，表示任务处理完成\r\n$p-&gt;delete($job);</pre><p><br/></p>', 1, 0, 1541330762, 1541342682);
INSERT INTO `article` VALUES (20, 'mysql 字符集', 'mysql 字符集', '<p>一、查看MySQL数据库服务器和数据库MySQL字符集。</p><p><br/></p><p>&nbsp; &nbsp; mysql&gt; show variables like &#39;%char%&#39;; &nbsp;</p><p>character_set_client 为客户端编码方式</p><p><br/></p><p>character_set_connection 为建立连接使用的编码</p><p><br/></p><p>character_set_database 数据库的编码</p><p><br/></p><p>character_set_results 结果集的编码</p><p><br/></p><p>character_set_server 数据库服务器的编码</p><p><br/></p><p><br/></p><p>二、查看MySQL数据表（table）的MySQL字符集。</p><p><br/></p><p>&nbsp; &nbsp; mysql&gt; show table status from sqlstudy_db like &#39;%countries%&#39;; &nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span></p><p>三、查看MySQL数据列（column）的MySQL字符集。</p><p><br/></p><p>&nbsp; &nbsp; mysql&gt; show full columns from countries; &nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span></p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span></p><p><br/></p><p>修改表的默认字符集:</p><p><br/></p><p>ALTER TABLE table_name DEFAULT CHARACTER SET character_name;</p><p><br/></p><p>修改表字段的默认字符集:</p><p><br/></p><p>ALTER TABLE table_name CHANGE field field field_type CHARACTER SET character_name [other_attribute]</p><p><br/></p><p>修改表的默认字符集和所有列的字符集:</p><p><br/></p><p>ALTER TABLE table_name CONVERT TO CHARACTER SET character_name</p><p>ALTER TABLE audit_config CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci</p><p><br/></p>', 5, 0, 1541399761, NULL);
INSERT INTO `article` VALUES (21, 'Redis 安装 和php下使用', 'Redis 安装 和php下使用', '<p>Redis 安装 和php下使用<br/>linux 安装</p><p>centos:<br/></p><p>&nbsp;wget http://download.redis.io/releases/redis-4.0.0.tar.gz<br/>&nbsp;tar xzf redis-4.0.0.tar.gz<br/>&nbsp;cd redis-4.0.0<br/>&nbsp;make<br/>&nbsp;//无需configure make install<br/>&nbsp;//安装后将redis客户端和服务端复制到local下<br/>&nbsp;cd src <br/>&nbsp;mkdir /usr/local/redis<br/>&nbsp;cp redis-cli redis-server /usr/local/redis<br/>&nbsp;cd ../<br/>&nbsp;cp redis.conf /usr/local/redis<br/>&nbsp;<br/>&nbsp;cd /usr/local/redis<br/>//前台启动服务器<br/>./reids-server<br/>&nbsp;//此时实在前台启动redis ，切换到后台，修改配置文件<br/>&nbsp;vim ./redis.conf<br/>&nbsp;//daemonize no&nbsp; 改成 daemonize yes //变成redis在前台启动<br/>&nbsp;./redis-server redis.conf //将redis.conf 当做参数传递，否则配置文件修改无效<br/>&nbsp;//查看是否启动成功<br/>&nbsp;ps -A | grep redis<br/>&nbsp;//进入 redis 操作终端<br/>&nbsp;./redis-cli<br/>&nbsp; <br/></p><p>window 安装</p><p>下载地址：<a href=\"https://github.com/dmajkic/redis/downloads。\" _src=\"https://github.com/dmajkic/redis/downloads。\">https://github.com/dmajkic/redis/downloads。</a><br/></p><p>下载到的Redis支持32bit和64bit。根据自己实际情况选择，将64bit的内容cp到自定义盘符安装目录取名redis。 如 C:\\reids</p><p>打开一个cmd窗口 使用cd命令切换目录到 C:\\redis 运行 <strong>redis-server.exe redis.conf</strong> 。</p><p>将C:\\redis 配置到环境变量path 中</p><p>运行redis&nbsp;&nbsp; redis-cli.exe -h 127.0.0.1 -p 6379 <br/></p><p>安装php_redis 拓展</p><p>1 使用phpinfo()函数查看PHP的版本信息，这会决定扩展文件版本。<br/>2 根据PHP版本号，编译器版本号和CPU架构，<br/>例如选择php_redis-2.2.5-5.6-ts-vc11-x64.zip和php_igbinary-1.2.1-5.5-ts-vc11-x64.zip</p><p>php5.6<br/></p><p>http://windows.php.net/downloads/pecl/releases/redis/2.2.7/<br/>http://windows.php.net/downloads/pecl/releases/igbinary/2.0.1/<br/>php7.2</p><p><a href=\"http://windows.php.net/downloads/pecl/snaps/redis/\" _src=\"http://windows.php.net/downloads/pecl/snaps/redis/\">http://windows.php.net/downloads/pecl/snaps/redis/</a><br/></p><p>或&nbsp;</p><p>https://windows.php.net/downloads/pecl/releases/redis/</p><p><br/></p><p>http://windows.php.net/downloads/pecl/releases/igbinary/</p><p>3 解压缩后，将php_redis.dll和php_igbinary.dll拷贝至php的ext目录下<br/><br/>4 修改php.ini，在该文件中加入：<br/>; php_redis<br/>extension=php_igbinary.dll<br/>extension=php_redis.dll<br/></p><pre class=\"brush:php;toolbar:false\">&lt;?php\r\n$redis&nbsp;=&nbsp;new&nbsp;\\Redis();\r\n$redis-&gt;connect(&#39;127.0.0.1&#39;,&#39;6379&#39;);\r\n$redis-&gt;set(&#39;age&#39;,18);\r\necho&nbsp;$redis-&gt;get(&#39;age&#39;);</pre><p>&nbsp;<br/></p><p><br/></p>', 4, 0, 1541603475, 1551493023);
INSERT INTO `article` VALUES (22, '禅道安装', '禅道安装', '<p>下载源码</p><p>wget&nbsp; <a href=\"http://dl.cnezsoft.com/zentao/9.1.2/ZenTaoPMS.9.1.2.zip\" _src=\"http://dl.cnezsoft.com/zentao/9.1.2/ZenTaoPMS.9.1.2.zip\">http://dl.cnezsoft.com/zentao/9.1.2/ZenTaoPMS.9.1.2.zip</a><br/></p><p>复制到域名目录</p><p>cp <a href=\"http://dl.cnezsoft.com/zentao/9.1.2/ZenTaoPMS.9.1.2.zip\" _src=\"http://dl.cnezsoft.com/zentao/9.1.2/ZenTaoPMS.9.1.2.zip\">http://dl.cnezsoft.com/zentao/9.1.2/ZenTaoPMS.9.1.2.zip</a> /home/www/<br/></p><p>cd /home/www<br/></p><p>解压并重命名<br/></p><p>&nbsp;unzip ZenTaoPMS.9.1.2.zip -d ./zentao/</p><p>访问并安装</p><p><a href=\"http://www.xxx.com/www/index.php\" _src=\"http://www.xxx.com/www/index.php\">www.xxx.com/www/index.php</a><br/></p><p>&nbsp; <br/></p><p>安装过程遇到问题：</p><p>session 存储目录不存在 目录不可写 ？</p><p>在php.ini中将 session.save_path = /var</p><p>chmod -R 777 /var</p><p>service php-fpm restart</p><p><br/></p>', 4, 0, 1543311536, 1543311737);
INSERT INTO `article` VALUES (23, '下拉多选', '下拉多选', '<pre class=\"brush:js;toolbar:false\">多选&nbsp;multiple=&#39;true&#39;&nbsp;或&nbsp;multiple=&#39;multiple&#39;\r\n\r\n\r\n&lt;select&nbsp;class=&quot;teacher_nationality&nbsp;&quot;&nbsp;name=&quot;teacher_nationality&quot;&nbsp;multiple=&quot;true&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;value=&quot;1&quot;&gt;中国&lt;/option&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;value=&quot;2&quot;&gt;美国&lt;/option&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;value=&quot;3&quot;&gt;英国&lt;/option&gt;\r\n&lt;/select&gt;\r\n&lt;script&gt;\r\n&nbsp;var&nbsp;teacher_nationality&nbsp;=&nbsp;[];\r\n&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;.teacher_nationality&nbsp;option&#39;).each(function(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($(this).is(&#39;:selected&#39;)){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;teacher_nationality.push($(this).val());\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;});\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(teacher_nationality.length&nbsp;&lt;1&nbsp;){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert(&#39;国籍必填&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;teacher_nationality&nbsp;=&nbsp;teacher_nationality.join(&#39;,&#39;);\r\n&lt;/script&gt;</pre><p><br/></p>', 2, 0, 1543371814, NULL);
INSERT INTO `article` VALUES (24, 'msql 数据库每天自动备份', 'msql 数据库每天自动备份', '<p>mysql备份指令</p><p>mysqldump -uroot -proot -dataname &gt; backup_location&nbsp;&nbsp;</p><p>mysqldump -用户名 -密码 -数据库 &gt; 存储的位置</p><p><br/></p><p>编写shell脚本 backup_testdata.sh(保存未压缩和压缩两种)&nbsp;</p><p>#!/bin/bash</p><p>mysqldump -uroot -proot testdata &gt; /home/backup/bk_testdata_$(date %Y%m%d_%H%M$S).dump</p><p style=\"white-space: normal;\">#!/bin/bash</p><p style=\"white-space: normal;\">mysqldump -uroot -proot testdata | gzip &gt; /home/backup/bk_testdata_$(date %Y%m%d_%H%M$S).dump.gz</p><p style=\"white-space: normal;\"><br/></p><p>加入执行的权限&nbsp;</p><p>chmod 777 ./backup_testdata.sh</p><p><br/></p><p>测试执行</p><p>./backup_testdata.sh</p><p><br/></p><p>设置定时器(每天23:30 执行一次)</p><p>crontab - e</p><p>&nbsp;30 23 *&nbsp; *&nbsp; * /home/backup/backup_testdata.sh</p><p><br/></p><p>遇到问题</p><p>备份生成的文件没有内容？</p><p>原因： mysqldump 在crobtab 没有配置环境变量，局部指令招不到&nbsp;</p><p>解决方式：</p><p>使用绝对位置&nbsp;</p><p>whereis mysqldump&nbsp;</p><p>/usr/mysql/bin/mysqldump</p><p>将shell中 mysqldump 替换成&nbsp;/usr/mysql/bin/mysqldump</p><p><br/></p><p><br/></p><p><br/></p><p><br/></p>', 4, 0, 1544153542, 1544156144);
INSERT INTO `article` VALUES (25, 'curl 和file_get_content区别', 'curl 和file_get_content区别', '<p>两者均是通过url 获取返回会的数据。</p><p>但是curl允许的方案较多，如http,https ,ftp 等，且可，模拟cookie ,header参数等</p><p><br/></p><p>curl</p><p>•curl_close — 关闭 cURL 会话</p><p>•curl_copy_handle — 复制一个cURL句柄和它的所有选项</p><p>•curl_errno — 返回最后一次的错误代码</p><p>•curl_error — 返回当前会话最后一次错误的字符串</p><p>•curl_escape — 使用 URL 编码给定的字符串</p><p>•curl_exec — 执行 cURL 会话</p><p>•curl_file_create — 创建一个 CURLFile 对象</p><p>•curl_getinfo — 获取一个cURL连接资源句柄的信息</p><p>•curl_init — 初始化 cURL 会话</p><p>•curl_multi_add_handle — 向curl批处理会话中添加单独的curl句柄</p><p>•curl_multi_close — 关闭一组cURL句柄</p><p>•curl_multi_errno — 返回上一次 curl 批处理的错误码</p><p>•curl_multi_exec — 运行当前 cURL 句柄的子连接</p><p>•curl_multi_getcontent — 如果设置了CURLOPT_RETURNTRANSFER，则返回获取的输出的文本流</p><p>•curl_multi_info_read — 获取当前解析的cURL的相关传输信息</p><p>•curl_multi_init — 返回一个新cURL批处理句柄</p><p>•curl_multi_remove_handle — 移除cURL批处理句柄资源中的某个句柄资源</p><p>•curl_multi_select — 等待所有cURL批处理中的活动连接</p><p>•curl_multi_setopt — 为 cURL 并行处理设置一个选项</p><p>•curl_multi_strerror — 返回字符串描述的错误代码</p><p>•curl_pause — 暂停和取消暂停一个连接。</p><p>•curl_reset — 重置一个 libcurl 会话句柄的所有的选项</p><p>•curl_setopt_array — 为 cURL 传输会话批量设置选项</p><p>•curl_setopt — 设置 cURL 传输选项</p><p>•curl_share_close — 关闭 cURL 共享句柄</p><p>•curl_share_errno — 返回共享 curl 句柄的最后一次错误号</p><p>•curl_share_init — 初始化一个 cURL 共享句柄。</p><p>•curl_share_setopt — 为 cURL 共享句柄设置选项。</p><p>•curl_share_strerror — 返回错误号对应的错误消息</p><p>•curl_strerror — 返回错误代码的字符串描述</p><p>•curl_unescape — 解码给定的 URL 编码的字符串</p><p>•curl_version — 获取 cURL 版本信息</p><p><br/></p><p>curl_setopt()</p><p><br/></p><p>CURLOPT_AUTOREFERER TRUE 时将根据 Location: 重定向时，自动设置 header 中的Referer:信息。&nbsp; &nbsp;</p><p>CURLOPT_BINARYTRANSFER 设为 TRUE ，将在启用 CURLOPT_RETURNTRANSFER 时，返回原生的（Raw）输出。&nbsp; 从 PHP 5.1.3 开始，此选项不再有效果：使用 CURLOPT_RETURNTRANSFER 后总是会返回原生的（Raw）内容。&nbsp;&nbsp;</p><p>CURLOPT_COOKIESESSION 设为 TRUE 时将开启新的一次 cookie 会话。它将强制 libcurl 忽略之前会话时存的其他 cookie。 libcurl 在默认状况下无论是否为会话，都会储存、加载所有 cookie。会话 cookie 是指没有过期时间，只存活在会话之中。&nbsp; &nbsp;</p><p>CURLOPT_CERTINFO TRUE 将在安全传输时输出 SSL 证书信息到 STDERR。&nbsp; 在 cURL 7.19.1 中添加。 PHP 5.3.2 后有效。需要开启 CURLOPT_VERBOSE 才有效。&nbsp;&nbsp;</p><p>CURLOPT_CONNECT_ONLY TRUE 将让库执行所有需要的代理、验证、连接过程，但不传输数据。此选项用于 HTTP、SMTP 和 POP3。&nbsp; 在 7.15.2 中添加。 PHP 5.5.0 起有效。&nbsp;&nbsp;</p><p>CURLOPT_CRLF 启用时将Unix的换行符转换成回车换行符。&nbsp; &nbsp;</p><p>CURLOPT_DNS_USE_GLOBAL_CACHE TRUE 会启用一个全局的DNS缓存。此选项非线程安全的，默认已开启。&nbsp; &nbsp;</p><p>CURLOPT_FAILONERROR 当 HTTP 状态码大于等于 400，TRUE 将将显示错误详情。 默认情况下将返回页面，忽略 HTTP 代码。&nbsp; &nbsp;</p><p>CURLOPT_SSL_FALSESTART TRUE 开启 TLS False Start （一种 TLS 握手优化方式）&nbsp; cURL 7.42.0 中添加。自 PHP 7.0.7 起有效。&nbsp;&nbsp;</p><p>CURLOPT_FILETIME TRUE 时，会尝试获取远程文档中的修改时间信息。信息可通过curl_getinfo()函数的CURLINFO_FILETIME 选项获取。&nbsp; &nbsp;</p><p>CURLOPT_FOLLOWLOCATION TRUE 时将会根据服务器返回 HTTP 头中的 &quot;Location: &quot; 重定向。（注意：这是递归的，&quot;Location: &quot; 发送几次就重定向几次，除非设置了 CURLOPT_MAXREDIRS，限制最大重定向次数。）。&nbsp; &nbsp;</p><p>CURLOPT_FORBID_REUSE TRUE 在完成交互以后强制明确的断开连接，不能在连接池中重用。&nbsp; &nbsp;</p><p>CURLOPT_FRESH_CONNECT TRUE 强制获取一个新的连接，而不是缓存中的连接。&nbsp; &nbsp;</p><p>CURLOPT_FTP_USE_EPRT TRUE 时，当 FTP 下载时，使用 EPRT (和 LPRT)命令。 设置为 FALSE 时禁用 EPRT 和 LPRT，仅仅使用PORT 命令。&nbsp; &nbsp;</p><p>CURLOPT_FTP_USE_EPSV TRUE 时，在FTP传输过程中，回到 PASV 模式前，先尝试 EPSV 命令。设置为 FALSE 时禁用 EPSV。&nbsp; &nbsp;</p><p>CURLOPT_FTP_CREATE_MISSING_DIRS TRUE 时，当 ftp 操作不存在的目录时将创建它。&nbsp; &nbsp;</p><p>CURLOPT_FTPAPPEND TRUE 为追加写入文件，而不是覆盖。&nbsp; &nbsp;</p><p>CURLOPT_TCP_NODELAY TRUE 时禁用 TCP 的 Nagle 算法，就是减少网络上的小包数量。&nbsp; PHP 5.2.1 有效，编译时需要 libcurl 7.11.2 及以上。&nbsp;&nbsp;</p><p>CURLOPT_FTPASCII CURLOPT_TRANSFERTEXT 的别名。&nbsp; &nbsp;</p><p>CURLOPT_FTPLISTONLY TRUE 时只列出 FTP 目录的名字。&nbsp; &nbsp;</p><p>CURLOPT_HEADER 启用时会将头文件的信息作为数据流输出。&nbsp; &nbsp;</p><p>CURLINFO_HEADER_OUT TRUE 时追踪句柄的请求字符串。&nbsp; 从 PHP 5.1.3 开始可用。CURLINFO_ 的前缀是有意的(intentional)。&nbsp;&nbsp;</p><p>CURLOPT_HTTPGET TRUE 时会设置 HTTP 的 method 为 GET，由于默认是 GET，所以只有 method 被修改时才需要这个选项。&nbsp; &nbsp;</p><p>CURLOPT_HTTPPROXYTUNNEL TRUE 会通过指定的 HTTP 代理来传输。&nbsp; &nbsp;</p><p>CURLOPT_MUTE TRUE 时将完全静默，无论是何 cURL 函数。&nbsp; 在 cURL 7.15.5 中移出（可以使用 CURLOPT_RETURNTRANSFER 作为代替）&nbsp;&nbsp;</p><p>CURLOPT_NETRC TRUE 时，在连接建立时，访问~/.netrc文件获取用户名和密码来连接远程站点。&nbsp; &nbsp;</p><p>CURLOPT_NOBODY TRUE 时将不输出 BODY 部分。同时 Mehtod 变成了 HEAD。修改为 FALSE 时不会变成 GET。&nbsp; &nbsp;</p><p>CURLOPT_NOPROGRESS TRUE 时关闭 cURL 的传输进度。 Note: PHP 默认自动设置此选项为 TRUE，只有为了调试才需要改变设置。&nbsp;</p><p><br/></p><p>CURLOPT_NOSIGNAL TRUE 时忽略所有的 cURL 传递给 PHP 进行的信号。在 SAPI 多线程传输时此项被默认启用，所以超时选项仍能使用。&nbsp; cURL 7.10时被加入。&nbsp;&nbsp;</p><p>CURLOPT_PATH_AS_IS TRUE 不处理 dot dot sequences （即 ../ ）&nbsp; cURL 7.42.0 时被加入。 PHP 7.0.7 起有效。&nbsp;&nbsp;</p><p>CURLOPT_PIPEWAIT TRUE 则等待 pipelining/multiplexing。&nbsp; cURL 7.43.0 时被加入。 PHP 7.0.7 起有效。&nbsp;&nbsp;</p><p>CURLOPT_POST TRUE 时会发送 POST 请求，类型为：application/x-www-form-urlencoded，是 HTML 表单提交时最常见的一种。&nbsp; &nbsp;</p><p>CURLOPT_PUT TRUE 时允许 HTTP 发送文件。要被 PUT 的文件必须在 CURLOPT_INFILE和CURLOPT_INFILESIZE 中设置。&nbsp; &nbsp;</p><p>CURLOPT_RETURNTRANSFER TRUE 将curl_exec()获取的信息以字符串返回，而不是直接输出。&nbsp; &nbsp;</p><p>CURLOPT_SAFE_UPLOAD TRUE 禁用 @ 前缀在 CURLOPT_POSTFIELDS 中发送文件。意味着 @ 可以在字段中安全得使用了。可使用 CURLFile 作为上传的代替。&nbsp; PHP 5.5.0 中添加，默认值 FALSE。 PHP 5.6.0 改默认值为 TRUE。. PHP 7 删除了此选项， 必须使用 CURLFile interface 来上传文件。&nbsp;&nbsp;</p><p>CURLOPT_SASL_IR TRUE 开启，收到首包(first packet)后发送初始的响应(initial response)。&nbsp; cURL 7.31.10 中添加，自 PHP 7.0.7 起有效。&nbsp;&nbsp;</p><p>CURLOPT_SSL_ENABLE_ALPN FALSE 禁用 SSL 握手中的 ALPN (如果 SSL 后端的 libcurl 内建支持) 用于协商到 http2。&nbsp; cURL 7.36.0 中增加， PHP 7.0.7 起有效。&nbsp;&nbsp;</p><p>CURLOPT_SSL_ENABLE_NPN FALSE 禁用 SSL 握手中的 NPN(如果 SSL 后端的 libcurl 内建支持)，用于协商到 http2。&nbsp; cURL 7.36.0 中增加， PHP 7.0.7 起有效。&nbsp;&nbsp;</p><p>CURLOPT_SSL_VERIFYPEER FALSE 禁止 cURL 验证对等证书（peer&#39;scertificate）。要验证的交换证书可以在 CURLOPT_CAINFO 选项中设置，或在 CURLOPT_CAPATH中设置证书目录。&nbsp; 自cURL 7.10开始默认为 TRUE。从 cURL 7.10开始默认绑定安装。&nbsp;&nbsp;</p><p>CURLOPT_SSL_VERIFYSTATUS TRUE 验证证书状态。&nbsp; cURL 7.41.0 中添加， PHP 7.0.7 起有效。&nbsp;&nbsp;</p><p>CURLOPT_TCP_FASTOPEN TRUE 开启 TCP Fast Open。&nbsp; cURL 7.49.0 中添加， PHP 7.0.7 起有效。&nbsp;&nbsp;</p><p>CURLOPT_TFTP_NO_OPTIONS TRUE 不发送 TFTP 的 options 请求。&nbsp; 自 cURL 7.48.0 添加， PHP 7.0.7 起有效。&nbsp;&nbsp;</p><p>CURLOPT_TRANSFERTEXT TRUE 对 FTP 传输使用 ASCII 模式。对于LDAP，它检索纯文本信息而非 HTML。在 Windows 系统上，系统不会把 STDOUT 设置成二进制 模式。&nbsp; &nbsp;</p><p>CURLOPT_UNRESTRICTED_AUTH TRUE 在使用CURLOPT_FOLLOWLOCATION重定向 header 中的多个 location 时继续发送用户名和密码信息，哪怕主机名已改变。&nbsp; &nbsp;</p><p>CURLOPT_UPLOAD TRUE 准备上传。&nbsp; &nbsp;</p><p>CURLOPT_VERBOSE TRUE 会输出所有的信息，写入到STDERR，或在CURLOPT_STDERR中指定的文件。&nbsp;&nbsp;</p><p><br/></p><p><br/></p><p>thinkphp中的curl</p><p><br/></p><pre style=\"background-color: rgb(255, 255, 255); font-family: 宋体; font-size: 13.5pt;\" class=\"brush:php;toolbar:false;\"><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">&lt;?php<br/>class </span><span style=\"background-color:#f7faff;\">Curl {<br/></span><span style=\"background-color:#f7faff;\"><br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">/**<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp; * post和get请求模拟<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp; * </span><span style=\"color:#808080;background-color:#f7faff;font-weight:bold;font-style:italic;\">@param &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">$url &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;访问的URL<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp; * </span><span style=\"color:#808080;background-color:#f7faff;font-weight:bold;font-style:italic;\">@param </span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">string $post &nbsp; &nbsp; &nbsp; &nbsp; post数据(不填则为GET)<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp; * </span><span style=\"color:#808080;background-color:#f7faff;font-weight:bold;font-style:italic;\">@param </span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">string $cookie &nbsp; &nbsp; &nbsp; 提交的$cookies<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp; * </span><span style=\"color:#808080;background-color:#f7faff;font-weight:bold;font-style:italic;\">@param </span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">int &nbsp; &nbsp;$returnCookie 是否返回$cookies<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp; * </span><span style=\"color:#808080;background-color:#f7faff;font-weight:bold;font-style:italic;\">@return </span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">mixed|string<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp; */<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">public static function </span><span style=\"background-color:#f7faff;\">request(</span><span style=\"color:#660000;background-color:#f7faff;\">$url</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660000;background-color:#f7faff;\">$post </span><span style=\"background-color:#f7faff;\">= </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;&#39;</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660000;background-color:#f7faff;\">$cookie </span><span style=\"background-color:#f7faff;\">= </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;&#39;</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660000;background-color:#f7faff;\">$returnCookie </span><span style=\"background-color:#f7faff;\">= </span><span style=\"color:#0000ff;background-color:#f7faff;\">0</span><span style=\"background-color:#f7faff;\">) {<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#660000;background-color:#f7faff;\">$curl </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">curl_init</span><span style=\"background-color:#f7faff;\">();<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"background-color:#f7faff;font-style:italic;\">curl_setopt</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curl</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660e7a;background-color:#f7faff;font-weight:bold;font-style:italic;\">CURLOPT_URL</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660000;background-color:#f7faff;\">$url</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"background-color:#f7faff;font-style:italic;\">curl_setopt</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curl</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660e7a;background-color:#f7faff;font-weight:bold;font-style:italic;\">CURLOPT_USERAGENT</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/6.0)&#39;</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"background-color:#f7faff;font-style:italic;\">curl_setopt</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curl</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660e7a;background-color:#f7faff;font-weight:bold;font-style:italic;\">CURLOPT_FOLLOWLOCATION</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"background-color:#f7faff;font-style:italic;\">curl_setopt</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curl</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660e7a;background-color:#f7faff;font-weight:bold;font-style:italic;\">CURLOPT_AUTOREFERER</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"background-color:#f7faff;font-style:italic;\">curl_setopt</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curl</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660e7a;background-color:#f7faff;font-weight:bold;font-style:italic;\">CURLOPT_REFERER</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&quot;http://XXX&quot;</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">if </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$post</span><span style=\"background-color:#f7faff;\">) {<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"background-color:#f7faff;font-style:italic;\">curl_setopt</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curl</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660e7a;background-color:#f7faff;font-weight:bold;font-style:italic;\">CURLOPT_POST</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"background-color:#f7faff;font-style:italic;\">curl_setopt</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curl</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660e7a;background-color:#f7faff;font-weight:bold;font-style:italic;\">CURLOPT_POSTFIELDS</span><span style=\"background-color:#f7faff;\">, </span><span style=\"background-color:#f7faff;font-style:italic;\">http_build_query</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$post</span><span style=\"background-color:#f7faff;\">));<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;}<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">if </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$cookie</span><span style=\"background-color:#f7faff;\">) {<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"background-color:#f7faff;font-style:italic;\">curl_setopt</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curl</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660e7a;background-color:#f7faff;font-weight:bold;font-style:italic;\">CURLOPT_COOKIE</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660000;background-color:#f7faff;\">$cookie</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;}<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"background-color:#f7faff;font-style:italic;\">curl_setopt</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curl</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660e7a;background-color:#f7faff;font-weight:bold;font-style:italic;\">CURLOPT_HEADER</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660000;background-color:#f7faff;\">$returnCookie</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"background-color:#f7faff;font-style:italic;\">curl_setopt</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curl</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660e7a;background-color:#f7faff;font-weight:bold;font-style:italic;\">CURLOPT_TIMEOUT</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#0000ff;background-color:#f7faff;\">10</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"background-color:#f7faff;font-style:italic;\">curl_setopt</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curl</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660e7a;background-color:#f7faff;font-weight:bold;font-style:italic;\">CURLOPT_RETURNTRANSFER</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#660000;background-color:#f7faff;\">$data </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">curl_exec</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curl</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">if </span><span style=\"background-color:#f7faff;\">(</span><span style=\"background-color:#f7faff;font-style:italic;\">curl_errno</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curl</span><span style=\"background-color:#f7faff;\">)) {<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">return </span><span style=\"background-color:#f7faff;font-style:italic;\">curl_error</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curl</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;}<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"background-color:#f7faff;font-style:italic;\">curl_close</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curl</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">if </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$returnCookie</span><span style=\"background-color:#f7faff;\">) {<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">list</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$header</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660000;background-color:#f7faff;\">$body</span><span style=\"background-color:#f7faff;\">) = </span><span style=\"background-color:#f7faff;font-style:italic;\">explode</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&quot;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">\\r\\n\\r\\n</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&quot;</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660000;background-color:#f7faff;\">$data</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#0000ff;background-color:#f7faff;\">2</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"background-color:#f7faff;font-style:italic;\">preg_match_all</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&quot;/Set\\-Cookie:([^;]*);/&quot;</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660000;background-color:#f7faff;\">$header</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660000;background-color:#f7faff;\">$matches</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#660000;background-color:#f7faff;\">$info</span><span style=\"background-color:#f7faff;\">[</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;cookie&#39;</span><span style=\"background-color:#f7faff;\">] = </span><span style=\"background-color:#f7faff;font-style:italic;\">substr</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$matches</span><span style=\"background-color:#f7faff;\">[</span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">][</span><span style=\"color:#0000ff;background-color:#f7faff;\">0</span><span style=\"background-color:#f7faff;\">], </span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#660000;background-color:#f7faff;\">$info</span><span style=\"background-color:#f7faff;\">[</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;content&#39;</span><span style=\"background-color:#f7faff;\">] = </span><span style=\"color:#660000;background-color:#f7faff;\">$body</span><span style=\"background-color:#f7faff;\">;<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">return </span><span style=\"background-color:#f7faff;font-style:italic;\">json_decode</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$info</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">true</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;} </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">else </span><span style=\"background-color:#f7faff;\">{<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">return </span><span style=\"background-color:#f7faff;font-style:italic;\">json_decode</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$data</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">true</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;}<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;}<br/></span><span style=\"background-color:#f7faff;\">}</span></pre><p><br/></p><p><br/></p>', 1, 0, 1544427922, 1544430897);
INSERT INTO `article` VALUES (26, 'mysql find_in_set', ' find_in_set', '<p>对于多表关联，一对多情况，通常以外键关联，</p><p>但是对与更复杂的多对多，搜索查询，通常不便，因此会在一张表中，将关联表的id数组转换成字符串以逗号隔开。</p><p><br/></p><p>如 教育系统，</p><p>create table teacher(</p><p>&nbsp;&nbsp;&nbsp;&nbsp;id int not null auto_increment ,</p><p>&nbsp;&nbsp;&nbsp;&nbsp;teacher_online_offline varchar(60) ,</p><p>&nbsp;&nbsp;&nbsp;&nbsp;primary key(id)</p><p>)</p><p style=\"white-space: normal;\">create table on_off(</p><p style=\"white-space: normal;\">&nbsp;&nbsp;&nbsp;&nbsp;id int not null auto_increment ,</p><p style=\"white-space: normal;\">&nbsp;&nbsp;&nbsp;&nbsp;type tinyint not null&nbsp; comment &#39;1线上，2线下&#39; ,</p><p style=\"white-space: normal;\">&nbsp;&nbsp;&nbsp;&nbsp;primary key(id)</p><p style=\"white-space: normal;\">)</p><p style=\"white-space: normal;\">insert into on_off(id,type) values(1,&#39;线上&#39;);</p><p style=\"white-space: normal;\">insert into on_off(id,type) values(2,&#39;线下&#39;);</p><p>一个老师可以是在线教育（id=1），也可以线下教学(id=2),</p><p>因此如果这个老师既可以线上，也可以线下，那么在teacher表中teacher_online_offline 字段 ，应为 &quot;1,2&quot;</p><p>此时查询 是&nbsp;</p><p>find_in_set</p><p>查询线上的外教</p><p>select * from teacher where find_in_set(1,teacher_online_offline&nbsp;)</p><p>针对 不同于 like 模糊查询</p><p>如果on_off中有十几个列 ，</p><p>那么查询id是4，like会将4，14，均返回。</p><p><br/></p><p>在thinkphp3.2使用。</p><p>&nbsp;$where[] = &#39;FIND_IN_SET(&#39;.&quot;&#39;$flower_use_get&#39;&quot;.&#39;,flower_use)&#39;;</p><p>thinkphp5.1</p><p>$where[] =&nbsp; [&#39;&#39;,&#39;EXP&#39;,Db::raw(&quot;FIND_IN_SET($flower_use_get,flower_use)&quot;)];</p>', 5, 0, 1544510573, 1547347395);
INSERT INTO `article` VALUES (27, '字符串截取', '字符串截取', '<p>字符串截取有substr 和mb_str&nbsp;</p><p>mbstr() 可以根据字符集编码进行截取。</p><p>针对富文本户企业的数据 可以先进行转义 或者 标签替换 ，否则标签会占字节</p><p>$record_information =&nbsp; str_replace(&#39;&lt;/p&gt;&#39;,&#39;&#39;, $record_information);</p><p>$record_information =&nbsp; str_replace(&#39;&lt;p&gt;&#39;,&#39;&#39;, $record_information);</p><p>$record_information =&nbsp; mb_substr($record_information,0,8, &#39;utf-8&#39;);</p><p><br/></p>', 1, 0, 1544522366, 1544522960);
INSERT INTO `article` VALUES (28, '网站加入收藏', '网站加入收藏', '<p>收藏网站</p><p><br/></p><p>&nbsp;&nbsp;&nbsp; function addFavorite(){<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var ctrl = (navigator.userAgent.toLowerCase()).indexOf(&#39;mac&#39;) != -1 ? &#39;Command/Cmd&#39;: &#39;CTRL&#39;;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (document.all) { //IE类浏览器<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; window.external.toString(); //360浏览器不支持window.external，无法收藏<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; window.alert(&quot;国内开发的360浏览器等不支持主动加入收藏。\\n您可以尝试通过浏览器菜单栏 或快捷键 ctrl+D 试试。&quot;);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (e){<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; window.external.addFavorite(window.location, document.title);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (e){<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; window.external.addToFavoritesBar(window.location, document.title);&nbsp; //IE8<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if (window.sidebar) { //firfox等浏览器<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; window.sidebar.addPanel(document.title, window.location, &quot;&quot;);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else {<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(&#39;您可以尝试通过快捷键&#39; + ctrl + &#39; + D 加入到收藏夹~&#39;);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (e){<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; window.alert(&quot;因为IE浏览器存在bug，添加收藏失败！\\n解决办法：在注册表中查找\\n HKEY_CLASSES_ROOT\\\\TypeLib\\\\{EAB22AC0-30C1-11CF-A7EB-0000C05BAE0B}\\\\1.1\\\\0\\\\win32 \\n将 C:\\\\WINDOWS\\\\system32\\\\shdocvw.dll 改为 C:\\\\WINDOWS\\\\system32\\\\ieframe.dll &quot;);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br/>&nbsp;&nbsp;&nbsp; }</p><br/>', 2, 0, 1544585912, NULL);
INSERT INTO `article` VALUES (29, 'php判断是http或https', 'php判断是http或https', '<p><br/></p><pre class=\"brush:php;toolbar:false;\">&lt;?php\r\n&nbsp;&nbsp;&nbsp;&nbsp;//0.\r\n&nbsp;&nbsp;&nbsp;&nbsp;$http&nbsp;=&nbsp;false&nbsp;!==&nbsp;is_https()&nbsp;?&nbsp;&#39;https://&#39;&nbsp;:&nbsp;&#39;http://&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;is_https()&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!empty($_SERVER[&#39;HTTPS&#39;])&nbsp;&amp;&amp;&nbsp;strtolower($_SERVER[&#39;HTTPS&#39;])&nbsp;!==&nbsp;&#39;off&#39;)&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;(isset($_SERVER[&#39;HTTP_X_FORWARDED_PROTO&#39;])&nbsp;&amp;&amp;&nbsp;$_SERVER[&#39;HTTP_X_FORWARDED_PROTO&#39;]===&#39;https&#39;){&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;(!empty($_SERVER[&#39;HTTP_FRONT_END_HTTPS&#39;])&nbsp;&amp;&amp;&nbsp;strtolower($_SERVER[&#39;HTTP_FRONT_END_HTTPS&#39;])!==&#39;off&#39;){&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;//1.根据url方案\r\n&nbsp;&nbsp;&nbsp;&nbsp;$http&nbsp;=&nbsp;FALSE&nbsp;===&nbsp;stristr($_SERVER[&#39;REQUEST_SCHEME&#39;],&#39;https&#39;)&nbsp;?&nbsp;&#39;https&#39;:&nbsp;&#39;https&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;\r\n?&gt;</pre><p><br/></p><br/>', 1, 0, 1545104325, NULL);
INSERT INTO `article` VALUES (30, 'ajax传from表单', 'ajax传from表单', '<pre class=\"brush:js;toolbar:false\">&lt;script&gt;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;//1.将序列化表单和其他参数合并\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;#formSubmit&#39;).submit(function()&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//表单序列化数据\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;form_param&nbsp;=&nbsp;$(&#39;#formSubmit&#39;).serialize();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//其他参数。通过jquery.param()&nbsp;转换成url参数\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;other_param&nbsp;=&nbsp;$.param({id:3,new_id:4});&nbsp;//\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//合并参数\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;combine_param&nbsp;&nbsp;=&nbsp;&nbsp;other_param+&#39;&amp;&#39;+form_param;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.ajax({\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;&#39;post&#39;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url:&nbsp;&nbsp;url,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataType:&nbsp;&#39;json&#39;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:&nbsp;combine_param,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;success:&nbsp;function(ret){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(ret);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;//2.将其他参数，生成表单的隐藏域，只需传递序列化的表单&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&lt;/script&gt;</pre><p><br/></p>', 2, 0, 1545485494, 1545485647);
INSERT INTO `article` VALUES (31, 'bootstrap-fileinput 文件上传', 'bootstrap-fileinput 文件上传', '<p>css</p><pre style=\"background-color: rgb(255, 255, 255); font-family: 宋体; font-size: 13.5pt;\">&lt;input&nbsp;id=&quot;logo&quot;&nbsp;name=&quot;logo&quot;&nbsp;&nbsp;type=&quot;file&quot;&nbsp;&gt;</pre><p>js</p><pre class=\"brush:js;toolbar:false\">&lt;script&gt;\r\n$(&quot;#logo&quot;).fileinput({\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;language:&nbsp;&#39;zh&#39;,&nbsp;//设置语言\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uploadUrl:&nbsp;&quot;{:url(&#39;Carousel/upload&#39;,&#39;&#39;,false)}&quot;,&nbsp;//上传的地址\r\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allowedFileExtensions:&nbsp;[&#39;jpg&#39;,&nbsp;&#39;gif&#39;,&nbsp;&#39;png&#39;],//接收的文件后缀\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//uploadExtraData:{&quot;id&quot;:&nbsp;1,&nbsp;&quot;fileName&quot;:&#39;123.mp3&#39;},\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uploadAsync:&nbsp;true,&nbsp;//默认异步上传\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showUpload:&nbsp;false,&nbsp;//是否显示上传按钮\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showRemove&nbsp;:&nbsp;false,&nbsp;//显示移除按钮\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showPreview&nbsp;:&nbsp;true,&nbsp;//是否显示预览\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showCaption:&nbsp;false,//是否显示标题\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;browseClass:&nbsp;&quot;btn&nbsp;btn-primary&quot;,&nbsp;//按钮样式\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dropZoneEnabled:&nbsp;false,//是否显示拖拽区域\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/!*minImageWidth:&nbsp;50,&nbsp;//图片的最小宽度\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minImageHeight:&nbsp;50,//图片的最小高度\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxImageWidth:&nbsp;1000,//图片的最大宽度\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxImageHeight:&nbsp;1000,//图片的最大高度*!/\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//maxFileSize:&nbsp;0,//单位为kb，如果为0表示不限制文件大小\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//minFileCount:&nbsp;0,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxFileCount:&nbsp;1,&nbsp;//表示允许同时上传的最大文件个数\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enctype:&nbsp;&#39;multipart/form-data&#39;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;validateInitialCount:true,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;browseOnZoneClick:&nbsp;false\r\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;previewFileIcon:&nbsp;&quot;&lt;i&nbsp;class=&#39;glyphicon&nbsp;glyphicon-king&#39;&gt;&lt;/i&gt;&quot;,\r\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msgFilesTooMany:&nbsp;&quot;选择上传的文件数量({n})&nbsp;超过允许的最大数值{m}！\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}).on(&quot;filebatchselected&quot;,&nbsp;function(event,&nbsp;files)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(this).fileinput(&quot;upload&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}).on(&quot;fileuploaded&quot;,&nbsp;function(event,&nbsp;data,id,index)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(event);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(data);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(id);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(index);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(data.response.code&nbsp;==&nbsp;0)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logo_path&nbsp;=&nbsp;data.response.logo_file_path;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logo_path&nbsp;=&nbsp;data.response.logo_file_path_thumb;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//$(&quot;#file_my_1&quot;).attr(&quot;value&quot;,data.response.fileUrl);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}).on(&#39;filesuccessremove&#39;,&nbsp;function(event,&nbsp;id)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(&#39;--delete--&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(event);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(id);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;script&gt;</pre><p><span style=\"color:#808080;font-style:italic;\"></span><br/></p><p>php</p><pre class=\"brush:php;toolbar:false\">&lt;?php\r\n&nbsp;&nbsp;&nbsp;&nbsp;//上传图片\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;upload(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;获取表单上传文件&nbsp;例如上传了001.jpg\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$file&nbsp;=&nbsp;request()-&gt;file(&#39;logo&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;移动到框架应用根目录/uploads/&nbsp;目录下\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$info&nbsp;=&nbsp;$file-&gt;validate([&#39;size&#39;=&gt;10000000])-&gt;move(&nbsp;&#39;./uploads/Carousel/&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($info){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//生成的文件路径\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$old_big_img&nbsp;=&nbsp;$big_file_dir&nbsp;=&nbsp;str_replace(&#39;\\\\&#39;,&#39;/&#39;,$info-&gt;getSaveName());\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$thumb_img&nbsp;=&nbsp;str_replace($info-&gt;getFilename(),&#39;thumb_&#39;.$info-&gt;getFilename(),$old_big_img);\r\n\r\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$big_file_path&nbsp;=&nbsp;&#39;./uploads/Carousel/&#39;.$info-&gt;getSaveName();\r\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$big_file_dir_name&nbsp;=&nbsp;dirname($big_file_path);\r\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list($big_file_name,$ext)&nbsp;=&nbsp;explode(&#39;.&#39;,$info-&gt;getSaveName());\r\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$thumb_img&nbsp;=&nbsp;$big_file_dir_name&nbsp;.&#39;/&#39;&nbsp;.$big_file_name&nbsp;.&#39;_thumb&#39;.$ext;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$thumb_img_path&nbsp;=&nbsp;&#39;./uploads/Carousel/&#39;.$thumb_img;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$image&nbsp;=&nbsp;\\think\\Image::open(&#39;./uploads/Carousel/&#39;.$big_file_dir);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$image-&gt;thumb(200,&nbsp;200)-&gt;save($thumb_img_path);\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;成功上传后&nbsp;获取上传信息\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;输出&nbsp;jpg\r\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;$info-&gt;getExtension();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;输出&nbsp;20160820/42a79759f284b767dfcb2a0197904287.jpg\r\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;$info-&gt;getSaveName();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;输出&nbsp;42a79759f284b767dfcb2a0197904287.jpg\r\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;$info-&gt;getFilename();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&nbsp;json([\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;code&#39;=&gt;0,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;logo_file_path&#39;=&gt;&nbsp;&#39;Carousel/&#39;.$big_file_dir,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;logo_file_path_thumb&#39;=&gt;&nbsp;&#39;Carousel/&#39;.$thumb_img\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;上传失败获取错误信息\r\n//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;$file-&gt;getError();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&nbsp;json([\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;code&#39;=&gt;1,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;msg&#39;=&gt;&nbsp;$file-&gt;getError()\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n?&gt;</pre><p><br/></p>', 1, 0, 1545789576, NULL);
INSERT INTO `article` VALUES (32, 'php在Linux 升级版本', 'php在Linux 升级版本', '<p>本站使用的是 WordPress 搭建，刚开始搭建的时候吧，没啥经验，网上搜一搜，就用了 PHP 5.6 版本，然后网站速度这个慢啊，虽然用了各种方法已经很快了，但是当时搜出来的使用 PHP 7 这个方法一直没试，心里痒，这回终于升级了一下。<br/>1. 检查当前安装的 PHP<br/><br/>查看当前 PHP 版本<br/><br/>php -v<br/><br/>查看当前 PHP 相关的安装包<br/><br/>yum list installed | grep php<br/><br/>2. 更换 RPM 源<br/><br/>#Centos 5.X：<br/>rpm -Uvh http://mirror.webtatic.com/yum/el5/latest.rpm<br/><br/>#CentOs 6.x：<br/>rpm -Uvh http://mirror.webtatic.com/yum/el6/latest.rpm<br/><br/>#CentOs 7.X：<br/>rpm -Uvh https://mirror.webtatic.com/yum/el7/epel-release.rpm<br/>rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm<br/><br/>3. 停止相关服务<br/><br/>关闭 php-fpm 和 nginx 服务<br/><br/>service php-fpm stop<br/>/usr/local/nginx/sbin/nginx -s stop<br/><br/>4. 删除已经安装的 PHP 相关包<br/><br/>yum remove php*<br/><br/>5. 安装新版本 PHP<br/><br/>php 7.0/7.1/7.2 分别表示为 70w/71w/72w<br/><br/>目前（2018-5-4）<br/><br/>CentOs 6.x 的 RPM 源中最高只有 7.1<br/><br/>CentOs 7.x 的 RPM 源中有 7.2<br/><br/>yum install php71w php71w-cli php71w-common php71w-devel php71w-embedded php71w-fpm php71w-gd php71w-mbstring php71w-mysqlnd php71w-opcache php71w-pdo php71w-xml php71w-ldap php71w-mcrypt<br/><br/>6. 重新启动相关服务<br/><br/>service php-fpm start<br/>/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf<br/><br/>7. 再次检查版本<br/><br/>php -v</p><p><br/></p><p>转载至&nbsp;&nbsp; https://www.centos.bz/2018/05/centos-6-7-%E5%8D%87%E7%BA%A7-php-5-6-%E5%88%B0-7-1-7-2/</p>', 1, 0, 1546490793, 1546490837);
INSERT INTO `article` VALUES (33, 'linux mysql 重置初始密码 并允许外网访问', 'linux mysql 重置初始密码 并允许外网访问', '<p>Linux 修改mysql密码<br/><br/>. 修改MySQL的登录设置<br/>mysql 配置文件位置<br/>&nbsp;find / -name my.cnf<br/>&nbsp; 修改配置文件，设置无密码登陆<br/>&nbsp; vim /etc/my.cnf<br/>在[mysqld]段中加上一句：skip-grant-tables<br/><br/>&nbsp;重启服务<br/>&nbsp;service mysqld restart<br/><br/>登录Mysql，修改密码信息<br/>&nbsp;mysql<br/>mysql&gt; USE mysql;<br/>mysql&gt; UPDATE user SET Password=password (&#39;new-password&#39;) WHERE User=&#39;root&#39;;<br/><br/>//MySQL5.7 以上没有Password 字段 变成 authentication_string<br/>update user set authentication_string=password(&#39;new-password&#39;) where user=&#39;root&#39;; &nbsp;<br/><br/>mysql&gt; flush privileges;<br/>mysql&gt; quit;<br/><br/>将mysql配置文件my.cnf 还原置 密码登陆<br/>&nbsp; vim /etc/my.cnf<br/>#skip-grant-tables<br/><br/>Linux MySQL 允许外网访问<br/>&nbsp;find / -name my.cnf<br/>&nbsp; vim /etc/my.cnf<br/>注释绑定地址<br/>&nbsp; #bind-address&nbsp; =127.0.0.1<br/>/etc/init.d/mysql restart;<br/><br/>mysql -uroot -ppassword<br/>将访问主机 全部开放 ，% 代表所有，也可以设置成专有IP 如 127.0.0.1<br/>update user set host=&#39;%&#39; where user=&#39;root&#39;; <br/>flush privileges ;<br/>quit;<br/>/etc/init.d/mysql restart;<br/><br/></p>', 4, 0, 1547024026, 1547031398);
INSERT INTO `article` VALUES (34, 'lamp 安装', 'lamp 安装', '<p>查看系统有没有gcc库 zilb 等<br/></p><p>针对 https <br/>1.Linux系统编译Openssl步骤<br/>下载源码 https://www.openssl.org<br/><br/>tar -xzf openssl-1.1.1a.tar.gz <br/>cd -xzf openssl-1.1.1a <br/>./config --prefix=/usr/local/openssl<br/>./config -t<br/>make &amp;&amp; make install</p><p><br/></p><p>安装apache依赖包<br/>wget http://jaist.dl.sourceforge.net/project/pcre/pcre/8.42/pcre-8.42.tar.gz<br/>tar -zxvf pcre-8.42.tar.gz<br/>cd pcre-8.42 <br/>./configure --prefix=/usr/local/pcre &nbsp;<br/>make &amp;&amp; make install<br/><br/>wget http://archive.apache.org/dist/apr/apr-1.6.5.tar.gz <br/>tar -zxvf apr-1.6.5.tar.gz <br/>cd apr-1.6.5<br/>./configure --prefix=/usr/local/apr <br/>make &amp;&amp; make install<br/><br/>wget http://archive.apache.org/dist/apr/apr-util-1.6.1.tar.gz <br/>tar -zxvf apr-util-1.6.1.tar.gz<br/>cd apr-util-1.6.1<br/>&nbsp;./configure --prefix=/usr/local/apr-util --with-apr=/usr/local/apr/bin/apr-1-config &nbsp;<br/>make &amp;&amp; make install<br/><br/>若仍报错 yum install expat-devel<br/>报错提示 fatal error: expat.h: No such file or directory</p><p><br/></p><p>安装apache<br/>wget http://www.apache.org/dist/httpd/httpd-2.4.37.tar.gz<br/>cd httpd-2.4.37<br/>./configure --prefix=/usr/local/httpd&nbsp; \\<br/>--enable-modules=all \\<br/>--enable-mods-shared=all \\<br/>--enable-so \\<br/>--enable-ssl \\<br/>--with-ssl=/usr/local/openssl \\<br/>--with-apr=/usr/local/apr \\<br/>--with-apr-util=/usr/local/apr-util \\<br/>--with-pcre=/usr/local/pcre<br/><br/></p><p>make &amp;&amp; make install<br/></p>', 4, 0, 1547034817, NULL);
INSERT INTO `article` VALUES (35, '日期上周一周日等时间', '', '<pre style=\"background-color:#ffffff;color:#000000;font-family:&#39;宋体&#39;;font-size:13.5pt;\" class=\"brush:php;toolbar:false;\"><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"><br/></span></pre><p>周</p><p><br/></p><pre style=\"background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;; font-size: 12pt;\"><span style=\"color:#660000;background-color:#f7faff;\">$cur_y_m_d </span><span style=\"background-color:#f7faff;\">= date(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y-m-d&#39;</span><span style=\"background-color:#f7faff;\">,time());<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$first</span><span style=\"background-color:#f7faff;\">=</span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">; </span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//每周星期一为开始日期 0表示每周日为开始日期<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$cur_w</span><span style=\"background-color:#f7faff;\">=date(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;w&#39;</span><span style=\"background-color:#f7faff;\">,strtotime(</span><span style=\"color:#660000;background-color:#f7faff;\">$cur_y_m_d</span><span style=\"background-color:#f7faff;\">));<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$cur_y_m_d_1 </span><span style=\"background-color:#f7faff;\">= date(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y-m-d&#39;</span><span style=\"background-color:#f7faff;\">,strtotime(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&quot;</span><span style=\"color:#660000;background-color:#f7faff;\">$cur_y_m_d</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\"> -&quot;</span><span style=\"background-color:#f7faff;\">.(</span><span style=\"color:#660000;background-color:#f7faff;\">$cur_w </span><span style=\"background-color:#f7faff;\">? </span><span style=\"color:#660000;background-color:#f7faff;\">$cur_w </span><span style=\"background-color:#f7faff;\">- </span><span style=\"color:#660000;background-color:#f7faff;\">$first </span><span style=\"background-color:#f7faff;\">: </span><span style=\"color:#0000ff;background-color:#f7faff;\">6</span><span style=\"background-color:#f7faff;\">).</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39; days&#39;</span><span style=\"background-color:#f7faff;\">));</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//获取本周开始日期<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$cur_y_m_d_7</span><span style=\"background-color:#f7faff;\">=date(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y-m-d&#39;</span><span style=\"background-color:#f7faff;\">,strtotime(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&quot;</span><span style=\"color:#660000;background-color:#f7faff;\">$cur_y_m_d_1</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\"> +6 days&quot;</span><span style=\"background-color:#f7faff;\">)); &nbsp;</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//本周结束日期<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"><br/></span><span style=\"color:#660000;background-color:#f7faff;\">$last_y_m_d_1 </span><span style=\"background-color:#f7faff;\">= date(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y-m-d&#39;</span><span style=\"background-color:#f7faff;\">,strtotime(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&quot;</span><span style=\"color:#660000;background-color:#f7faff;\">$cur_y_m_d_1</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\"> - 7 days&quot;</span><span style=\"background-color:#f7faff;\">)); &nbsp;</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//上周开始日期<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$last_y_m_d_1 </span><span style=\"background-color:#f7faff;\">= date(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y-m-d&#39;</span><span style=\"background-color:#f7faff;\">,strtotime(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&quot;</span><span style=\"color:#660000;background-color:#f7faff;\">$cur_y_m_d_1</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\"> - 1 days&quot;</span><span style=\"background-color:#f7faff;\">)); &nbsp;</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//上周结束日期</span></pre><p><br/></p><p><br/></p><p>月</p><pre style=\"background-color:#ffffff;color:#000000;font-family:&#39;宋体&#39;;font-size:13.5pt;\"><span style=\"color:#660000;background-color:#f7faff;\">$lastMonth </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">date</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y-m&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"background-color:#f7faff;font-style:italic;\">mktime</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#0000ff;background-color:#f7faff;\">0</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#0000ff;background-color:#f7faff;\">0</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#0000ff;background-color:#f7faff;\">0</span><span style=\"background-color:#f7faff;\">, </span><span style=\"background-color:#f7faff;font-style:italic;\">date</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&quot;m&quot;</span><span style=\"background-color:#f7faff;\">)-</span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">, </span><span style=\"background-color:#f7faff;font-style:italic;\">date</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&quot;d&quot;</span><span style=\"background-color:#f7faff;\">), &nbsp; </span><span style=\"background-color:#f7faff;font-style:italic;\">date</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&quot;Y&quot;</span><span style=\"background-color:#f7faff;\">)));<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$curMonth </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">date</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y-m&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"background-color:#f7faff;font-style:italic;\">time</span><span style=\"background-color:#f7faff;\">());<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$lastMonthBegin </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">date</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y-m-d&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"background-color:#f7faff;font-style:italic;\">strtotime</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$lastMonth</span><span style=\"background-color:#f7faff;\">));<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$lastMonthEndDay </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">date</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y-m-d&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"background-color:#f7faff;font-style:italic;\">strtotime</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curMonth</span><span style=\"background-color:#f7faff;\">)-</span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$lastMonthDayCount </span><span style=\"background-color:#f7faff;\">= &nbsp;(</span><span style=\"background-color:#f7faff;font-style:italic;\">strtotime</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$lastMonthEndDay</span><span style=\"background-color:#f7faff;\">) - </span><span style=\"background-color:#f7faff;font-style:italic;\">strtotime</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$lastMonthBegin</span><span style=\"background-color:#f7faff;\">))/(</span><span style=\"color:#0000ff;background-color:#f7faff;\">24</span><span style=\"background-color:#f7faff;\">*</span><span style=\"color:#0000ff;background-color:#f7faff;\">3600</span><span style=\"background-color:#f7faff;\">) + </span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">;<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//上月1—30 新客户数量<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$last_week_new_cus_num_arr </span><span style=\"background-color:#f7faff;\">= [];<br/></span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">for</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$i</span><span style=\"background-color:#f7faff;\">=</span><span style=\"color:#0000ff;background-color:#f7faff;\">0 </span><span style=\"background-color:#f7faff;\">;</span><span style=\"color:#660000;background-color:#f7faff;\">$i </span><span style=\"background-color:#f7faff;\">&lt; </span><span style=\"color:#660000;background-color:#f7faff;\">$lastMonthDayCount</span><span style=\"background-color:#f7faff;\">; </span><span style=\"color:#660000;background-color:#f7faff;\">$i</span><span style=\"background-color:#f7faff;\">++) {<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;</span><span style=\"color:#660000;background-color:#f7faff;\">$part_cur_y_m_d </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">date</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y-m-d&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"background-color:#f7faff;font-style:italic;\">strtotime</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$lastMonthBegin </span><span style=\"background-color:#f7faff;\">)+</span><span style=\"color:#660000;background-color:#f7faff;\">$i </span><span style=\"background-color:#f7faff;\">* </span><span style=\"color:#0000ff;background-color:#f7faff;\">24</span><span style=\"background-color:#f7faff;\">*</span><span style=\"color:#0000ff;background-color:#f7faff;\">3600</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; </span><span style=\"background-color:#f7faff;\"><br/></span><span style=\"background-color:#f7faff;\">}<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//本月1-今天 新客户数量<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$cur_week_new_cus_num_arr </span><span style=\"background-color:#f7faff;\">= [];<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$curMonthDayCount </span><span style=\"background-color:#f7faff;\">= (</span><span style=\"background-color:#f7faff;font-style:italic;\">strtotime</span><span style=\"background-color:#f7faff;\">(</span><span style=\"background-color:#f7faff;font-style:italic;\">date</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y-m-d&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"background-color:#f7faff;font-style:italic;\">time</span><span style=\"background-color:#f7faff;\">())) - </span><span style=\"background-color:#f7faff;font-style:italic;\">strtotime</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curMonth</span><span style=\"background-color:#f7faff;\">))/(</span><span style=\"color:#0000ff;background-color:#f7faff;\">24</span><span style=\"background-color:#f7faff;\">*</span><span style=\"color:#0000ff;background-color:#f7faff;\">3600</span><span style=\"background-color:#f7faff;\">)+</span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">;<br/></span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">for</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$i</span><span style=\"background-color:#f7faff;\">=</span><span style=\"color:#0000ff;background-color:#f7faff;\">0 </span><span style=\"background-color:#f7faff;\">;</span><span style=\"color:#660000;background-color:#f7faff;\">$i </span><span style=\"background-color:#f7faff;\">&lt; </span><span style=\"color:#660000;background-color:#f7faff;\">$curMonthDayCount</span><span style=\"background-color:#f7faff;\">; </span><span style=\"color:#660000;background-color:#f7faff;\">$i</span><span style=\"background-color:#f7faff;\">++) {<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;</span><span style=\"color:#660000;background-color:#f7faff;\">$part_cur_y_m_d </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">date</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y-m-d&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"background-color:#f7faff;font-style:italic;\">strtotime</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$curMonth</span><span style=\"background-color:#f7faff;\">) + </span><span style=\"color:#660000;background-color:#f7faff;\">$i </span><span style=\"background-color:#f7faff;\">* </span><span style=\"color:#0000ff;background-color:#f7faff;\">24</span><span style=\"background-color:#f7faff;\">*</span><span style=\"color:#0000ff;background-color:#f7faff;\">3600</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;</span><span style=\"background-color:#f7faff;\"><br/></span><span style=\"background-color:#f7faff;\">}</span></pre><p>年</p><pre style=\"background-color:#ffffff;color:#000000;font-family:&#39;宋体&#39;;font-size:13.5pt;\" class=\"brush:php;toolbar:false;\"><span style=\"color:#660000;background-color:#f7faff;\">$cur_y </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">date</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"background-color:#f7faff;font-style:italic;\">time</span><span style=\"background-color:#f7faff;\">());<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$last_y </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">date</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"background-color:#f7faff;font-style:italic;\">strtotime</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$cur_y</span><span style=\"background-color:#f7faff;\">)-</span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//去年<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">for </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$i</span><span style=\"background-color:#f7faff;\">=</span><span style=\"color:#0000ff;background-color:#f7faff;\">0</span><span style=\"background-color:#f7faff;\">;</span><span style=\"color:#660000;background-color:#f7faff;\">$i</span><span style=\"background-color:#f7faff;\">&lt;</span><span style=\"color:#0000ff;background-color:#f7faff;\">12</span><span style=\"background-color:#f7faff;\">;</span><span style=\"color:#660000;background-color:#f7faff;\">$i</span><span style=\"background-color:#f7faff;\">++) {<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">echo </span><span style=\"background-color:#f7faff;font-style:italic;\">date</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y-m-d&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"background-color:#f7faff;font-style:italic;\">strtotime</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$last_y</span><span style=\"background-color:#f7faff;\">.</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;-&#39;</span><span style=\"background-color:#f7faff;\">.(</span><span style=\"color:#660000;background-color:#f7faff;\">$i</span><span style=\"background-color:#f7faff;\">+</span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">))) .</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;&lt;br&gt;&#39;</span><span style=\"background-color:#f7faff;\">;<br/></span><span style=\"background-color:#f7faff;\"> }<br/></span><span style=\"background-color:#f7faff;\"> </span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//今年<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> </span><span style=\"color:#660000;background-color:#f7faff;\">$year_count </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">date</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;m&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"background-color:#f7faff;font-style:italic;\">time</span><span style=\"background-color:#f7faff;\">());<br/></span><span style=\"background-color:#f7faff;\"> </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">for </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$i</span><span style=\"background-color:#f7faff;\">=</span><span style=\"color:#0000ff;background-color:#f7faff;\">0</span><span style=\"background-color:#f7faff;\">;</span><span style=\"color:#660000;background-color:#f7faff;\">$i</span><span style=\"background-color:#f7faff;\">&lt;</span><span style=\"color:#660000;background-color:#f7faff;\">$year_count</span><span style=\"background-color:#f7faff;\">;</span><span style=\"color:#660000;background-color:#f7faff;\">$i</span><span style=\"background-color:#f7faff;\">++) {<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">echo </span><span style=\"background-color:#f7faff;font-style:italic;\">date</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;Y-m-d&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"background-color:#f7faff;font-style:italic;\">strtotime</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$last_y</span><span style=\"background-color:#f7faff;\">.</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;-&#39;</span><span style=\"background-color:#f7faff;\">.(</span><span style=\"color:#660000;background-color:#f7faff;\">$i</span><span style=\"background-color:#f7faff;\">+</span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">))) .</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;&lt;br&gt;&#39;</span><span style=\"background-color:#f7faff;\">;<br/></span><span style=\"background-color:#f7faff;\"> }<br/> <br/> <br/><br/><br/></span></pre><p><br/></p><p><br/></p><p>计算两个日期相隔多少天</p><pre class=\"brush:php;toolbar:false\">function&nbsp;gapDays($beginDate,$endDate){\r\n&nbsp;&nbsp;&nbsp;&nbsp;$begin&nbsp;=&nbsp;Date(&#39;Y-m-d&#39;,strtotime($beginDate));\r\n&nbsp;&nbsp;&nbsp;&nbsp;$begin_day&nbsp;=&nbsp;new&nbsp;\\DateTime($begin);;\r\n&nbsp;&nbsp;&nbsp;&nbsp;$end&nbsp;=&nbsp;Date(&#39;Y-m-d&#39;,strtotime($endDate));\r\n&nbsp;&nbsp;&nbsp;&nbsp;$end_day&nbsp;=&nbsp;new&nbsp;\\DateTime($end);\r\n&nbsp;&nbsp;&nbsp;&nbsp;$diff&nbsp;=&nbsp;$begin_day-&gt;diff($end_day);\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$diff-&gt;days;\r\n&nbsp;&nbsp;&nbsp;&nbsp;\r\n}</pre><p><br/></p><p><br/></p><pre class=\"brush:html;toolbar:false;\" style=\"background-color: rgb(255, 255, 255); font-family: 宋体; font-size: 13.5pt;\"><br/></pre><p><br/></p>', 1, 0, 1547620659, 1557989510);
INSERT INTO `article` VALUES (36, 'group_concat', '', '<p>&nbsp;一、concat()函数<br/><br/>1、功能：将多个字符串连接成一个字符串。<br/><br/>2、语法：concat(name, age,...)<br/><br/>&nbsp; 返回结果为连接参数产生的字符串，如果有任何一个参数为null，则返回值为null。<br/>&nbsp; 如 name = lcl ,age = null ,返回 null<br/>&nbsp; name = lcl ,age = 18&nbsp; 返回 lcl 18<br/><br/>3.加入分隔符<br/>&nbsp; 01.自己拼接，<br/>&nbsp; &nbsp;&nbsp; &nbsp;如：cancat(name ,&#39;,&#39;,age)<br/>&nbsp; 02.使用concat_ws() 函数 concat with separator<br/>&nbsp; &nbsp;&nbsp; &nbsp;如：concat_ws(&#39;,&#39;,name,age)<br/><br/>&nbsp; &nbsp;&nbsp; &nbsp;注： 把分隔符指定为null，结果全部变成了null：<br/><br/>&nbsp;二：group_concat()函数<br/><br/>&nbsp;&nbsp;&nbsp; &nbsp;用于group by 中<br/><br/>1、功能：将group by产生的同一个分组中的值连接起来，返回一个字符串结果。<br/><br/>2、语法：group_concat( [distinct] 要连接的字段 [order by 排序字段 asc/desc ] [separator &#39;分隔符&#39;] )<br/><br/>说明：通过使用distinct可以排除重复值；如果希望对结果中的值进行排序，可以使用order by子句；separator是一个字符串值，缺省为一个逗号。 &nbsp;&nbsp; &nbsp;<br/><br/>select name ,group_concat(age) form users group by name <br/>select name ,group_concat(distinct age order by age desc separator &#39;_&#39;) form users group by name <br/><br/>group_concat() 和 cancat() 混合使用<br/>按姓名分组 取出姓名 年龄身高 按年龄分组排序<br/>select name group_concat(concat_ws(&#39;-&#39;,age,height) order by age) from users groub by name <br/></p>', 5, 0, 1548208982, NULL);
INSERT INTO `article` VALUES (37, 'rgba权限验证 以及显示前两级菜单', '', '<p>/********** 取出当前管理员所拥有的前两级的权限 ************/<br/>管理员有多个角色，角色有多个权限<br/>// 取出当前管理员所有的权限<br/></p><pre class=\"brush:php;toolbar:false\">$adminId&nbsp;=&nbsp;session(&#39;id&#39;);\r\nif($adminId&nbsp;==&nbsp;1)\r\n&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;&#39;SELECT&nbsp;*&nbsp;FROM&nbsp;privilege&#39;;\r\nelse&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;&#39;SELECT&nbsp;b.*\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;role_privilege&nbsp;a\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;privilege&nbsp;b&nbsp;ON&nbsp;a.pri_id=b.id\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;admin_role&nbsp;c&nbsp;ON&nbsp;a.role_id=c.role_id\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;c.admin_id=&#39;.$adminId;\r\n$db&nbsp;=&nbsp;M();\r\n$pri&nbsp;=&nbsp;$db-&gt;query($sql);\r\n$btn&nbsp;=&nbsp;array();&nbsp;&nbsp;//&nbsp;放前两级的权限\r\n//&nbsp;从所有的权限中取出前两级的权限\r\nforeach&nbsp;($pri&nbsp;as&nbsp;$k&nbsp;=&gt;&nbsp;$v){\r\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;找顶级权限\r\n&nbsp;&nbsp;&nbsp;&nbsp;if($v[&#39;parent_id&#39;]&nbsp;==&nbsp;0){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;再循环把这个顶级权限的子权限\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($pri&nbsp;as&nbsp;$k1&nbsp;=&gt;&nbsp;$v1){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($v1[&#39;parent_id&#39;]&nbsp;==&nbsp;$v[&#39;id&#39;]){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$v[&#39;children&#39;][]&nbsp;=&nbsp;$v1;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$btn[]&nbsp;=&nbsp;$v;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}</pre><p><br/><br/>/********** 取出当前登陆人员是否有该权限 ************/<br/><br/></p><pre class=\"brush:php;toolbar:false\">$adminId&nbsp;=&nbsp;session(&#39;id&#39;);//&nbsp;获取当前管理员的ID\r\nif(!$adminId)&nbsp;redirect(U(&#39;Admin/Login/login&#39;));&nbsp;//&nbsp;验证登录\r\n&nbsp;&nbsp;&nbsp;&nbsp;\r\n//&nbsp;验证当前管理员是否有权限访问这个页面\r\n//&nbsp;1.&nbsp;先获取当前管理员将要访问的页面&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;TP带三个常量\r\n$url&nbsp;=&nbsp;MODULE_NAME&nbsp;.&#39;/&#39;.&nbsp;CONTROLLER_NAME&nbsp;.&nbsp;&#39;/&#39;&nbsp;.&nbsp;ACTION_NAME;\r\n//&nbsp;查询数据库判断当前管理员有没有访问这个页面的权限\r\n$where&nbsp;=&nbsp;&#39;module_name=&quot;&#39;.MODULE_NAME.&#39;&quot;&nbsp;AND&nbsp;controller_name=&quot;&#39;.CONTROLLER_NAME.&#39;&quot;&nbsp;AND&nbsp;action_name=&quot;&#39;.ACTION_NAME.&#39;&quot;&#39;;\r\n//&nbsp;任何人只要登录了就可以进入后台\r\nif(CONTROLLER_NAME&nbsp;==&nbsp;&#39;Index&#39;)\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;TRUE;\r\nif($adminId&nbsp;==&nbsp;1)\r\n&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;&#39;SELECT&nbsp;COUNT(*)&nbsp;has&nbsp;FROM&nbsp;privilege&nbsp;WHERE&nbsp;&#39;.$where;\r\nelse&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;&#39;SELECT&nbsp;COUNT(a.role_id)&nbsp;has\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;role_privilege&nbsp;a\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;privilege&nbsp;b&nbsp;ON&nbsp;a.pri_id=b.id\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;admin_role&nbsp;c&nbsp;ON&nbsp;a.role_id=c.role_id\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;c.admin_id=&#39;.$adminId.&#39;&nbsp;AND&nbsp;&#39;.$where;\r\n$db&nbsp;=&nbsp;M();\r\n$pri&nbsp;=&nbsp;$db-&gt;query($sql);\r\nif($pri[0][&#39;has&#39;]&nbsp;&lt;&nbsp;1)\r\n&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;error(&#39;无权访问！&#39;);</pre><p><br/></p>', 1, 0, 1548214547, 1548408894);
INSERT INTO `article` VALUES (38, '以递归方式进行无限极分类', '', '<p>以递归方式进行无限极分类<br/><br/>用于后台角色权限设定，电商商品分类<br/><br/></p><pre class=\"brush:php;toolbar:false\">function&nbsp;getTree()&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;$data&nbsp;=&nbsp;DB::query(&#39;select&nbsp;*&nbsp;from&nbsp;privilege&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;_reSort($data);\r\n}&nbsp;\r\nfunction&nbsp;_reSort($data,$parent_id=0,$level=0,$isClear=TRUE)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;$ret&nbsp;=&nbsp;array();&nbsp;//静态数组接收，全局化\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($isClear)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ret&nbsp;=&nbsp;array();&nbsp;//&nbsp;以顶层父级开始存储数据\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($data&nbsp;as&nbsp;$k=&gt;$v)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($v[&#39;parent_id&#39;]&nbsp;==&nbsp;$parent_id)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$[&#39;level&#39;]&nbsp;=&nbsp;$level;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ret[]&nbsp;=&nbsp;$v;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_reSort($data,$v[&#39;id&#39;],$level+1,FALSE);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$ret;\r\n}</pre><p><br/></p><p>根据当前分类取出所有子级分类<br/><br/></p><pre class=\"brush:php;toolbar:false\">function&nbsp;getChildren&nbsp;($id)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;$data&nbsp;=&nbsp;DB::query(&#39;select&nbsp;*&nbsp;from&nbsp;privilege&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;_children($data,$id);\r\n}\r\nfunction&nbsp;_children&nbsp;($data,$parent_id=0,$isClear=TRUE)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;$ret&nbsp;=&nbsp;array();\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($isClear)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ret&nbsp;=&nbsp;array();\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($data&nbsp;as&nbsp;$k=&gt;$v)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($v[&#39;parent_id&#39;]&nbsp;==&nbsp;$parent_id)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ret[]&nbsp;=&nbsp;$v;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_children($data,$v[&#39;id&#39;],FALSE);&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}</pre><p><br/></p><p>角色权限绑定修改页面，当前权限选中，父级和子级也选中<br/></p><pre class=\"brush:php;toolbar:false\">&lt;?php&nbsp;foreach&nbsp;($pri_data&nbsp;as&nbsp;$key&nbsp;=&gt;&nbsp;$v):&nbsp;?&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//$pri_ids&nbsp;当前角色拥有的权限ids&nbsp;用逗号隔开的字符串&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(strpos(&#39;,&#39;.$pri_ids.&#39;,&#39;,&nbsp;&nbsp;&#39;,&#39;.$v[&#39;id&#39;].&#39;,&#39;))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$checked&nbsp;=&nbsp;&#39;checked=&quot;checked&quot;&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$checked&nbsp;=&nbsp;&#39;&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;?&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;echo&nbsp;str_repeat(&#39;-&#39;,$v[&#39;level&#39;]*8);?&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;checkbox&quot;&nbsp;level=&quot;&lt;?php&nbsp;echo&nbsp;$v[&#39;level&#39;];?&gt;&quot;&nbsp;value=&quot;&lt;?php&nbsp;echo&nbsp;$v[&#39;id&#39;]?&gt;&quot;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;echo&nbsp;$checked;?&gt;&nbsp;name=&quot;pri_id[]&quot;&nbsp;&nbsp;/&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;echo&nbsp;$v[&#39;privilege_name&#39;];?&nbsp;&gt;&lt;br/&gt;\r\n&lt;?php&nbsp;endforeach&nbsp;?&gt;\r\n\r\n&lt;script&nbsp;type=&quot;text/javascript&quot;&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;为所有的选择框绑定点击事件\r\n&nbsp;&nbsp;&nbsp;&nbsp;$(&#39;:checkbox&#39;).on(&#39;click&#39;,function()&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;cur_level&nbsp;=&nbsp;$(this).attr(&#39;level&#39;);//&nbsp;先取出当前权限的level值是多少\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;判断是选中还是取消\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($(this).attr(&#39;checked&#39;))&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;temp_level&nbsp;=&nbsp;cur_level;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;pre_all&nbsp;=&nbsp;$(this).preAll(&#39;:checkbox&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(pre_all).each(function(k,v)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($(v).attr(&#39;level&#39;)&nbsp;&lt;&nbsp;temp_level&nbsp;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;判断是不是上级的权限\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(v).attr(&#39;checked&#39;,&#39;checked&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_level--;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;next_all&nbsp;=&nbsp;$(this).nextAll(&#39;:checkbox&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(nextAll).each(function&nbsp;(k,v)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($(v).attr(&#39;level&#39;)&nbsp;&gt;&nbsp;temp_level)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(v).attr(&#39;checked&#39;,&#39;checked&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;next_all&nbsp;=&nbsp;$(this).nextAll(&#39;:checkbox&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(nextAll).each(function&nbsp;(k,v)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($(v).attr(&#39;level&#39;)&nbsp;&gt;&nbsp;cur_level)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(v).removeAttr(&#39;checked&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;&nbsp;//&nbsp;遇到一个平级的权限就停止循环后面的不用再判断了\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;});\r\n&lt;/script&gt;</pre><p><br/></p>', 1, 0, 1548219348, 1548408725);
INSERT INTO `article` VALUES (39, 'mysql curd', '', '<p>create</p><p>insert into users (id,name,age) values(1,&quot;lc&quot;,18);</p><p>或 insert into users set id=1,name=&quot;lc&quot;,age=18;</p><p>添加多列</p><p>insert into users (id,name,age)</p><p>values(1,&quot;lc&quot;,18)， values(2,&quot;lv&quot;,28);;</p><p><br/></p><p>delete</p><p>delete from users where id &gt;5;</p><p>truncate table users ;//清空数据，primary key 重新从1开始</p><p><br/></p><p>update</p><p>update users&nbsp; set age = 20 where id=1;</p><p><br/></p><p>retrieve</p><p>select count(1) from users<br/></p><p><br/></p>', 5, 0, 1548410007, 1548410337);
INSERT INTO `article` VALUES (40, '商品拓展属性的设计', '', '<p>商品的拓展分类分成两种，</p><p><br/></p><p>1.让用户看的，如电脑，生产商，尺寸，产地等信息，唯一</p><p><br/></p><p>2.让用户选择的，内存大小，外观颜色，可选，</p><p>其中可选属性，对于每一种可能的选择，都要存储属性库存</p><p>先建类型表，管理商品属性</p><pre class=\"brush:php;toolbar:false\">create&nbsp;table&nbsp;if&nbsp;not&nbsp;exists&nbsp;type(\r\n&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;int&nbsp;not&nbsp;null&nbsp;auto_increment,\r\n&nbsp;&nbsp;&nbsp;&nbsp;good_id&nbsp;int,\r\n&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;varchar(60),\r\n&nbsp;&nbsp;&nbsp;&nbsp;primary&nbsp;key(id)\r\n)engine=mysiam&nbsp;default&nbsp;charset=utf-8&nbsp;comment&nbsp;&#39;商品类型表&#39;;\r\n\r\ncreate&nbsp;table&nbsp;if&nbsp;not&nbsp;exists&nbsp;attribute(\r\n&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;int&nbsp;not&nbsp;null&nbsp;auto_increment,\r\n&nbsp;&nbsp;&nbsp;&nbsp;attr_name&nbsp;varchar(60),\r\n&nbsp;&nbsp;&nbsp;&nbsp;attr_type&nbsp;tinyint&nbsp;default&nbsp;&#39;0&#39;&nbsp;comment&nbsp;&#39;0.唯一，1.可选&#39;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;attr_value&nbsp;tinyint&nbsp;default&nbsp;&#39;0&#39;&nbsp;comment&nbsp;&#39;显示的内容&#39;,\r\n&nbsp;&nbsp;&nbsp;&nbsp;arrt_price&nbsp;decimal(60),\r\n&nbsp;&nbsp;&nbsp;&nbsp;type_id&nbsp;id(60),\r\n&nbsp;&nbsp;&nbsp;&nbsp;primary&nbsp;key(id)\r\n)engine=mysiam&nbsp;default&nbsp;charset=utf-8&nbsp;comment&nbsp;&#39;商品类型表&#39;;\r\n\r\ncreate&nbsp;table&nbsp;if&nbsp;not&nbsp;exists&nbsp;good_attr(\r\n&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;int&nbsp;not&nbsp;null&nbsp;auto_increment,\r\n&nbsp;&nbsp;&nbsp;&nbsp;good_id&nbsp;int,\r\n&nbsp;&nbsp;&nbsp;&nbsp;attr_id&nbsp;int,\r\n&nbsp;&nbsp;&nbsp;&nbsp;attr_value&nbsp;varchar(60),\r\n&nbsp;&nbsp;&nbsp;&nbsp;primary&nbsp;key(id)\r\n)engine=mysiam&nbsp;default&nbsp;charset=utf-8&nbsp;comment&nbsp;&#39;商品类型表&#39;;\r\n\r\ncreate&nbsp;table&nbsp;if&nbsp;not&nbsp;exists&nbsp;good_number(\r\n&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;int&nbsp;not&nbsp;null&nbsp;auto_increment,\r\n&nbsp;&nbsp;&nbsp;&nbsp;good_id&nbsp;int,\r\n&nbsp;&nbsp;&nbsp;&nbsp;good_attr_id&nbsp;int,\r\n&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;int,\r\n&nbsp;&nbsp;&nbsp;&nbsp;primary&nbsp;key(id)\r\n)engine=mysiam&nbsp;default&nbsp;charset=utf-8&nbsp;comment&nbsp;&#39;商品库存表&#39;;</pre><p><br/></p><p>添加</p><pre class=\"brush:html;toolbar:false;\">&lt;form&nbsp;action=&#39;goods_add&#39;&gt;\r\n&lt;tr&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;\r\n	商品类型：\r\n	&lt;select&nbsp;name=&quot;type_id&quot;&gt;\r\n	&nbsp;&nbsp;&nbsp;&nbsp;&lt;option&nbsp;value=&quot;&quot;&gt;选择类型&lt;/option&gt;\r\n	&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;foreach&nbsp;($typeData&nbsp;as&nbsp;$k&nbsp;=&gt;&nbsp;$v):&nbsp;?&gt;\r\n		&lt;option&nbsp;value=&quot;{$v.id}&quot;&gt;{$v.type_name}&lt;/option&gt;\r\n	&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;endforeach;&nbsp;?&gt;\r\n	&lt;/select&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;tr&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id=&quot;attr_container&quot;&gt;&lt;/td&gt;\r\n&lt;/tr&gt;\r\n&lt;/form&gt;\r\n\r\n$(&quot;select[name=type_id]&quot;).change(function(){\r\n	var&nbsp;type_id&nbsp;=&nbsp;$(this).val();\r\n	if(type_id&nbsp;!=&nbsp;&quot;&quot;){\r\n	&nbsp;&nbsp;$.ajax({\r\n		type&nbsp;:&nbsp;&quot;GET&quot;,\r\n		url&nbsp;:&nbsp;&quot;/index.php/Admin/Goods/ajaxGetAttrl/type_id/&quot;+type_id,\r\n		dataType&nbsp;:&nbsp;&quot;json&quot;,\r\n		success&nbsp;:&nbsp;function(data){\r\n		&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;html&nbsp;=&nbsp;&quot;&quot;;		\r\n		&nbsp;&nbsp;&nbsp;&nbsp;$(data).each(function(k,v){\r\n			html&nbsp;+=&nbsp;&quot;&lt;p&gt;&quot;;\r\n			html&nbsp;+=&nbsp;v.attr_name&nbsp;+&nbsp;&quot;&nbsp;:&nbsp;&quot;;\r\n			//&nbsp;根据属性的类型生成不同的表单元素：\r\n			//&nbsp;1.&nbsp;如果属性是可选的那么就有一个+号\r\n			//&nbsp;2.&nbsp;如果属性有可选值就是一个下拉框\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;3.&nbsp;如果属性是唯一的就生成一个文本框\r\n			if(v.attr_type&nbsp;==&nbsp;1){\r\n			&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;+=&nbsp;&quot;&nbsp;&lt;a&nbsp;onclick=&#39;addnew(this);&#39;&nbsp;href=&#39;javascript:void(0);&#39;&gt;[+]&lt;/a&gt;&nbsp;&quot;;\r\n			}\r\n			//&nbsp;判断是否有可选值\r\n			if(v.attr_option_values&nbsp;==&nbsp;&quot;&quot;)\r\n			&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;+=&nbsp;&quot;&lt;input&nbsp;type=&#39;text&#39;&nbsp;name=&#39;ga[&quot;+v.id+&quot;][]&#39;&nbsp;/&gt;&quot;;\r\n			else{\r\n			//&nbsp;先把可选值转化成数组\r\n			&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;_attr&nbsp;=&nbsp;v.attr_option_values.split(&quot;,&quot;);\r\n			&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;+=&nbsp;&quot;&lt;select&nbsp;name=&#39;ga[&quot;+v.id+&quot;][]&#39;&gt;&quot;;\r\n			&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;+=&nbsp;&quot;&lt;option&nbsp;value=&#39;&#39;&gt;请选择&lt;/option&gt;&quot;;\r\n			//&nbsp;循环每个可选值构造option\r\n			&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;i=0;&nbsp;i&lt;_attr.length;&nbsp;i++)&nbsp;{\r\n				html&nbsp;+=&nbsp;&quot;&lt;option&nbsp;value=&#39;&quot;+_attr[i]+&quot;&#39;&gt;&quot;+_attr[i]+&quot;&lt;/option&gt;&quot;;\r\n			&nbsp;&nbsp;&nbsp;&nbsp;}\r\n			&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;+=&nbsp;&quot;&lt;/select&gt;&quot;;\r\n			}\r\n			if(v.attr_type&nbsp;==&nbsp;1){\r\n			&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;+=&nbsp;&quot;&nbsp;属性价格：￥&nbsp;&lt;input&nbsp;size=&#39;8&#39;&nbsp;name=&#39;attr_price[&quot;+v.id+&quot;][]&#39;&nbsp;type=&#39;text&#39;&nbsp;/&gt;&nbsp;元&quot;;\r\n			}\r\n			html&nbsp;+=&nbsp;&quot;&lt;/p&gt;&quot;;\r\n		&nbsp;&nbsp;&nbsp;&nbsp;});\r\n		&nbsp;&nbsp;&nbsp;&nbsp;$(&quot;#attr_container&quot;).html(html);\r\n		}\r\n	&nbsp;&nbsp;&nbsp;&nbsp;});	\r\n	}else{\r\n		$(&quot;#attr_container&quot;).html(&quot;&quot;);\r\n	}\r\n});\r\n\r\nfunction&nbsp;addnew(a)&nbsp;{\r\n	var&nbsp;p&nbsp;=&nbsp;$(a).parent();\r\n	if($(a).html()==&quot;[+]&quot;)&nbsp;{\r\n		var&nbsp;new_p&nbsp;=&nbsp;p.clone();\r\n		new_p.find(&#39;a&#39;).html(&quot;[-]&quot;);\r\n		p.after(new_p);\r\n	}else&nbsp;{\r\n		p.remove();\r\n	}\r\n}</pre><p>php</p><pre class=\"brush:php;toolbar:false\">public&nbsp;function&nbsp;ajaxGetAttr(){\r\n	$typeId&nbsp;=&nbsp;isset($_GET[&#39;type_id&#39;])&nbsp;?&nbsp;$_GET[&#39;type_id&#39;]&nbsp;:&nbsp;&#39;&#39;;\r\n	//&nbsp;根据类型ID取属性\r\n	$attrData&nbsp;=&nbsp;DB::query(&quot;select&nbsp;*&nbsp;from&nbsp;attribute&nbsp;where&nbsp;type_id=$typeId&nbsp;order&nbsp;by&nbsp;id&nbsp;asc&quot;);\r\n	echo&nbsp;json_encode($attrData);\r\n}\r\n\r\nfunction&nbsp;goods_add(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;$paramAll&nbsp;=&nbsp;request()-&gt;all();\r\n&nbsp;&nbsp;&nbsp;&nbsp;$new_good_id&nbsp;=&nbsp;DB-&gt;table(&#39;goods&#39;)-&gt;insertGetId($paramAll);\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($new_good_id)&nbsp;{\r\n	$good_attr&nbsp;=&nbsp;reuqest()-&gt;post(&#39;ga&#39;);\r\n	$attr_price&nbsp;=&nbsp;request()-&gt;post(&#39;attr_price&#39;);\r\n	if&nbsp;($good_attr)&nbsp;{\r\n	&nbsp;&nbsp;foreach&nbsp;($good_attr&nbsp;as&nbsp;$k&nbsp;=&gt;&nbsp;$v)&nbsp;{\r\n		&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($v&nbsp;as&nbsp;$key&nbsp;=&gt;&nbsp;$value)&nbsp;{\r\n			if&nbsp;(empty($v)&nbsp;{\r\n				continue;\r\n			}\r\n			$price&nbsp;=&nbsp;isset($attr_price[$k][$key])&nbsp;?&nbsp;$attr_price[$k][$key]&nbsp;:&nbsp;&#39;&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$insertData&nbsp;=&nbsp;[\r\n					good_is&#39;=&gt;$new_good_id,\r\n					&#39;attr_id&#39;=&gt;$k,\r\n					&#39;attr_value&#39;=&gt;$value,\r\n					&#39;attr_pricve&#39;=&gt;$price\r\n				];&nbsp;\r\n			DB-&gt;table(&#39;good_attr&#39;)::insert($insertData]);	\r\n		&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}</pre><p>属性修改</p><pre class=\"brush:php;toolbar:false\">function&nbsp;good_edit_param()&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$edit_goods_id&nbsp;=&nbsp;request()-&gt;get(&#39;goods_id&#39;);\r\n	$good_data&nbsp;=&nbsp;DB::query(&quot;SELECT&nbsp;*&nbsp;FROM&nbsp;goods&nbsp;where&nbsp;id&nbsp;=&nbsp;$edit_goods_id&quot;);\r\n	$sql_1&nbsp;=&nbsp;&quot;SELECT&nbsp;a.*,b.attr_name,b.attr_type,b.attr_option_values\r\n			FROM&nbsp;`goods_attr`&nbsp;AS&nbsp;a\r\n			LEFT&nbsp;JOIN&nbsp;attribute&nbsp;AS&nbsp;b&nbsp;ON&nbsp;a.attr_id=b.id&nbsp;\r\n			where&nbsp;a.goods_id&nbsp;=&nbsp;$edit_goods_id&quot;;&nbsp;\r\n	$gaData&nbsp;=&nbsp;DB::query($sql_1);\r\n	$attr_ids_&nbsp;=&nbsp;[];\r\n	foreach&nbsp;($gaData&nbsp;as&nbsp;$v)&nbsp;{\r\n		$attr_ids_[]&nbsp;&nbsp;=&nbsp;$v[&#39;attr_id&#39;];\r\n	}\r\n	$attr_ids_&nbsp;=&nbsp;array_unique($attr_ids_);\r\n	$attr_ids_str&nbsp;=&nbsp;explode(&#39;,&#39;,$attr_ids_);\r\n	//取出该商品未添加的属性，如&nbsp;商品有&nbsp;1颜色，2尺寸，3内存三个属性，而添加时，只选择1和2\r\n	$sql_2&nbsp;=&nbsp;&quot;SELECT&nbsp;id&nbsp;attr_id&nbsp;,attr_name,attr_type,attr_option_values&nbsp;FORM&nbsp;attribute&nbsp;\r\n	WHERE&nbsp;type_id&nbsp;=&nbsp;$good_data[&#39;type_id&#39;]&nbsp;AND&nbsp;id&nbsp;NOT&nbsp;IN&nbsp;($attr_ids_str)&nbsp;&quot;;\r\n	$other_ga_data&nbsp;&nbsp;=&nbsp;DB::query($sql_2);\r\n	if($other_ga_data)&nbsp;{\r\n		$gaData&nbsp;=&nbsp;array_merge($gaData,$other_ga_data);\r\n		usort($gaData,attr_id_sort);\r\n	}\r\n}\r\n\r\nfunction&nbsp;attr_id_sort($a,&nbsp;$b){\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($a[&#39;attr_id&#39;]&nbsp;==&nbsp;$b[&#39;attr_id&#39;])\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;($a[&#39;attr_id&#39;]&nbsp;&lt;&nbsp;$b[&#39;attr_id&#39;])&nbsp;?&nbsp;-1&nbsp;:&nbsp;1;\r\n}</pre><p><br/></p><pre class=\"brush:php;toolbar:false\">&lt;form&nbsp;action=&quot;good_edit&quot;&gt;\r\n&lt;tr&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;	商品类型：\r\n&nbsp;&nbsp;&nbsp;&nbsp;	&lt;select&nbsp;name=&quot;type_id&quot;&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;	&lt;option&nbsp;value=&quot;&quot;&gt;选择类型&lt;/option&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;	&lt;?php\r\n&nbsp;&nbsp;&nbsp;&nbsp;		foreach&nbsp;($typeData&nbsp;as&nbsp;$k&nbsp;=&gt;&nbsp;$v):&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;			$select&nbsp;=&nbsp;$v[&#39;id&#39;]&nbsp;==&nbsp;$data[&#39;type_id&#39;]&nbsp;?&nbsp;&#39;selected&#39;&nbsp;:&nbsp;&#39;&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;	?&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;	&lt;option&nbsp;{$select}&nbsp;value=&quot;{$v.id}&quot;&gt;{$v.type_name}&lt;/option&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;	&lt;?php&nbsp;endforeach;&nbsp;?&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;	&lt;/select&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;\r\n&lt;/tr&gt;\r\n\r\n&lt;tr&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;id=&quot;attr_container&quot;&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;\r\n	&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;所有出现过的属性的ID放到这个数组里\r\n	&nbsp;&nbsp;&nbsp;&nbsp;$attrId&nbsp;=&nbsp;array();\r\n	&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;循环所有的属性\r\n	&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($gaData&nbsp;as&nbsp;$k&nbsp;=&gt;&nbsp;$v):&nbsp;?&gt;\r\n		&lt;p&gt;\r\n		&lt;?php&nbsp;echo&nbsp;$v[&#39;attr_name&#39;];&nbsp;?&gt;&nbsp;：\r\n		&lt;?php\r\n		&nbsp;&nbsp;&nbsp;&nbsp;if($v[&#39;attr_type&#39;]&nbsp;==&nbsp;1):&nbsp;\r\n			//&nbsp;这个属性是否已经出现过\r\n			if(in_array($v[&#39;attr_id&#39;],&nbsp;$attrId))\r\n				$opt&nbsp;=&nbsp;&#39;[-]&#39;;\r\n			else&nbsp;{\r\n				$opt&nbsp;=&nbsp;&#39;[+]&#39;;\r\n				//&nbsp;如果是第一次出现就把这个新的属性ID放到数组中代表已经出现过了\r\n				$attrId[]&nbsp;=&nbsp;$v[&#39;attr_id&#39;];\r\n			}\r\n		?&gt;\r\n		&lt;a&nbsp;gaid=&quot;{$v.id}&quot;&nbsp;onclick=&quot;addnew(this);&quot;&nbsp;href=&quot;javascript:void(0);&quot;&gt;{$opt}&lt;/a&gt;\r\n		&lt;?php&nbsp;endif;&nbsp;?&gt;\r\n		\r\n		&lt;?php\r\n		//&nbsp;判断有没有可选值，如果有就是下拉框，否则是文本框\r\n		//&nbsp;还没有设置这个属性\r\n		if(empty($v[&#39;attr_value&#39;]))\r\n		&nbsp;&nbsp;&nbsp;&nbsp;$old_&nbsp;=&nbsp;&#39;&#39;;\r\n		else&nbsp;\r\n		&nbsp;&nbsp;&nbsp;&nbsp;$old_&nbsp;=&nbsp;&#39;old_&#39;;\r\n		if($v[&#39;attr_option_values&#39;])&nbsp;{\r\n		&nbsp;&nbsp;&nbsp;&nbsp;$_arr&nbsp;=&nbsp;explode(&#39;,&#39;,&nbsp;$v[&#39;attr_option_values&#39;]);\r\n		&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;select&nbsp;name=&quot;&#39;.$old_.&#39;ga[&#39;.$v[&#39;attr_id&#39;].&#39;][&#39;.$v[&#39;id&#39;].&#39;]&quot;&gt;&lt;option&nbsp;value=&quot;&quot;&gt;请选择&lt;/option&gt;&#39;;\r\n		&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($_arr&nbsp;as&nbsp;$k1&nbsp;=&gt;&nbsp;$v1){\r\n			$select&nbsp;=&nbsp;v1&nbsp;==&nbsp;$v[&#39;attr_value&#39;]&nbsp;?&nbsp;&#39;selected&#39;&nbsp;:&nbsp;&#39;&#39;;\r\n			echo&nbsp;&#39;&lt;option&nbsp;&#39;.$select.&#39;&nbsp;value=&quot;&#39;.$v1.&#39;&quot;&gt;&#39;.$v1.&#39;&lt;/option&gt;&#39;;\r\n		&nbsp;&nbsp;&nbsp;&nbsp;}\r\n		&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;/select&gt;&#39;;\r\n		}\r\n		else&nbsp;\r\n		&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&#39;&lt;input&nbsp;name=&quot;&#39;.$old_.&#39;ga[&#39;.$v[&#39;attr_id&#39;].&#39;][&#39;.$v[&#39;id&#39;].&#39;]&quot;&nbsp;type=&quot;text&quot;&nbsp;value=&quot;&#39;.$v[&#39;attr_value&#39;].&#39;&quot;&nbsp;/&gt;&#39;;\r\n		?&gt;\r\n		&lt;?php&nbsp;if($v[&#39;attr_type&#39;]&nbsp;==&nbsp;1):&nbsp;?&gt;\r\n		&nbsp;&nbsp;&nbsp;&nbsp;￥&nbsp;&lt;input&nbsp;name=&quot;old_attr_price[{$v.attr_id}][{$v.id}]&quot;&nbsp;type=&quot;text&quot;&nbsp;size=&quot;10&quot;&nbsp;value=&quot;{$v.attr_price}&quot;&nbsp;/&gt;&nbsp;元\r\n		&lt;?php&nbsp;endif;&nbsp;?&gt;\r\n		&lt;/p&gt;\r\n	&lt;?php&nbsp;endforeach;&nbsp;?&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;\r\n&lt;/tr&gt;		\r\n&lt;/form&gt;</pre><p>js&nbsp;&nbsp;&nbsp;&nbsp;<br/></p><pre class=\"brush:php;toolbar:false\">funcion	addnew(a)&nbsp;{\r\n	var&nbsp;p&nbsp;=&nbsp;$(a).parent();\r\n	if($(a).html()&nbsp;==&nbsp;&quot;[+]&quot;){\r\n		var&nbsp;newP&nbsp;=&nbsp;p.clone();\r\n		//&nbsp;先取出名称的字符串\r\n		var&nbsp;oldName&nbsp;=&nbsp;newP.find(&quot;select&quot;).attr(&quot;name&quot;);\r\n		//&nbsp;把名称中的old_去掉\r\n		var&nbsp;newName&nbsp;=&nbsp;oldName.replace(&quot;old_&quot;,&nbsp;&quot;&quot;);\r\n		//&nbsp;把新的名称设置回去\r\n		newP.find(&quot;select&quot;).attr(&quot;name&quot;,&nbsp;newName);\r\n		//&nbsp;把属性价格的名称也去掉old_\r\n		var&nbsp;oldName&nbsp;=&nbsp;newP.find(&quot;input&quot;).attr(&quot;name&quot;);\r\n		var&nbsp;newName&nbsp;=&nbsp;oldName.replace(&quot;old_&quot;,&nbsp;&quot;&quot;);\r\n		newP.find(&quot;input&quot;).attr(&quot;name&quot;,&nbsp;newName);\r\n		//&nbsp;把克隆出来的P里面的a标签变成-号\r\n		newP.find(&quot;a&quot;).html(&quot;[-]&quot;);\r\n		p.after(newP);\r\n	}\r\n	else{\r\n	&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;点击了[-]号\r\n	&nbsp;&nbsp;&nbsp;&nbsp;if(confirm(&quot;确定要删除吗？&quot;)){\r\n		//&nbsp;先获取这条记录的id\r\n		var&nbsp;gaid&nbsp;=&nbsp;$(a).attr(&quot;gaid&quot;);\r\n		$.get(&quot;&lt;?php&nbsp;echo&nbsp;U(&#39;ajaxDelGoodsAttr&#39;,&nbsp;&#39;&#39;,&nbsp;FALSE);&nbsp;?&gt;/gaid/&quot;+gaid,&nbsp;function(data){\r\n			p.remove();\r\n		});\r\n	&nbsp;&nbsp;&nbsp;&nbsp;}\r\n	}\r\n}</pre><p>php</p><pre class=\"brush:php;toolbar:false\">fucntion&nbsp;good_edit(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;$goods_id&nbsp;=&nbsp;request()-&gt;input(&#39;goods_id&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;$update_data&nbsp;=&nbsp;DB::query(&#39;update&nbsp;goods&nbsp;set&nbsp;...&nbsp;where&nbsp;id&nbsp;=&nbsp;$goods_id&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;//修改后\r\n&nbsp;&nbsp;&nbsp;&nbsp;//处理新添加属性\r\n&nbsp;&nbsp;&nbsp;&nbsp;$good_attr&nbsp;=&nbsp;request()-&gt;input(&#39;ga&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;$attr_price&nbsp;=&nbsp;request()-&gt;input(&#39;attr_price&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;if($good_attr){\r\n	foreach&nbsp;($good_attr&nbsp;as&nbsp;$k=&gt;$v)&nbsp;{\r\n		foreach($v&nbsp;as&nbsp;$k1=&gt;$v1)&nbsp;{\r\n			if(empty($v1)&nbsp;{\r\n				continue;\r\n			}\r\n			$price=&nbsp;isset（$attr_price[$k][$k1]）?&nbsp;$attr_price[$k][$k1]&nbsp;:&nbsp;&#39;&#39;;&nbsp;\r\n			$insertData&nbsp;=&nbsp;[\r\n				&#39;goods_id&#39;=&gt;$goods_id,\r\n				&#39;attr_id&#39;=&gt;$k,\r\n				&#39;attr_value&#39;=&gt;$v1,\r\n		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	&#39;attr_price&#39;=&gt;$price\r\n			];\r\n			DB::table(&#39;good_attr&#39;)-&gt;instet($insertData);\r\n&nbsp;		}\r\n	}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;//处理已有的旧属性\r\n&nbsp;&nbsp;&nbsp;&nbsp;$old_good_attr&nbsp;=&nbsp;request()-&gt;input(&#39;old_ga&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;$old_attr_price&nbsp;=&nbsp;request()-&gt;input(&#39;old_attr_price&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($old_good_attr&nbsp;as&nbsp;$k=&gt;$v)&nbsp;{\r\n	foreach&nbsp;($v&nbsp;as&nbsp;$k1=&gt;$v1)&nbsp;{\r\n		$old_field&nbsp;=&nbsp;[&#39;attr_value&#39;=&gt;$v];\r\n		if(isset($old_attr_price[$k]))&nbsp;{\r\n			$old_field[&#39;attr_price&#39;]&nbsp;=&nbsp;$old_attr_price[$k][$k1];\r\n		}\r\n		DB::table(&#39;good_attr&#39;)-&gt;where(&#39;id&#39;=&gt;$k1)-&gt;update($old_field);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}\r\n\r\npublic&nbsp;function&nbsp;ajaxDelGoodsAttr(){\r\n&nbsp;	$good_attr_id&nbsp;=&nbsp;request()-&gt;input(&#39;gaid&#39;);\r\n	DB::query(&quot;delete&nbsp;goods_attr&nbsp;where&nbsp;id&nbsp;=&nbsp;$good_attr_id&quot;);\r\n}</pre><p>购物时在商品详情页显示可选属性</p><pre class=\"brush:php;toolbar:false\">fucntion&nbsp;good_detail()&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;$good_id&nbsp;=&nbsp;request()-&gt;input(&#39;good_id&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;//可选属性&nbsp;内存等\r\n&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;=&nbsp;&quot;SELECT&nbsp;a.*,b.attr_name&nbsp;FORM&nbsp;&nbsp;good_attr&nbsp;AS&nbsp;a&nbsp;LEFT&nbsp;JOIN&nbsp;attribute&nbsp;AS&nbsp;b&nbsp;on&nbsp;a.attr_id=b.id\r\n&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;a.good_id&nbsp;=&nbsp;$good_id&nbsp;and&nbsp;b.attr_type&nbsp;=1\r\n&nbsp;&nbsp;&nbsp;&nbsp;&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;$mul_select_data&nbsp;=&nbsp;DB::query($sql);\r\n&nbsp;&nbsp;&nbsp;&nbsp;$faData1&nbsp;=&nbsp;[];\r\n&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($mul_select_data&nbsp;as&nbsp;$v)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;$gaData1[$v[&#39;attr_name&#39;]][]&nbsp;=&nbsp;$v;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;//唯一属性，产地等\r\n}</pre><p><br/></p><p>html</p><pre class=\"brush:php;toolbar:false\">&lt;ul&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;foreach&nbsp;($gaData1&nbsp;as&nbsp;$k&nbsp;=&gt;&nbsp;$v):&nbsp;?&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&nbsp;class=&quot;product&quot;&gt;\r\n	&lt;dl&gt;\r\n	&nbsp;&nbsp;&nbsp;&nbsp;&lt;dt&gt;{$k}：&lt;/dt&gt;\r\n	&nbsp;&nbsp;&nbsp;&nbsp;&lt;dd&gt;\r\n		&lt;?php&nbsp;foreach&nbsp;($v&nbsp;as&nbsp;$k1&nbsp;=&gt;&nbsp;$v1):&nbsp;?&gt;\r\n		&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;&lt;?php&nbsp;if($k1==0)&nbsp;echo&nbsp;&#39;class=&quot;selected&quot;&#39;;&nbsp;?&gt;&nbsp;href=&quot;javascript:;&quot;&gt;\r\n			{$v1.attr_value}&nbsp;\r\n			&lt;input&nbsp;type=&quot;radio&quot;&nbsp;name=&quot;goods_attr_id[&lt;?php&nbsp;echo&nbsp;$v1[&#39;attr_id&#39;];&nbsp;?&gt;]&quot;&nbsp;\r\n				value=&quot;&lt;?php&nbsp;echo&nbsp;$v1[&#39;id&#39;];&nbsp;?&gt;&quot;&nbsp;&lt;?php&nbsp;if($k1==0)&nbsp;echo&nbsp;&#39;checked&#39;;&nbsp;?&gt;&nbsp;/&gt;\r\n		&nbsp;&nbsp;&nbsp;&nbsp;&lt;/a&gt;\r\n		&lt;?php&nbsp;endforeach;&nbsp;?&gt;\r\n	&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dd&gt;\r\n	&lt;/dl&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;/li&gt;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php&nbsp;endforeach;&nbsp;?&gt;\r\n&lt;/ul&gt;</pre><p><br/></p>', 1, 0, 1548733891, 1548840184);
INSERT INTO `article` VALUES (41, '优化', '', '<p>1.对查询进行优化，应尽量避免全表扫描，首先应考虑在 where 及 order by 涉及的列上建立索引。</p><p><br/></p><p>2.应尽量避免在 where 子句中对字段进行 null 值判断，否则将导致引擎放弃使用索引而进行全表扫描，</p><p>如：<span style=\"white-space:pre\">	</span>select id from t where num is null<span style=\"white-space:pre\">	</span></p><p>可以在num上设置默认值0，确保表中num列没有null值，</p><p>select id from t where num=0<span style=\"white-space:pre\">	</span></p><p><br/></p><p>3.应尽量避免在 where 子句中使用!=或&lt;&gt;操作符，否则将引擎放弃使用索引而进行全表扫描。<span style=\"white-space:pre\">	</span></p><p><br/></p><p>4.应尽量避免在 where 子句中使用 or 来连接条件，否则将导致引擎放弃使用索引而进行全表扫描，</p><p>如：<span style=\"white-space:pre\">	</span>select id from t where num=10 or num=20<span style=\"white-space:pre\">	</span></p><p>可以这样查询：<span style=\"white-space:pre\">	</span>select id from t where num=10<span style=\"white-space:pre\">	</span>union all<span style=\"white-space:pre\">	</span>select id from t where num=20<span style=\"white-space:pre\">	</span></p><p><br/></p><p>5.in 和 not in 也要慎用，否则会导致全表扫描，</p><p>如：<span style=\"white-space:pre\">	</span>select id from t where num in(1,2,3)<span style=\"white-space:pre\">	</span></p><p>对于连续的数值，能用 between 就不要用 in 了：<span style=\"white-space:pre\">	</span></p><p>select id from t where num between 1 and 3<span style=\"white-space:pre\">	</span></p><p><br/></p><p>6.下面的查询也将导致全表扫描：<span style=\"white-space:pre\">	</span></p><p>select id from t where substring(name,1,3)=&#39;abc&#39;--name以abc开头的id<span style=\"white-space:pre\">	</span></p><p>select id from t where name like &#39;%abc%&#39;<span style=\"white-space:pre\">	</span></p><p><br/></p><p>7.应尽量避免在 where 子句中对字段左边 进行表达式 或函数操作，这将导致引擎放弃使用索引而进行全表扫描。</p><p>如：<span style=\"white-space:pre\">	</span>select id from t where num/2=100<span style=\"white-space:pre\">	</span></p><p>应改为:<span style=\"white-space:pre\">	</span></p><p>select id from t where num=100*2<span style=\"white-space:pre\">	</span></p><p><br/></p><p>8.在使用索引字段作为条件时，如果该索引是复合索引，那么必须使用到该索引中的第一个字段作为条件时才能保证系统使用该索引，<span style=\"white-space:pre\">	</span></p><p>否则该索引将不会被使用，并且应尽可能的让字段顺序与索引顺序相一致。</p><p><br/></p><p>12.很多时候用 exists 代替 in 是一个好的选择：<span style=\"white-space:pre\">	</span></p><p>select num from a where num in(select num from b)<span style=\"white-space:pre\">	</span></p><p>用下面的语句替换：<span style=\"white-space:pre\">	</span></p><p>select num from a where exists(select 1 from b where num=a.numi）</p><p><br/></p><p>13.并不是所有索引对查询都有效，SQL是根据表中数据来进行查询优化的，当索引列有大量数据重复时，SQL查询可能不会去利用索引，如一表中有字段sex，male、female几乎各一半，那么即使在sex上建了索引也对查询效率起不了作用。<span style=\"white-space:pre\">	</span></p><p><br/></p><p>14.索引并不是越多越好，索引固然可以提高相应的 select 的效率，但同时也降低了 insert 及 update 的效率，<span style=\"white-space:pre\">	</span></p><p>因为 insert 或 update 时有可能会重建索引，所以怎样建索引需要慎重考虑，视具体情况而定。<span style=\"white-space:pre\">	</span></p><p>一个表的索引数最好不要超过6个，若太多则应考虑一些不常使用到的列上建的索引是否有必要。<span style=\"white-space:pre\">	</span></p><p><br/></p><p>15.尽量使用数字型字段，若只含数值信息的字段尽量不要设计为字符型，这会降低查询和连接的性能，并会增加存储开销。<span style=\"white-space:pre\">	</span></p><p>这是因为引擎在处理查询和连接时会逐个比较字符串中每一个字符，而对于数字型而言只需要比较一次就够了。<span style=\"white-space:pre\">	</span></p><p><span style=\"white-space:pre\">	</span></p><p>16.尽可能的使用 varchar 代替 char ，因为首先变长字段存储空间小，可以节省存储空间，<span style=\"white-space:pre\">	</span></p><p>其次对于查询来说，在一个相对较小的字段内搜索效率显然要高些。<span style=\"white-space:pre\">	</span></p><p><span style=\"white-space:pre\">	</span></p><p>17.任何地方都不要使用 select * from t ，用具体的字段列表代替“*”，不要返回用不到的任何字段。<span style=\"white-space:pre\">	</span></p><p><span style=\"white-space:pre\">	</span></p><p>18.避免频繁创建和删除临时表，以减少系统表资源的消耗。</p><p><br/></p>', 5, 0, 1548733933, NULL);
INSERT INTO `article` VALUES (42, '完全清空session', '', '<p>session_unset()<br/>释放当前在内存中已经创建的所有$_SESSION变量，但不删除session文件以及不释放对应的session_id</p><p><br/></p><p>session_destroy()<br/>删除当前用户对应的session文件以及释放session_id，内存中的$_SESSION变量内容依然保留</p><p><br/></p><p>因此退出登陆</p><p>session_unset()；</p><p>session_destroy()；</p>', 1, 0, 1548843896, NULL);
INSERT INTO `article` VALUES (43, '添加虚拟主机', '', '<p><a href=\"https://github.com/teddysun/lamp\" _src=\"https://github.com/teddysun/lamp\">https://github.com/teddysun/lamp</a></p><p>如添加 lcl.xxx.com<br/></p><p>cd /lamp</p><p>lamp add</p><p><br/></p><p>重启apache<br/></p><p>/usr/local/apache/bin/apachectl restart</p><p>cd /usr/loval/apache/conf/vhost</p><p>vi lcl.xxx.com 设置域名根目录</p><p><br/></p><p>对应代码目录 <br/></p><p>cd /data/www/lcl.xxx.com<br/></p><p><br/></p><p><br/> </p>', 4, 0, 1550201534, NULL);
INSERT INTO `article` VALUES (44, '原生mysql 查询应用', '原生mysql 查询应用', '<pre class=\"brush:php;toolbar:false\">&lt;?php\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$limit&nbsp;=&nbsp;10;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$orderBy&nbsp;=&nbsp;&#39;id&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($request-&gt;input(&#39;sort_id&#39;))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$orderBy&nbsp;=&nbsp;$request-&gt;input(&#39;sort_id&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sort_by&nbsp;=&nbsp;&#39;desc&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($request-&gt;input(&#39;sort_by&#39;))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sort_by&nbsp;=&nbsp;$request-&gt;input(&#39;sort_by&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$whereSql&nbsp;=&nbsp;&quot;SELECT&nbsp;`a`.*&nbsp;FROM&nbsp;`teacher_info`&nbsp;AS&nbsp;a&nbsp;where&nbsp;`a`.is_del=0&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$whereSql&nbsp;.=&nbsp;&quot;&nbsp;AND&nbsp;`a`.teacehr_audit&nbsp;=&nbsp;1&nbsp;&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($help_search)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$teaching_age_scope&nbsp;=&nbsp;$request-&gt;input(&#39;teaching_age_scope&#39;);&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$teacher_style&nbsp;=&nbsp;$request-&gt;input(&#39;teacher_style&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!empty($teaching_age_scope))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$whereSql&nbsp;.=&nbsp;&quot;&nbsp;AND&nbsp;FIND_IN_SET(&quot;.$teaching_age_scope.&quot;,`a`.teacher_scope_id)&nbsp;&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!empty($teacher_style))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$teacher_style_arr&nbsp;=&nbsp;explode(&#39;,&#39;,$teacher_style);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$teacher_style_count&nbsp;=&nbsp;count($teacher_style_arr);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$whereSql&nbsp;.=&nbsp;&quot;&nbsp;AND&nbsp;&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($teacher_style_count&nbsp;==&nbsp;1)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$whereSql&nbsp;.=&nbsp;&quot;&nbsp;FIND_IN_SET(&quot;.$teacher_style_arr[0].&quot;,`a`.teach_style)&nbsp;&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($teacher_style_arr&nbsp;as&nbsp;$k=&gt;$v)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($k&nbsp;&lt;&nbsp;$teacher_style_count&nbsp;-&nbsp;1)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$whereSql&nbsp;.=&nbsp;&quot;&nbsp;FIND_IN_SET(&nbsp;&quot;.$v.&quot;,`a`.teach_style&nbsp;)&nbsp;OR&nbsp;&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$whereSql&nbsp;.=&nbsp;&quot;&nbsp;FIND_IN_SET(&nbsp;&quot;.$v.&quot;,`a`.teach_style&nbsp;)&nbsp;&quot;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$whereSql&nbsp;.=&nbsp;&quot;&nbsp;ORDER&nbsp;BY&nbsp;&quot;&nbsp;.$orderBy.&quot;&nbsp;&quot;.$sort_by&nbsp;.&#39;&nbsp;LIMIT&nbsp;&#39;&nbsp;.&nbsp;($cur_page-1)&nbsp;*&nbsp;$limit&nbsp;.&nbsp;&#39;,&#39;.$limit;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$search_teacher_data&nbsp;=&nbsp;DB::select($whereSql);\r\n?&gt;</pre><p><br/></p>', 5, 0, 1551322881, NULL);
INSERT INTO `article` VALUES (45, 'larave event', '', '<p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">先说一下在什么场景会使用这个事件功能。</p><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">事情大概是这样的，需求要在用户注册的时候发一些帮助邮件给用户（原本用户在注册之后已经有发别的邮件的了，短信，IM什么的）</p><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">原来这个注册的方法也就10多行代码。但是有时候我们为了省事，直接在注册代码后面添加了各种代码。</p><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">例如这个注册方法本来是这样的</p><pre class=\"hljs xml\" style=\"box-sizing: border-box; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; font-size: 0.93em; padding: 1em; margin-bottom: 1.5em; line-height: 1.45; word-break: break-all; overflow-wrap: break-word; color: rgb(51, 51, 51); background: url(&quot;../img/blueprint.png&quot;) 0% 0% / 30px, 0% 0% / 30px rgb(246, 246, 246); border: none; border-radius: 4px; max-height: 35em; position: relative; margin-top: 0px !important;\">&lt;?php\r\nnamespace&nbsp;App\\Htt\\Controllers;\r\nuse&nbsp;Illuminate\\Http\\Request;\r\nclass&nbsp;UserController&nbsp;extends&nbsp;Controller{&nbsp;&nbsp;&nbsp;&nbsp;\r\npublic&nbsp;function&nbsp;register(Request&nbsp;$request)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//获取参数\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//验证参数\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//写入数据库\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//return&nbsp;注册信息\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">现在有一个需求，要求注册之后给用户的邮箱发一个广告，绝大多数的人（也包括以前的我）就直接在这后面接着写代码了</p><pre class=\"hljs xml\" style=\"box-sizing: border-box; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; font-size: 0.93em; padding: 1em; margin-bottom: 1.5em; line-height: 1.45; word-break: break-all; overflow-wrap: break-word; color: rgb(51, 51, 51); background: url(&quot;../img/blueprint.png&quot;) 0% 0% / 30px, 0% 0% / 30px rgb(246, 246, 246); border: none; border-radius: 4px; max-height: 35em; position: relative; margin-top: 0px !important;\">&lt;?php\r\nnamespace&nbsp;App\\Htt\\Controllers;\r\nuse&nbsp;Illuminate\\Http\\Request;\r\nclass&nbsp;UserController&nbsp;extends&nbsp;Controller{&nbsp;\r\n&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;register(Request&nbsp;$request)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//获取参数\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//验证参数\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//写入数据库\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//发送广告邮件\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//return&nbsp;注册信息\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">这是比较直观的写法，后来又有需求要发个短信。</p><pre class=\"hljs xml\" style=\"box-sizing: border-box; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; font-size: 0.93em; padding: 1em; margin-bottom: 1.5em; line-height: 1.45; word-break: break-all; overflow-wrap: break-word; color: rgb(51, 51, 51); background: url(&quot;../img/blueprint.png&quot;) 0% 0% / 30px, 0% 0% / 30px rgb(246, 246, 246); border: none; border-radius: 4px; max-height: 35em; position: relative; margin-top: 0px !important;\">&lt;?php\r\nnamespace&nbsp;App\\Htt\\Controllers;\r\nuse&nbsp;Illuminate\\Http\\Request;\r\nclass&nbsp;UserController&nbsp;extends&nbsp;Controller{&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;public&nbsp;function&nbsp;register(Request&nbsp;$request)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//获取参数\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//验证参数\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//写入数据库\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//发送广告邮件\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//发送短信\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//return&nbsp;注册信息\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">然后又有需求，要发IM消息，这样的需求很多。这些方法如果你封装了，可能也就一行代码。</p><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">但是，在实际项目中，这个注册方法里面已经加了很多东西。如果多人开发的话各种不方便。然后想到了laravel似乎有这个功能，但是一直都不知道怎么应用，仔细看了一下手册，发现和自己的想法不谋而合。</p><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">laravel的事件功能实际上更倾向是一种管理手段，并不是没了它我们就做不到了，只是它能让我们做得更加好，更加优雅。</p><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">laravel的事件是一种管理+实现的体现，它首先有一个总的目录，然后我们可以宏观的看到所有的事件，而不需要每次都要打开控制器的方法我们才能知道注册后会发生什么，这一点很重要，非常的方便，我就不按着laravel的顺序来讲，而是按着实际情况来建立这种关系。</p><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">现在我们无非就是要在注册之后要做一系列的事情，首先得注册完之后调用一个事件，然后这个事件再做各种各样的事</p><pre class=\"hljs xml\" style=\"box-sizing: border-box; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; font-size: 0.93em; padding: 1em; margin-bottom: 1.5em; line-height: 1.45; word-break: break-all; overflow-wrap: break-word; color: rgb(51, 51, 51); background: url(&quot;../img/blueprint.png&quot;) 0% 0% / 30px, 0% 0% / 30px rgb(246, 246, 246); border: none; border-radius: 4px; max-height: 35em; position: relative; margin-top: 0px !important;\">&lt;?php\r\nnamespace&nbsp;App\\Htt\\Controllers;\r\nuse&nbsp;Illuminate\\Http\\Request;//我们先引入一个事件类，名字自定义的，之后再一步一步创建use&nbsp;App\\Events\\Register;class&nbsp;UserController&nbsp;extends&nbsp;Controller{&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;register(Request&nbsp;$request)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//获取参数\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//验证参数\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//写入数据库\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//触发事件，以后所有需要注册后要做的事情，都不需要再这里加代码了，我们只需要管理事件就好了\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//event方法是laravel自带方法,&nbsp;$uid是外部参数，看你需要做什么，传什么参数了。注册之后肯定有$uid的嘛\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;event(new&nbsp;Register($uid));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//return&nbsp;注册信息\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">找到<code style=\"box-sizing: border-box; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; font-size: 0.93em; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-radius: 4px;\">\\app\\Providers\\EventServiceProvider.php</code>文件。给它添加关系，告诉系统，有人用event()调用了事件之后要被谁监听得到。</p><pre class=\"hljs scala\" style=\"box-sizing: border-box; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; font-size: 0.93em; padding: 1em; margin-bottom: 1.5em; line-height: 1.45; word-break: break-all; overflow-wrap: break-word; color: rgb(51, 51, 51); background: url(&quot;../img/blueprint.png&quot;) 0% 0% / 30px, 0% 0% / 30px rgb(246, 246, 246); border: none; border-radius: 4px; max-height: 35em; position: relative; margin-top: 0px !important;\">&lt;?php\r\nnamespace&nbsp;App\\Providers;\r\nuse&nbsp;Laravel\\Lumen\\Providers\\EventServiceProvider&nbsp;as&nbsp;ServiceProvider;\r\nclass&nbsp;EventServiceProvider&nbsp;extends&nbsp;ServiceProvider{&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;The&nbsp;event&nbsp;listener&nbsp;mappings&nbsp;for&nbsp;the&nbsp;application.\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@var&nbsp;array\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;$listen&nbsp;=&nbsp;[&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;用户注册后的事件\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;App\\Events\\Register&#39;&nbsp;=&gt;&nbsp;[&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;发送广告邮件\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;App\\Listeners\\SendAdMail&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;发送短信\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;App\\Listeners\\SendSms&#39;,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;发送帮助信息\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;App\\Listeners\\SendHelpInformation&#39;,\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],\r\n&nbsp;&nbsp;&nbsp;&nbsp;];\r\n}\r\n\r\n//生成事件和监听器&nbsp;&nbsp;php&nbsp;artisan&nbsp;event:generate</pre><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">这里是注册事件的入口，相当于一个总目录，这样就可以跟注册代码解耦了，以后要加东西我们就不需要再去看注册方法的代码了</p><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">现在注册完之后会触发这个<code style=\"box-sizing: border-box; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; font-size: 0.93em; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-radius: 4px;\">App\\Events\\Register</code>类，然后这个类会被<code style=\"box-sizing: border-box; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; font-size: 0.93em; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-radius: 4px;\">App\\Listeners\\SendAdMail</code>,<code style=\"box-sizing: border-box; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; font-size: 0.93em; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-radius: 4px;\">App\\Listeners\\SendSms</code>，<code style=\"box-sizing: border-box; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; font-size: 0.93em; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-radius: 4px;\">App\\Listeners\\SendHelpInformation</code>监听得到，我们进入<code style=\"box-sizing: border-box; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; font-size: 0.93em; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-radius: 4px;\">app\\Events</code>目录，创建Register这个类</p><pre class=\"hljs xml\" style=\"box-sizing: border-box; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; font-size: 0.93em; padding: 1em; margin-bottom: 1.5em; line-height: 1.45; word-break: break-all; overflow-wrap: break-word; color: rgb(51, 51, 51); background: url(&quot;../img/blueprint.png&quot;) 0% 0% / 30px, 0% 0% / 30px rgb(246, 246, 246); border: none; border-radius: 4px; max-height: 35em; position: relative; margin-top: 0px !important;\">&lt;?phpnamespace&nbsp;App\\Events;class&nbsp;Register{&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;$uid;&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;创建一个新的事件实例.\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;&nbsp;Order&nbsp;&nbsp;$order\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;void\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;__construct($uid)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;uid&nbsp;=&nbsp;$uid;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">这样就可以了。</p><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">然后去<code style=\"box-sizing: border-box; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; font-size: 0.93em; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-radius: 4px;\">app\\Listeners</code>目录创建各种要做的事件监听类。</p><pre class=\"hljs xml\" style=\"box-sizing: border-box; overflow: auto; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; font-size: 0.93em; padding: 1em; margin-bottom: 1.5em; line-height: 1.45; word-break: break-all; overflow-wrap: break-word; color: rgb(51, 51, 51); background: url(&quot;../img/blueprint.png&quot;) 0% 0% / 30px, 0% 0% / 30px rgb(246, 246, 246); border: none; border-radius: 4px; max-height: 35em; position: relative; margin-top: 0px !important;\">&lt;?php\r\nnamespace&nbsp;App\\Listeners;\r\nuse&nbsp;App\\Events\\Register;\r\nuse&nbsp;App\\Models\\User;\r\nuse&nbsp;Illuminate\\Contracts\\Queue\\ShouldQueue;\r\nclass&nbsp;SendHelpInformation&nbsp;implements&nbsp;ShouldQueue{&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;__construct()\r\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;handle(Register&nbsp;$event)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uid&nbsp;=&nbsp;$event-&gt;uid;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$user&nbsp;=&nbsp;User::find($uid);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//......各种实现\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 1.5em; margin-bottom: 1.5em; color: rgb(51, 51, 51); font-family: -apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 15px; white-space: normal; background-color: rgb(255, 255, 255);\">这个handle方法就是我们要做的具体实现了，有个很方便的功能就是如果<code style=\"box-sizing: border-box; font-family: &quot;Source Code Pro&quot;, Consolas, Menlo, Monaco, &quot;Courier New&quot;, monospace; font-size: 0.93em; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-radius: 4px;\">implements ShouldQueue</code>这个接口的话就会异步队列执行，如果去掉的话就是同步执行。很方便有没有，这样代码就解耦了，不需要再管注册代码了，在这里就能很方便的管理了。多人开发也是单独写自己的Listeners就可以了。</p><p><br/></p><p>链接</p><p>https://segmentfault.com/a/1190000010730545</p>', 1, 0, 1551862073, 1551954682);
INSERT INTO `article` VALUES (46, 'ubuntu卸载nginx', '', '<h1 class=\"title-article\" style=\"box-sizing: inherit; outline: 0px; margin: 0.67em 0px; padding: 0px; font-size: 24px; font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; overflow-wrap: break-word;\">ubuntu14.04彻底删除nginx</h1><p><article class=\"baidu_pl\" style=\"box-sizing: inherit; outline: 0px; margin: 0px; padding: 16px 0px 0px; position: relative; color: rgba(0, 0, 0, 0.75); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-size: 14px; font-variant-ligatures: common-ligatures; white-space: normal;\"><h2 id=\"1先执行一下命令\" style=\"box-sizing: border-box; outline: 0px; margin: 8px 0px 16px; padding: 0px; font-size: 24px; font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; color: rgb(79, 79, 79); line-height: 32px; overflow-wrap: break-word;\">1.先执行一下命令：</h2><h3 id=\"11-删除nginxpurge包括配置文件\" style=\"box-sizing: border-box; outline: 0px; margin: 8px 0px 16px; padding: 0px; font-size: 22px; font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; color: rgb(79, 79, 79); line-height: 30px; overflow-wrap: break-word;\">1.1 删除<a href=\"https://www.baidu.com/s?wd=nginx&tn=24004469_oem_dg&rsv_dl=gh_pl_sl_csd\" target=\"_blank\" style=\"box-sizing: border-box; outline: 0px; margin: 0px; padding: 0px; color: rgb(103, 149, 181); text-decoration-line: none; cursor: pointer; overflow-wrap: break-word;\">nginx</a>，–purge包括配置文件</h3><pre class=\"prettyprint\" name=\"code\" style=\"box-sizing: border-box; outline: 0px; margin-top: 0px; margin-bottom: 24px; padding: 8px 16px 6px 56px; position: relative; font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; overflow: auto hidden; line-height: 22px; color: rgb(0, 0, 0); overflow-wrap: break-word; background-color: rgb(246, 248, 250); border: none;\">sudo&nbsp;apt-get&nbsp;--purge&nbsp;remove&nbsp;nginx</pre><h3 id=\"12-自动移除全部不使用的软件包\" style=\"box-sizing: border-box; outline: 0px; margin: 8px 0px 16px; padding: 0px; font-size: 22px; font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; color: rgb(79, 79, 79); line-height: 30px; overflow-wrap: break-word;\">1.2 自动移除全部不使用的软件包</h3><pre class=\"prettyprint\" name=\"code\" style=\"box-sizing: border-box; outline: 0px; margin-top: 0px; margin-bottom: 24px; padding: 8px 16px 6px 56px; position: relative; font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; overflow: auto hidden; line-height: 22px; color: rgb(0, 0, 0); overflow-wrap: break-word; background-color: rgb(246, 248, 250); border: none;\">sudo&nbsp;apt-get&nbsp;autoremove</pre><h3 id=\"13-罗列出与nginx相关的软件\" style=\"box-sizing: border-box; outline: 0px; margin: 8px 0px 16px; padding: 0px; font-size: 22px; font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; color: rgb(79, 79, 79); line-height: 30px; overflow-wrap: break-word;\">1.3 罗列出与nginx相关的软件</h3><pre class=\"prettyprint\" name=\"code\" style=\"box-sizing: border-box; outline: 0px; margin-top: 0px; margin-bottom: 24px; padding: 8px 16px 6px 56px; position: relative; font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; overflow: auto hidden; line-height: 22px; color: rgb(0, 0, 0); overflow-wrap: break-word; background-color: rgb(246, 248, 250); border: none;\">dpkg&nbsp;--get-selections|grep&nbsp;nginx</pre><pre class=\"prettyprint\" name=\"code\" style=\"box-sizing: border-box; outline: 0px; margin-top: 0px; margin-bottom: 24px; padding: 8px 16px 6px 56px; position: relative; font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; overflow: auto hidden; line-height: 22px; color: rgb(0, 0, 0); overflow-wrap: break-word; background-color: rgb(246, 248, 250); border: none;\">执行1.3的结果:\r\nstephen@stephen-OptiPlex-390:~$&nbsp;dpkg&nbsp;--get-selections|grep&nbsp;nginx\r\nnginx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;install\r\nnginx-common&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;install\r\nnginx-core&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;install123456</pre><h3 id=\"14-删除13查询出与nginx有关的软件\" style=\"box-sizing: border-box; outline: 0px; margin: 8px 0px 16px; padding: 0px; font-size: 22px; font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; color: rgb(79, 79, 79); line-height: 30px; overflow-wrap: break-word;\">1.4 删除1.3查询出与nginx有关的软件</h3><pre class=\"prettyprint\" name=\"code\" style=\"box-sizing: border-box; outline: 0px; margin-top: 0px; margin-bottom: 24px; padding: 8px 16px 6px 56px; position: relative; font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; overflow: auto hidden; line-height: 22px; color: rgb(0, 0, 0); overflow-wrap: break-word; background-color: rgb(246, 248, 250); border: none;\">sudo&nbsp;apt-get&nbsp;--purge&nbsp;remove&nbsp;nginx\r\nsudo&nbsp;apt-get&nbsp;--purge&nbsp;remove&nbsp;nginx-common\r\nsudo&nbsp;apt-get&nbsp;--purge&nbsp;remove&nbsp;nginx-core</pre><p style=\"box-sizing: border-box; outline: 0px; margin-top: 0px; margin-bottom: 16px; padding: 0px; font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; overflow-wrap: break-word;\">这样就可以完全卸载掉nginx包括配置文件</p><h2 id=\"2查看nginx正在运行的进程如果有就kill掉\" style=\"box-sizing: border-box; outline: 0px; margin: 8px 0px 16px; padding: 0px; font-size: 24px; font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; color: rgb(79, 79, 79); line-height: 32px; overflow-wrap: break-word;\">2.查看nginx正在运行的进程，如果有就kill掉</h2><pre class=\"prettyprint\" name=\"code\" style=\"box-sizing: border-box; outline: 0px; margin-top: 0px; margin-bottom: 24px; padding: 8px 16px 6px 56px; position: relative; font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; overflow: auto hidden; line-height: 22px; color: rgb(0, 0, 0); overflow-wrap: break-word; background-color: rgb(246, 248, 250); border: none;\">ps&nbsp;-ef&nbsp;|grep&nbsp;nginx1</pre><p style=\"box-sizing: border-box; outline: 0px; margin-top: 0px; margin-bottom: 16px; padding: 0px; font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; overflow-wrap: break-word;\">看下nginx还有没有启动,一般执行完1后，nginx还是启动着的，如下：</p><pre class=\"prettyprint\" name=\"code\" style=\"box-sizing: border-box; outline: 0px; margin-top: 0px; margin-bottom: 24px; padding: 8px 16px 6px 56px; position: relative; font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; overflow: auto hidden; line-height: 22px; color: rgb(0, 0, 0); overflow-wrap: break-word; background-color: rgb(246, 248, 250); border: none;\">stephen@stephen-OptiPlex-390:~$&nbsp;ps&nbsp;-ef&nbsp;|grep&nbsp;nginx\r\nroot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7875&nbsp;&nbsp;2317&nbsp;&nbsp;0&nbsp;15:02&nbsp;?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;00:00:00&nbsp;nginx:&nbsp;master&nbsp;process&nbsp;/usr/sbin/nginx\r\nwww-data&nbsp;&nbsp;7876&nbsp;&nbsp;7875&nbsp;&nbsp;0&nbsp;15:02&nbsp;?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;00:00:00&nbsp;nginx:&nbsp;worker&nbsp;processwww-data&nbsp;&nbsp;7877&nbsp;&nbsp;7875&nbsp;&nbsp;0&nbsp;15:02&nbsp;?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;00:00:00&nbsp;nginx:&nbsp;worker&nbsp;process\r\nwww-data&nbsp;&nbsp;7878&nbsp;&nbsp;7875&nbsp;&nbsp;0&nbsp;15:02&nbsp;?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;00:00:00&nbsp;nginx:&nbsp;worker&nbsp;processwww-data&nbsp;&nbsp;7879&nbsp;&nbsp;7875&nbsp;&nbsp;0&nbsp;15:02&nbsp;?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;00:00:00&nbsp;nginx:&nbsp;worker&nbsp;process\r\nstephen&nbsp;&nbsp;&nbsp;8321&nbsp;&nbsp;3510&nbsp;&nbsp;0&nbsp;15:20&nbsp;pts/0&nbsp;&nbsp;&nbsp;&nbsp;00:00:00&nbsp;grep&nbsp;--color=auto&nbsp;nginx1234567</pre><h2 id=\"3kill-nginx进程\" style=\"box-sizing: border-box; outline: 0px; margin: 8px 0px 16px; padding: 0px; font-size: 24px; font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; color: rgb(79, 79, 79); line-height: 32px; overflow-wrap: break-word;\">3.kill nginx进程</h2><pre class=\"prettyprint\" name=\"code\" style=\"box-sizing: border-box; outline: 0px; margin-top: 0px; margin-bottom: 24px; padding: 8px 16px 6px 56px; position: relative; font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; overflow: auto hidden; line-height: 22px; color: rgb(0, 0, 0); overflow-wrap: break-word; background-color: rgb(246, 248, 250); border: none;\">sudo&nbsp;kill&nbsp;&nbsp;-9&nbsp;&nbsp;7875&nbsp;7876&nbsp;7877&nbsp;78791</pre><h2 id=\"4全局查找与nginx相关的文件\" style=\"box-sizing: border-box; outline: 0px; margin: 8px 0px 16px; padding: 0px; font-size: 24px; font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; color: rgb(79, 79, 79); line-height: 32px; overflow-wrap: break-word;\">4.全局查找与nginx相关的文件</h2><pre class=\"prettyprint\" name=\"code\" style=\"box-sizing: border-box; outline: 0px; margin-top: 0px; margin-bottom: 24px; padding: 8px 16px 6px 56px; position: relative; font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; overflow: auto hidden; line-height: 22px; color: rgb(0, 0, 0); overflow-wrap: break-word; background-color: rgb(246, 248, 250); border: none;\">sudo&nbsp;&nbsp;find&nbsp;&nbsp;/&nbsp;&nbsp;-name&nbsp;&nbsp;nginx*</pre><h2 id=\"5依依删除4列出的所有文件\" style=\"box-sizing: border-box; outline: 0px; margin: 8px 0px 16px; padding: 0px; font-size: 24px; font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; color: rgb(79, 79, 79); line-height: 32px; overflow-wrap: break-word;\">5.依依删除4列出的所有文件</h2><pre class=\"prettyprint\" name=\"code\" style=\"box-sizing: border-box; outline: 0px; margin-top: 0px; margin-bottom: 24px; padding: 8px 16px 6px 56px; position: relative; font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; overflow: auto hidden; line-height: 22px; color: rgb(0, 0, 0); overflow-wrap: break-word; background-color: rgb(246, 248, 250); border: none;\">sudo&nbsp;rm&nbsp;-rf&nbsp;file</pre><p style=\"box-sizing: border-box; outline: 0px; margin-top: 0px; margin-bottom: 16px; padding: 0px; font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; overflow-wrap: break-word;\">这样就彻底删除nginx了</p><h2 id=\"6-再次重装\" style=\"box-sizing: border-box; outline: 0px; margin: 8px 0px 16px; padding: 0px; font-size: 24px; font-family: &quot;Microsoft YaHei&quot;, &quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, sans-serif; color: rgb(79, 79, 79); line-height: 32px; overflow-wrap: break-word;\">6. 再次重装</h2><pre class=\"prettyprint\" name=\"code\" style=\"box-sizing: border-box; outline: 0px; margin-top: 0px; margin-bottom: 24px; padding: 8px 16px 6px 56px; position: relative; font-family: &quot;Source Code Pro&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Anonymous Pro&quot;, &quot;Droid Sans Mono&quot;, Menlo, Monaco, Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; overflow: auto hidden; line-height: 22px; color: rgb(0, 0, 0); overflow-wrap: break-word; background-color: rgb(246, 248, 250); border: none;\">sudo&nbsp;apt-get&nbsp;update&nbsp;\r\nsudo&nbsp;apt-get&nbsp;install&nbsp;nginx</pre></article></p><p>https://blog.csdn.net/u010571844/article/details/50819704</p>', 4, 0, 1553233322, NULL);
INSERT INTO `article` VALUES (47, '非对称加密', '', '<p>php中rsa加密及解密和签名及验签</p><p>　　加密的内容长度限制为密钥长度少11位,如128位的密钥最多加密的内容为117个长度。</p><p><br/></p><p>　　公钥加密</p><p>　　　　$public_content=file_get_contents(公钥路径);</p><p>　　　　$public_key=openssl_get_publickey($public_content);</p><p>　　　　</p><p>　　　　$original_str=&#39;待加密的内容&#39;;</p><p>　　　　$original_arr=str_split($original_str,117);　　//折分</p><p>　　　　foreach($original_arr as $o)</p><p>　　　　{</p><p>　　　　　　$sub_enc=null;</p><p>　　　　　　openssl_public_encrypt($o,$sub_enc,$public_key);</p><p>　　　　　　$original_enc_arr[]=$sub_enc;</p><p>　　　　}</p><p>　　　　openssl_free_key($public_key);</p><p>　　　　$original_enc_str=base64_encode(implode(&#39;&#39;,$original_enc_arr));//最终网络传的密文</p><p>　　私钥解密</p><p>　　　　$private_content=file_get_contents(私钥路径);</p><p>　　　　$private_key=openssl_get_privatekey($private_content);</p><p><br/></p><p>　　　　$original_enc_str=base64_decode(密文);</p><p>　　　　$orig_dec_str=&#39;&#39;;</p><p>　　　　for($i=0;$i&lt;strlen($original_enc_str)/128;$i++)</p><p>　　　　{</p><p>　　　　　　　$data=substr($original_enc_str,$i*128,128);</p><p>　　　　　　　openssl_private_decrypt($data,$decrypt,$private_key);</p><p>　　　　　　　$orig_dec_str.=$decrypt;</p><p>　　　　}</p><p>　　　　$orig_dec_str为最后解密出来的。</p><p><br/></p><p>　　注：私钥加密及公钥解密同理。</p><p>-----------------------------------------------------------------------------------------------------------------------</p><p>　　私钥签名</p><p>　　　　$private_content=file_get_contents(私钥路径);</p><p>　　　　$private_key=openssl_get_privatekey($private_content);</p><p><br/></p><p>　　　　$original_str=&#39;&#39;;//原数据</p><p>　　　　openssl_sign($original_str,$sign,$private_key);</p><p>　　　　openssl_free_key($private_key);</p><p>　　　　$sign=base64_encode($sign);//最终的签名　　　　</p><p><br/></p><p>　　公钥验签</p><p>　　　　$public_content=file_get_contents(公钥路径);</p><p>　　　　$public_key=openssl_get_publickey($public_content);</p><p><br/></p><p>　　　　$sign=base64_decode($sign)&#39;&#39;;//得到的签名</p><p>　　　　$original_str=&#39;&#39;;得到的数据</p><p>　　　　$result=(bool)openssl_verify($original_str,$sign,$public_key);</p><p>　　　　openssl_free_key($public_key);</p><p>　　　　$result为真时签验通过,假时未通过</p><p><br/></p><p>转载 https://www.cnblogs.com/bwteacher/p/5757361.html</p><p><br/></p>', 1, 0, 1554110745, NULL);
INSERT INTO `article` VALUES (48, '数组-并集，交集，差集, 去重', '数组-并集，交集，差集', '<pre style=\"background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;; font-size: 12pt;\"><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">并集<br/><br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//键为整数，直接合并;键为字符串，相同的的键，后面的值会将前面的覆盖<br/>array_merge([1,2],[2,3]); // [0=&gt;1, 1=&gt;2, 2=&gt;2,3=&gt;3]<br/>array_merge([&#39;1a&#39;=&gt;1,2=&gt;2,3=&gt;3],[&#39;1a&#39;=&gt;2,2=&gt;3,&#39;3&#39;=&gt;4]);<br/>// [&#39;1a&#39;=&gt;2, 0 =&gt; 2, 1=&gt;3, 2=&gt;3, 3=&gt;4]</span></pre><pre style=\"background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;; font-size: 12pt;\"><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//通常计算两个数组的并集,先合并后去重<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$union </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">array_unique</span><span style=\"background-color:#f7faff;\">(</span><span style=\"background-color:#f7faff;font-style:italic;\">array_merge</span><span style=\"background-color:#f7faff;\">([</span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#0000ff;background-color:#f7faff;\">2</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#0000ff;background-color:#f7faff;\">3</span><span style=\"background-color:#f7faff;\">],[</span><span style=\"color:#0000ff;background-color:#f7faff;\">3</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#0000ff;background-color:#f7faff;\">4</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#0000ff;background-color:#f7faff;\">5</span><span style=\"background-color:#f7faff;\">]));<br/></span><span style=\"background-color:#f7faff;\"><br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//创建一个数组，用一个数组的值作为其键名，另一个数组的值作为其值,两个数组个数必须相等<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$array1 </span><span style=\"background-color:#f7faff;\">= </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">array</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;blue&#39; &nbsp;</span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;red&#39; &nbsp;</span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">2</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;green&#39; &nbsp;</span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">3</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$array2 </span><span style=\"background-color:#f7faff;\">= </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">array</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;green&#39; </span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">5</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;blue&#39; </span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">6</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;yellow&#39; </span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">3</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$arr_combine </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">array_combine</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$array1</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#660000;background-color:#f7faff;\">$array2</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">// [ [1] =&gt; 5, [2] =&gt; 6, [3] =&gt; 3 ]</span></pre><p><br/></p><p><br/></p><pre style=\"background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;; font-size: 12pt;\"><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">交集<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"><br/></span><span style=\"color:#660000;background-color:#f7faff;\">$array1 </span><span style=\"background-color:#f7faff;\">= </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">array</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;blue&#39; &nbsp;</span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;green&#39; &nbsp;</span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">3</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;red&#39; &nbsp;</span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">2</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$array2 </span><span style=\"background-color:#f7faff;\">= </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">array</span><span style=\"background-color:#f7faff;\">( </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;blue&#39; </span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">6</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;green&#39; </span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">5</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;yellow&#39; </span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">2</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//对值去交集<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$arr_intersect </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">array_intersect</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$array1</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#660000;background-color:#f7faff;\">$array2</span><span style=\"background-color:#f7faff;\">);</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">// [ [red] =&gt; 2 ]<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//对键取交集<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$arr_intersect_key </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">array_intersect_key</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$array1</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#660000;background-color:#f7faff;\">$array2</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">// [ &nbsp; [blue] =&gt; 1 ,[green] =&gt; 3 ]<br/></span></pre><p><br/></p><p><br/></p><pre style=\"background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;; font-size: 12pt;\"><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"> 差集<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"><br/></span><span style=\"color:#660000;background-color:#f7faff;\">$arr1 </span><span style=\"background-color:#f7faff;\">= [</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;0&#39;</span><span style=\"background-color:#f7faff;\">=&gt;</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;white&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;b&#39;</span><span style=\"background-color:#f7faff;\">=&gt;</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;red&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;c&#39;</span><span style=\"background-color:#f7faff;\">=&gt;</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;0&#39;</span><span style=\"background-color:#f7faff;\">];<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$arr2 </span><span style=\"background-color:#f7faff;\">= [</span><span style=\"color:#0000ff;background-color:#f7faff;\">0</span><span style=\"background-color:#f7faff;\">=&gt;</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;white&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;b&#39;</span><span style=\"background-color:#f7faff;\">=&gt;</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;grey&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;d&#39;</span><span style=\"background-color:#f7faff;\">=&gt;</span><span style=\"color:#0000ff;background-color:#f7faff;\">0</span><span style=\"background-color:#f7faff;\">];<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//值的差集，非严格模式 &#39;0&#39;和0 相等<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$arr_differ </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">array_diff</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$arr1</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#660000;background-color:#f7faff;\">$arr2</span><span style=\"background-color:#f7faff;\">); </span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//[&#39;b&#39;=&gt;&#39;red&#39;]<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//键的差集，非严格模式<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$arr_differ_key </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">array_diff_key</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$arr1</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#660000;background-color:#f7faff;\">$arr2</span><span style=\"background-color:#f7faff;\">); </span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//[&#39;c&#39;=&gt;&#39;0&#39;]<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//键值的差集，非严格模式<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$arr_differ_assoc </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">array_diff_assoc</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$arr1</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#660000;background-color:#f7faff;\">$arr2</span><span style=\"background-color:#f7faff;\">);</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//[ &quot;b&quot;=&gt;&quot;red&quot; , &quot;c&quot;=&gt; &quot;0&quot;]<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//用用户提供的回调函数做索引检查来计算数组的差集<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$arr_diff_uassoc </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">array_diff_uassoc</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$arr1</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#660000;background-color:#f7faff;\">$arr2</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">function </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$a</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#660000;background-color:#f7faff;\">$b</span><span style=\"background-color:#f7faff;\">){<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">if</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$a</span><span style=\"background-color:#f7faff;\">==</span><span style=\"color:#660000;background-color:#f7faff;\">$b</span><span style=\"background-color:#f7faff;\">) </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">return </span><span style=\"color:#0000ff;background-color:#f7faff;\">0</span><span style=\"background-color:#f7faff;\">;<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">return </span><span style=\"color:#660000;background-color:#f7faff;\">$a </span><span style=\"background-color:#f7faff;\">&gt; </span><span style=\"color:#660000;background-color:#f7faff;\">$b </span><span style=\"background-color:#f7faff;\">? </span><span style=\"color:#0000ff;background-color:#f7faff;\">1 </span><span style=\"background-color:#f7faff;\">: -</span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">;<br/></span><span style=\"background-color:#f7faff;\">});</span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//[ &quot;b&quot;=&gt;&quot;red&quot; , &quot;c&quot;=&gt; &quot;0&quot;]<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"><br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"><br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//用回调函数对键名比较计算数组的差集，键须是字符串，否则返回空<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$array1 </span><span style=\"background-color:#f7faff;\">= </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">array</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;blue&#39; &nbsp;</span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;red&#39; &nbsp;</span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">2</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;green&#39; &nbsp;</span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">3</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;purple&#39; </span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">4</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$array2 </span><span style=\"background-color:#f7faff;\">= </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">array</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;green&#39; </span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">5</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;blue&#39; </span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">6</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;yellow&#39; </span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">7</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;cyan&#39; &nbsp; </span><span style=\"background-color:#f7faff;\">=&gt; </span><span style=\"color:#0000ff;background-color:#f7faff;\">8</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$arr_diff_ukey </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">array_diff_ukey</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$array1</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660000;background-color:#f7faff;\">$array2</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;key_compare_func&#39;</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">function </span><span style=\"background-color:#f7faff;\">key_compare_func(</span><span style=\"color:#660000;background-color:#f7faff;\">$key1</span><span style=\"background-color:#f7faff;\">, </span><span style=\"color:#660000;background-color:#f7faff;\">$key2</span><span style=\"background-color:#f7faff;\">){<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">if </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$key1 </span><span style=\"background-color:#f7faff;\">== </span><span style=\"color:#660000;background-color:#f7faff;\">$key2</span><span style=\"background-color:#f7faff;\">) </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">return </span><span style=\"color:#0000ff;background-color:#f7faff;\">0</span><span style=\"background-color:#f7faff;\">;<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">return </span><span style=\"color:#660000;background-color:#f7faff;\">$key1 </span><span style=\"background-color:#f7faff;\">&gt; </span><span style=\"color:#660000;background-color:#f7faff;\">$key2 </span><span style=\"background-color:#f7faff;\">? </span><span style=\"color:#0000ff;background-color:#f7faff;\">1 </span><span style=\"background-color:#f7faff;\">: -</span><span style=\"color:#0000ff;background-color:#f7faff;\">1</span><span style=\"background-color:#f7faff;\">;<br/></span><span style=\"background-color:#f7faff;\">}<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//[&quot;red&quot;=&gt; 2, &quot;purple&quot;=&gt; 4]</span></pre><pre style=\"background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;; font-size: 12pt;\"><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\"><br/><br/>对称差集<br/><br/></span><span style=\"color:#660000;background-color:#f7faff;\">$difference </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">array_merge</span><span style=\"background-color:#f7faff;\">(</span><span style=\"background-color:#f7faff;font-style:italic;\">array_diff</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$array1</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#660000;background-color:#f7faff;\">$array2</span><span style=\"background-color:#f7faff;\">),</span><span style=\"background-color:#f7faff;font-style:italic;\">array_diff</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$array2</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#660000;background-color:#f7faff;\">$array1</span><span style=\"background-color:#f7faff;\">));<br/></span></pre><p><br/></p><p><br/></p><pre style=\"background-color: rgb(255, 255, 255); font-family: &quot;Courier New&quot;; font-size: 12pt;\"><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">数组去重<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$arr </span><span style=\"background-color:#f7faff;\">= [</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;red&#39;</span><span style=\"background-color:#f7faff;\">=&gt;</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;rose&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;white&#39;</span><span style=\"background-color:#f7faff;\">=&gt;</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;glory&#39;</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;black&#39;</span><span style=\"background-color:#f7faff;\">=&gt;</span><span style=\"color:#008000;background-color:#f7faff;font-weight:bold;\">&#39;dark&#39;,&#39;grey&#39;=&gt;&#39;dark&#39;</span><span style=\"background-color:#f7faff;\">];<br/></span><span style=\"background-color:#f7faff;\"><br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">1.针对已处理完成的数组<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$unique </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">array_unique</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$arr</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"background-color:#f7faff;\"><br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">2.处理结果的同时创建新数组<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$new_arr </span><span style=\"background-color:#f7faff;\">= [];<br/></span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">foreach </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$arr </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">as </span><span style=\"color:#660000;background-color:#f7faff;\">$k</span><span style=\"background-color:#f7faff;\">=&gt;</span><span style=\"color:#660000;background-color:#f7faff;\">$v</span><span style=\"background-color:#f7faff;\">) {<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;</span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">if</span><span style=\"background-color:#f7faff;\">( !</span><span style=\"background-color:#f7faff;font-style:italic;\">in_array</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$v</span><span style=\"background-color:#f7faff;\">,</span><span style=\"color:#660000;background-color:#f7faff;\">$new_arr</span><span style=\"background-color:#f7faff;\">)) {<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"color:#660000;background-color:#f7faff;\">$new_arr</span><span style=\"background-color:#f7faff;\">[] = </span><span style=\"color:#660000;background-color:#f7faff;\">$v</span><span style=\"background-color:#f7faff;\">;<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;}<br/></span><span style=\"background-color:#f7faff;\">}<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">3. 使用关联数组，减少in_array() 线性检查，效率最快<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$new_arr </span><span style=\"background-color:#f7faff;\">= [];<br/></span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">foreach </span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$arr </span><span style=\"color:#000080;background-color:#f7faff;font-weight:bold;\">as </span><span style=\"color:#660000;background-color:#f7faff;\">$k</span><span style=\"background-color:#f7faff;\">=&gt;</span><span style=\"color:#660000;background-color:#f7faff;\">$v</span><span style=\"background-color:#f7faff;\">) {<br/></span><span style=\"background-color:#f7faff;\"> &nbsp; &nbsp;</span><span style=\"color:#660000;background-color:#f7faff;\">$new_arr</span><span style=\"background-color:#f7faff;\">[</span><span style=\"color:#660000;background-color:#f7faff;\">$v</span><span style=\"background-color:#f7faff;\">] = </span><span style=\"color:#660000;background-color:#f7faff;\">$v</span><span style=\"background-color:#f7faff;\">;<br/></span><span style=\"background-color:#f7faff;\">}<br/></span><span style=\"color:#660000;background-color:#f7faff;\">$ret </span><span style=\"background-color:#f7faff;\">= </span><span style=\"background-color:#f7faff;font-style:italic;\">array_values</span><span style=\"background-color:#f7faff;\">(</span><span style=\"color:#660000;background-color:#f7faff;\">$new_arr</span><span style=\"background-color:#f7faff;\">);<br/></span><span style=\"color:#808080;background-color:#f7faff;font-style:italic;\">//或者 array_keys($new_arr) 稍慢</span></pre><p><br/></p>', 1, 0, 1554873443, 1554873718);
INSERT INTO `article` VALUES (49, '注册和单点登陆', '', '<p>&nbsp;web登陆后用户信息一般存到session，</p><p>但是对于多台服务器，反向代理服务器会以某种规则（如轮询），分发到各个节点服务器。</p><p>如用户A，在&nbsp; a 服务器登陆，此时 session 存储到 a 服务器，当访问其他路由时，可能下次会分发到 b 服务器，此时导致找不到 session 信息，又会跳转到登陆页面。</p><p>解决方式，修改轮询规则，以 IP 的方式去分布到相应节点，如 A 用户第一次访问 a 服务器，那么反向代理记录此 ip ,后续都会分发到 a 节点。但 a 节点出现故障，又会分发到其他节点。解决方式，分布式存储session ,如将 session 放redis中。</p><p>单点登陆：</p><p>APP中，A 用户 在 安卓机a登陆后， 又在安卓机b登陆，此时两个机器可以同时操作，会出现严重的安全问题。因此一个账号必须保证，同一时间只能在单个机器访问（单点登陆），同时应设置登陆有效期，防止别人获取到令牌而模拟操作。&nbsp;</p><pre class=\"brush:php;toolbar:false\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注册或登陆发送验证码,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;用缓存（redis）限制&nbsp;发送验证码频率，每天三次后禁用一段时间（关小黑屋），过期后，可以继续获取验证码\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;sendCode(Request&nbsp;$request)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$phone&nbsp;=&nbsp;$request-&gt;input(&#39;phone&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(empty($phone)&nbsp;||&nbsp;!&nbsp;preg_match(&#39;/^1[3-9]\\d{9}$/&#39;,$phone))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;failed(&#39;请输入正确的手机号码&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$code&nbsp;=&nbsp;rand(100000,999999);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;验证码是否已经生成并且还没过期，类似前端定时器限制（60s后才能重新点击生成验证码）\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$has_exist_send_code&nbsp;=&nbsp;Cache::get(&quot;register_login_send_&quot;&nbsp;.&nbsp;$phone);//&nbsp;register_login_send_13800009999\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($has_exist_send_code)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;failed(&#39;验证码已生成，请等待&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$login_cur_day_phone&nbsp;=&nbsp;&quot;register_login_&quot;&nbsp;.&nbsp;$phone&nbsp;.&nbsp;&#39;_&#39;&nbsp;.&nbsp;date(&#39;Ymd&#39;)&nbsp;;&nbsp;//&nbsp;register_login_13322223333_20190426\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send_times&nbsp;=&nbsp;Cache::get($login_cur_day_phone);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send_times&nbsp;=&nbsp;empty($send_times)&nbsp;?&nbsp;0&nbsp;:&nbsp;intval($send_times);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//当天发送次数大于三次，禁用三个小时\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($send_times&nbsp;&lt;&nbsp;2)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$res&nbsp;=&nbsp;SmsTemplate::sms($phone,&nbsp;SmsTemplate::TEMPLATE_REGISTER,&nbsp;[&#39;validCode&#39;&nbsp;=&gt;&nbsp;strval($code)]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($res[&#39;code&#39;]&nbsp;===&nbsp;&#39;01&#39;)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cache::set(&#39;register_login_send_&#39;&nbsp;.&nbsp;$phone,&nbsp;$res[&#39;message&#39;],&nbsp;Carbon::now()-&gt;addMinute(1));&nbsp;//&nbsp;2分钟过期，包括前端60是倒计时\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cache::set(&#39;register_login_code_&#39;&nbsp;.&nbsp;$phone,&nbsp;$code,&nbsp;Carbon::now()-&gt;addMinute(10));\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send_times++;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cache::set($login_cur_day_phone,&nbsp;$send_times,&nbsp;Carbon::tomorrow());\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;success([],&nbsp;[],&nbsp;&#39;发送成功&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\Log::debug(&quot;send_register_login_interface_error：{$res[&#39;message&#39;]}&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;failed(&#39;发送失败&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$close_user_three_hour&nbsp;=&nbsp;&#39;register_login_close_&#39;&nbsp;.&nbsp;$phone;&nbsp;&nbsp;//register_login_close_13822223333\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$has_relieve&nbsp;=&nbsp;Cache::get($close_user_three_hour);&nbsp;//是否在小黑屋中\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($has_relieve)&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&nbsp;failed(&#39;当然发送短信次数过多，请稍后再试！&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$res&nbsp;=&nbsp;SmsTemplate::sms($phone,&nbsp;SmsTemplate::TEMPLATE_REGISTER,&nbsp;[&#39;validCode&#39;&nbsp;=&gt;&nbsp;strval($code)]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($res[&#39;code&#39;]&nbsp;===&nbsp;&#39;01&#39;)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cache::set(&#39;register_login_send_&#39;&nbsp;.&nbsp;$phone,&nbsp;$res[&#39;message&#39;],&nbsp;Carbon::now()-&gt;addMinute(1));&nbsp;//&nbsp;2分钟过期，包括前端60是倒计时\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cache::set(&#39;register_login_code_&#39;&nbsp;.&nbsp;$phone,&nbsp;$code,&nbsp;Carbon::now()-&gt;addMinute(10));&nbsp;//验证码有效期10分支\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send_times++;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cache::set($login_cur_day_phone,&nbsp;$send_times,&nbsp;Carbon::tomorrow());\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cache::add($close_user_three_hour,&nbsp;1,&nbsp;180);&nbsp;//关小黑屋3个小时\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;success([],&nbsp;[],&nbsp;&#39;发送成功&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\Log::debug(&quot;send_register_login_interface_error：{$res[&#39;message&#39;]}&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;failed(&#39;发送失败&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/**\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;匹配验证码注册或登陆\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;账号密码类似，只是把手机号参数更换成，用户名，密码，确认密码\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;verifyCode(Request&nbsp;$request)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params[&#39;phone_num&#39;]&nbsp;=&nbsp;$req_phone&nbsp;=&nbsp;$request-&gt;input(&#39;phone&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(empty($req_phone)&nbsp;||&nbsp;!&nbsp;preg_match(&#39;/^1[3-9]\\d{9}$/&#39;,$req_phone))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;failed(&#39;请输入正确的手机号码&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params[&#39;source&#39;]&nbsp;=&nbsp;$request-&gt;get(&#39;source&#39;,0);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$req_code&nbsp;=&nbsp;$request-&gt;input(&#39;code&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cache_code&nbsp;=&nbsp;Cache::get(&#39;register_login_code_&#39;.$req_phone);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!&nbsp;$cache_code)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;failed(&#39;验证码过期&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($req_code&nbsp;!=&nbsp;$cache_code)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;failed(&#39;验证码错误&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$user&nbsp;=&nbsp;User::where(&#39;phone_num&#39;,&#39;=&#39;,$req_phone)-&gt;first();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(empty($user))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;注册\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pwd&nbsp;=&nbsp;rand(100000,999999);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params[&#39;pwd&#39;]&nbsp;&nbsp;=&nbsp;md5($pwd);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$user&nbsp;=&nbsp;User::createUser($params);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$res&nbsp;=&nbsp;SmsTemplate::sms($phone,&nbsp;SmsTemplate::TEMPLATE_REGISTER,&nbsp;[&#39;validCode&#39;&nbsp;=&gt;&nbsp;strval($code)]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($res[&#39;code&#39;]&nbsp;！==&nbsp;&#39;01&#39;)&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\Log::debug(&quot;send_register_login_interface_error：{$res[&#39;message&#39;]}&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!empty($request-&gt;input(&#39;openid&#39;,&#39;&#39;)))&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;微信登陆\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$userWechat&nbsp;=&nbsp;UserWechat::where(&#39;openid&#39;,$request-&gt;input(&#39;openid&#39;))-&gt;first();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$userWechat-&gt;uid&nbsp;=&nbsp;$user-&gt;id;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$userWechat-&gt;save();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$token&nbsp;=&nbsp;auth(&#39;api&#39;)-&gt;tokenById($user-&gt;id);//laravel&nbsp;生成token方式\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//覆盖Redis中该用户已有的token，使同用户其他设备登录状态失效\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;User::updateTokenRecord($user,$token);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UserLoginLog::createLog($user,UserLoginLog::TYPE_PHONE);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UserGlobal::jpushDataUpdate($user,&nbsp;$request);&nbsp;//极光相关更新(APP消息提醒)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;respond([\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;user&#39;=&gt;User::getCurrentUserDetailByApp($user),\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;token&#39;=&gt;$token,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],&nbsp;&#39;登录成功&#39;,&nbsp;Response::HTTP_OK);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}catch&nbsp;(\\Exception&nbsp;$e)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;failed($e-&gt;getMessage());\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;使用hash类型存储token,分布式存储。并设置token有效期\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/\r\n&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;updateTokenRecord($user,$token)｛\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$hashKey&nbsp;=&nbsp;&#39;users:token&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$key&nbsp;=&nbsp;$user-&gt;phone_num&nbsp;.&nbsp;&#39;:token&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$oldToken&nbsp;=&nbsp;Redis::hGet($hashKey,&nbsp;$key);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($oldToken&nbsp;&amp;&amp;&nbsp;$oldToken&nbsp;!==&nbsp;$token&nbsp;&amp;&amp;&nbsp;JWTAuth::setToken($oldToken)-&gt;check())&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;JWT&nbsp;第三方库\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JWTAuth::setToken($oldToken)-&gt;invalidate();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Redis::hMset($hashKey,&nbsp;$key,&nbsp;$token);\r\n&nbsp;&nbsp;&nbsp;&nbsp;｝</pre><p><br/></p>', 1, 0, 1557451641, 1557452783);
INSERT INTO `article` VALUES (50, 'mysql 字段类型', '', '<p>数据类型优化</p><p>1. 整数</p><p>1.1 整数(存储空间)</p><p>tinyint(8),smallint(16),mediumint(24),int(32),bigint(64)</p><p>存储值的范围 -2(N次幂-1) ~ 2(N次幂-1)-1&nbsp;</p><p>1.2 unsigned 去除负数范围，使正数的上线提高一倍，如tinyint (-127~128),unsigned tinyint(0~255)</p><p>有符号和无符号存储使用相同的存储空间，具有相同的性能。</p><p>1.3 为整数类型指定宽度</p><p>指定宽度对于应用来说没有任意，如常用 int(11)，这个和int(20) 或int(1) ，对于存储或计算来说这三者没有任何区别，</p><p>指定宽度也不会限制值的合法范围，只是限定客户端显示的个数。</p><p><br/></p><p>2. 实数类型 （小数）</p><p>float 占用四个字节，double占用8个字节（更高的精度和范围，默认的浮点计算类型）</p><p>decimal&nbsp;</p><p>不仅仅可以存小数，有可以存比bigint范围更大的整数 。</p><p>decimal（18,9）每四个字节存储九个数字， 小数点两边各存储九个数字，共8个字节，小数点又占一个字节，因此共九个字节；</p><p><br/></p><p>更大的位数仅仅是一种格式（如财务数据精确到小数点后四位），在计算中会转化成double类型运算。</p><p>在数据量大时，可以指定bigint类型，将小数乘以相应的倍数。如 122.34 * 100 存储 12234，</p><p>避免浮点存数不精确和decimal精确但是计算代价高。</p><p><br/></p><p>3.日期</p><p>datetime 存储范围 1001 年 ~ 9999 年，精度秒，与时区无关，8个字节存储空间</p><p>timestamp 1970-01-01 ~ 2038-12-23 ，4个字节存储。from_unixtime()将时间戳转化日期，&nbsp;</p><p>unix_timestamp() 日期转为时间戳。 默认 not null。</p><p>因为timestamp根据时区转换，且存储空间小，无特殊要求（时间范围要求高），首选。</p><p>对于要求毫秒级的，可以使用bigint 或 double 代替。或使用mariadb</p><p>&nbsp;<br/></p><p><br/></p>', 1, 0, 1557885972, 1558334095);
INSERT INTO `article` VALUES (51, 'redis 基本类型', '', '<ol class=\" list-paddingleft-2\" style=\"list-style-type: decimal;\"><li><p>String</p></li><li><p>Set</p></li><li><p>List</p></li><li><p>Hash</p></li><li><p>Zset<br/></p></li></ol>', 6, 0, 1558394506, NULL);
INSERT INTO `article` VALUES (52, 'redis HyperLogLog统计Pv Uv', '', '<p>PV 每个页面每天的访问量。</p><p>UV 每个页面用户每天的访问量（根据用户去重）。</p><p>PV统计：</p><p>给每个页面单独的Redis计数器,用String类型</p><p>a.html 静态页面&nbsp;</p><p>$k = &#39;a&#39; . date(&#39;Y-m-d&#39;);</p><p>$redis = new Redis();</p><p>$redis.incr($k);</p><p><br/></p><p>UV统计：</p><p>使用Set类型，无序集合自动去重</p><p style=\"white-space: normal;\">b.html 静态页面&nbsp;</p><p style=\"white-space: normal;\">$k = &#39;b&#39; . date(&#39;Y-m-d&#39;);</p><p style=\"white-space: normal;\">$user_id ; //访问该页面的用户ID（如果用户未登陆，可以用IP代替）</p><p style=\"white-space: normal;\">$redis = new Redis();</p><p style=\"white-space: normal;\">$redis.sadd($k,$user_id); // 存入集合&nbsp;</p><p style=\"white-space: normal;\">$redis.scard($k);&nbsp; //获取集合大小</p><p>&nbsp;</p><p>注：如果某个页面访问人数过多，如有几千万人访问，那么该set集合会占用很大的存储空间。</p><p>如果多个页面访问量都很多，仅仅因为去重统计，浪费性能不值得，可以选用非精准方式替代，</p><p>HyperLogLog (误差大约不到1%)；</p><p>用法 ：和 Set 类似&nbsp;</p><p>pfadd&nbsp; &nbsp;$k&nbsp; &nbsp;$user // 存储进行计数</p><p>pfcount&nbsp; $k ;获取数量&nbsp;</p><p>脚本测试性能</p><pre class=\"brush:php;toolbar:false\">public&nbsp;function&nbsp;test()&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;$redis&nbsp;=&nbsp;new&nbsp;Redis();\r\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;($i&nbsp;=&nbsp;1;&nbsp;$i&nbsp;&lt;=&nbsp;100000;&nbsp;$i++)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$redis.pfadd(&#39;uv_key&#39;,&#39;user&#39;&nbsp;.&nbsp;$i);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$len&nbsp;=&nbsp;$redis.pfcount(&#39;uv_key&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($len&nbsp;!=&nbsp;&nbsp;$i&nbsp;)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_f($len.&nbsp;&#39;===&#39;.&nbsp;$i);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}</pre><p>pf ： 发明者 Philippe Flajolet 名字缩写。</p>', 6, 0, 1558396305, NULL);
INSERT INTO `article` VALUES (53, '限流访问', '', '<p>限流，防止用户恶意访问，或者爬去数据等，</p><p>简单限流：String类型</p><p>如每个用户访问网站接口每分钟120次限制</p><pre class=\"brush:php;toolbar:false\">public&nbsp;function&nbsp;limtInvit(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;$redis&nbsp;=&nbsp;new&nbsp;Redis();\r\n&nbsp;&nbsp;&nbsp;&nbsp;$user_id&nbsp;=&nbsp;session(&#39;user_id&#39;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;$times&nbsp;=&nbsp;$redis.get($user_id);\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($times&nbsp;&gt;&nbsp;120)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;over&nbsp;invit&nbsp;limited&#39;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($times&nbsp;&gt;&nbsp;0)&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$redis.incr($user_id);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$reids.setex($user_id,1,60);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}</pre><p>此种限制不够准确，如12:00:01-12:00:58 访问1次，12：00:59 访问119 次，</p><p>此时下一秒key过期，又会从0开始计数，但是如果12:01:01 该秒访问119次，</p><p>那么12:00:59-12:01:01 三秒时间 访问了239次，远超频率限制。</p><p><br/></p><p>优化方式：</p><p><br/></p><p><br/></p><p><br/></p><p><br/></p>', 6, 0, 1558398026, NULL);

-- ----------------------------
-- Table structure for type
-- ----------------------------
DROP TABLE IF EXISTS `type`;
CREATE TABLE `type`  (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `title` varchar(60) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT '',
  `parent_id` int(11) NOT NULL,
  PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 7 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Compact;

-- ----------------------------
-- Records of type
-- ----------------------------
INSERT INTO `type` VALUES (1, 'PHP', 0);
INSERT INTO `type` VALUES (2, 'javascript', 0);
INSERT INTO `type` VALUES (3, 'java', 0);
INSERT INTO `type` VALUES (4, 'linux', 0);
INSERT INTO `type` VALUES (5, 'mysql', 0);
INSERT INTO `type` VALUES (6, 'redis', 0);

SET FOREIGN_KEY_CHECKS = 1;
